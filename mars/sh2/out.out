00000000                      ; =================================================================
00000000                      ; ------------------------------------------------
00000000                      ; SH2
00000000                      ; 
00000000                      ; Master jobs:
00000000                      ; Graphics / 3D
00000000                      ;
00000000                      ; Slave jobs:
00000000                      ; PWM
00000000                      ; ------------------------------------------------
00000000                      
00000000                      		include	"mars/sh2/include/sh2_map.asm"
00000000                      ; ====================================================================
00000000                      ; -----------------------------------------------------------------
00000000                      ; SH2 Address map
00000000                      ; 
00000000                      ; Only for SH2
00000000                      ; -----------------------------------------------------------------
00000000                      
00000000 =0603E000            S_STACK		equ	$0603E000
00000000 =0603F000            M_STACK		equ	$0603F000
00000000                      
00000000                      ; -----------------------------------------------------------------
00000000                      
00000000 =00000000            CS0		equ	$00000000	; Boot rom & system registers
00000000 =02000000            CS1		equ	$02000000	; Cart rom
00000000 =04000000            CS2		equ	$04000000	; Frame buffer
00000000 =06000000            CS3		equ	$06000000	; SDRAM
00000000                      
00000000 =20000000            TH		equ	$20000000	; Cache thru address start
00000000 =20000000            CS0TH		equ	$20000000	; Boot rom chached thru
00000000 =22000000            CS1TH		equ	$22000000	; Cart rom cahced thru
00000000 =24000000            CS2TH		equ	$24000000	; frame buffer cached thru
00000000 =26000000            CS3TH		equ	$26000000	; SDRAM chaced thru
00000000                      
00000000                      ;---------------------------------------------------------------*
00000000                      ;	SYSREG.
00000000                      ;---------------------------------------------------------------*
00000000                      
00000000 =20004000            _sysreg		equ	$00004000+TH	; SYSREG.
00000000 =00000000            adapter		equ	$00		; adapter control register
00000000 =00000001            intmask		equ	$01		; interrupt mask
00000000 =00000002            standby		equ	$02
00000000 =00000005            hcount		equ	$05		; H Interrupt Counter register
00000000 =00000006            dreqctl		equ	$06		; DREQ control
00000000 =00000008            dreqsource	equ	$08		; DREQ source address
00000000 =0000000C            dreqdest	equ	$0c		; DREQ destination address
00000000 =00000010            dreqlen		equ	$10		; DREQ length
00000000 =00000012            fifo		equ	$12		; FIFO
00000000 =00000014            vresintclr	equ	$14		; VRES interrupt clear
00000000 =00000016            vintclr		equ	$16		; V interrupt clear
00000000 =00000018            hintclr		equ	$18		; H interrupt clear
00000000 =0000001A            cmdintclr	equ	$1a		; CMD interrupt clear
00000000 =0000001C            pwmintclr	equ	$1c		; PWM interrupt clear
00000000                      
00000000 =00000020            comm0		equ	$20		; Communication port
00000000 =00000022            comm2		equ	$22		;
00000000 =00000024            comm4		equ	$24		;
00000000 =00000026            comm6		equ	$26		;
00000000 =00000028            comm8		equ	$28		;
00000000 =00000029            comm9		equ	$29		;
00000000 =0000002A            comm10		equ	$2a		;
00000000 =0000002C            comm12		equ	$2c		;
00000000 =0000002E            comm14		equ	$2e		;
00000000 =00000030            timerctl	equ	$30		; PWM Timer Control
00000000 =00000031            pwmctl		equ	$31		; PWM Control
00000000 =00000032            cycle		equ	$32		; PWM Cycle
00000000 =00000034            lchwidth	equ	$34		; PWM L ch Width
00000000 =00000036            rchwidth	equ	$36		; PWM R ch Width
00000000 =00000038            monowidth	equ	$38		; PWM Monaural Width
00000000                      
00000000                      ;---------------------------------------------------------------*
00000000                      ;	VDPREG.
00000000                      ;---------------------------------------------------------------*
00000000                      
00000000 =20004100            _vdpreg		equ	$00004100+TH	; VDPREG.
00000000 =00000000            tvmode		equ	$00		; TV mode register
00000000 =00000001            bitmapmd	equ	$01		; Bitmap mode register
00000000 =00000003            shift		equ	$03		; Shift Control register
00000000 =00000005            filllength	equ	$05		; Auto Fill Length register
00000000 =00000006            fillstart	equ	$06		; Auto Fill Start Address register
00000000 =00000008            filldata	equ	$08		; Auto Fill Data register
00000000 =0000000A            vdpsts		equ	$0a		; VDP Status register
00000000 =0000000B            framectl	equ	$0b		; Frame Buffer Control register
00000000                      
00000000                      ;---------------------------------------------------------------*
00000000 =20004200            _palette	equ	$00004200+TH	; Palette RAM
00000000 =24000000            _framebuffer:	equ	CS2TH		; Frame buffer
00000000 =24020000            _overwrite:	equ	CS2TH+$20000	; Over Write Image
00000000                      ;---------------------------------------------------------------*
00000000                      
00000000                      ;---------------------------------------------------------------*
00000000                      ;	Bit assign
00000000                      ;---------------------------------------------------------------*
00000000                      
00000000                      ; adapter
00000000 =00000001            CART		equ	%00000001	; 0: CD		/1: Cartridge
00000000 =00000002            ADEN		equ	%00000010	; 0: No MARS	/1: MARS
00000000 =00000080            FM		equ	%10000000	; 0: MD		/1: SH
00000000                      
00000000                      ; framectl
00000000 =00000001            FS		equ	%00000001	; 0: DRAM 0	/1: DRAM 1
00000000 =00000002            FEN		equ	%00000010	; 0: アクセス可	/1: アクセス不可
00000000                      
00000000                      ; vdpsts
00000000 =00000080            VBLK		equ	%10000000
00000000 =00000040            HBLK		equ	%01000000
00000000 =00000020            PEN		equ	%00100000
00000000                      
00000000                      ;-------------------------------------------------------;
00000000                      
00000000                      _DMASOURCE0	.equ	$ffffff80	; DMA source address 0
00000000                      _DMADEST0	.equ	$ffffff84	; DMA destination address 0
00000000                      _DMACOUNT0	.equ	$ffffff88	; DMA transfer count 0
00000000                      _DMACHANNEL0	.equ	$ffffff8c	; DMA channel control 0
00000000                      _DMASOURCE1	.equ	$ffffff90	; DMA source address 1
00000000                      _DMADEST1	.equ	$ffffff94	; DMA destination address 1
00000000                      _DMACOUNT1	.equ	$ffffff98	; DMA transfer count 1
00000000                      _DMACHANNEL1	.equ	$ffffff9c	; DMA channel control 1
00000000                      _DMAVECTORN0	.equ	$ffffffa0	; DMA vector number N0
00000000                      _DMAVECTORE0	.equ	$ffffffa4	; DMA vector number E0
00000000                      _DMAVECTORN1	.equ	$ffffffa8	; DMA vector number N1
00000000                      _DMAVECTORE1	.equ	$ffffffac	; DMA vector number E1
00000000                      _DMAOPERATION	.equ	$ffffffb0	; DMA operation
00000000                      _DMAREQACK0	.equ	$ffffffb4	; DMA request/ack select control 0
00000000                      _DMAREQACK1	.equ	$ffffffb8	; DMA request/ack select control 1
00000000                      _SERIAL		.equ	$fffffe00	; Serial Control
00000000                      _FRT		.equ	$fffffe10	; Free run timer
00000000                      _TIER		.equ	$00		; Timer interrup enable register
00000000                      _TCSR		.equ	$01		; Timer control & status register
00000000                      _FRC_H		.equ	$02		; free running counter High
00000000                      _FRC_L		.equ	$03		; free running counter Low
00000000                      _OCR_H		.equ	$04		; Output compare register High
00000000                      _OCR_L		.equ	$05		; Output compare register Low
00000000                      _TCR		.equ	$06		; Timer control register
00000000                      _TOCR		.equ	$07		; timer output compare control register
00000000                      
00000000                      ;-------------------------------------------------------;
00000000                      VIRQ_ON		.equ	$08		;IRQ masks for IRQ mask register
00000000                      HIRQ_ON		.equ	$04
00000000                      CMDIRQ_ON	.equ	$02
00000000                      PWMIRQ_ON	.equ	$01
00000000                      ;-------------------------------------------------------;
00000000                      
00000000                      
00000000                      
00000000                      
00000000                      		include	"mars/sh2/include/shared_map.asm"
00000000                      ; ==================================================================
00000000                      ; ---------------------------------------------------
00000000                      ; SH2 variables
00000000                      ; 
00000000                      ; For both SH2 and 68k
00000000                      ; ---------------------------------------------------
00000000                      
00000000 =00008000            sizeof_code		equ	$8000
00000000                      
00000000 =06000000            MasterEntry		equ	$06000000
00000000 =06008000            SlaveEntry		equ	$06000000+sizeof_code
00000000 =06010000            Sh2_CodeEnd		equ	$06000000+(sizeof_code*2)
00000000                      
00000000                      ; ---------------------------------------------------
00000000                      ; Variables
00000000                      ; ---------------------------------------------------
00000000                      
00000000                      ; 			rsreset
00000000                      ; m_loadpic		rs.b 1
00000000                      ; m_loadpic		rs.b 1
00000000                      		org CS3
06000000                      
06000000                      ; =================================================================
06000000                      ; ------------------------------------------------
06000000                      ; Master CPU
06000000                      ; ------------------------------------------------
06000000                      
06000000                      		obj MasterEntry
06000000                      SH2_Master:
06000000 0000 0000 0603    +  		dc.l @Entry,M_STACK		; Cold PC,SP
06000008 0000 0000 0603    +  		dc.l @Entry,M_STACK		; Manual PC,SP
06000010                      
06000010 0000 0000            		dc.l ErrorTrap			; Illegal instruction
06000014 0000 0000            		dc.l 0				; reserved
06000018 0000 0000            		dc.l ErrorTrap			; Invalid slot instruction
0600001C 2010 0400            		dc.l $20100400			; reserved
06000020 2010 0420            		dc.l $20100420			; reserved
06000024 0000 0000            		dc.l ErrorTrap			; CPU address error
06000028 0000 0000            		dc.l ErrorTrap			; DMA address error
0600002C 0000 0000            		dc.l ErrorTrap			; NMI vector
06000030 0000 0000            		dc.l ErrorTrap			; User break vector
06000034                      
06000034 0000 0000 0000    +  		dcb.l 19,0			; reserved
06000080                      
06000080                      		dcb.l 32,ErrorTrap		; Trap vectors
06000100                      
06000100 0000 0000             		dc.l master_irq			; Level 1 IRQ
06000104 0000 0000            		dc.l master_irq			; Level 2 & 3 IRQ's
06000108 0000 0000            		dc.l master_irq			; Level 4 & 5 IRQ's
0600010C 0000 0000            		dc.l master_irq			; PWM interupt
06000110 0000 0000            		dc.l master_irq			; Command interupt
06000114 0000 0000            		dc.l master_irq			; H Blank interupt
06000118 0000 0000            		dc.l master_irq			; V Blank interupt
0600011C 0000 0000            		dc.l master_irq			; Reset Button
06000120                      
06000120                      ; =================================================================
06000120                      ; ------------------------------------------------
06000120                      ; Master entry
06000120                      ; ------------------------------------------------
06000120                      
06000120                      @Entry:
06000120 DE00                 		mov.l	#_sysreg,r14
06000122 4E1E                 		ldc	r14,gbr
06000124                      
06000124                      ; ----------------------------------
06000124                      
06000124                      @wait_md:
06000124 C608                 		mov.l	@(comm0,gbr),r0
06000126 8800                 		cmp/eq	#0,r0
06000128 8BFC                 		bf	@wait_md
0600012A                      
0600012A                      ; ----------------------------------	
0600012A                      
0600012A D100                 		mov.l	#"SLAV",r1
0600012C                      @wait_slave:
0600012C C60A                 		mov.l	@(comm8,gbr),r0		; wait for the slave to finish booting
0600012E 3010                 		cmp/eq	r1,r0
06000130 8BFC                 		bf	@wait_slave
06000132                      
06000132                      ; =================================================================
06000132                      ; ------------------------------------------------
06000132                      ; Hotstart
06000132                      ; ------------------------------------------------
06000132                      
06000132                      m_hotstart:
06000132 DF00                 		mov.l	#M_STACK,r15
06000134                      
06000134 DE00                 		mov.l	#_sysreg,r14
06000136 4E1E                 		ldc	r14,gbr
06000138                      
06000138                      ;   		mov	#FM,r0			(moved to 68k)
06000138                      ;   		mov.b	r0,@(adapter,gbr)
06000138                      
06000138 E00B                  		mov	#VIRQ_ON|CMDIRQ_ON|PWMIRQ_ON,r0
0600013A C001                     		mov.b	r0,@(intmask,gbr)
0600013C E020                 		mov.l	#$20,r0
0600013E 400E                 		ldc	r0,sr
06000140 0009                 		nop
06000142                      		
06000142                      ; ==================================================================
06000142                      ; ---------------------------------------------------
06000142                      ; Master start
06000142                      ; ---------------------------------------------------
06000142                      
06000142                      master_start:
06000142 D000                     		mov.l	#pwm_init,r0
06000144 400B                     		jsr	@r0
06000146 0009                     		nop
06000148                      
06000148                      ; =================================================================
06000148                      ; ---------------------------------------------------
06000148                      ; Master loop
06000148                      ; ---------------------------------------------------
06000148                      
06000148                      master_loop:
06000148 D100                 		mov	#mars_features,r1
0600014A 6012                 		mov	@r1,r0
0600014C 8801                 		cmp/eq	#1,r0
0600014E 8B00                 		bf	@no_models
06000150                      		
06000150 E000                  		mov	#0,r0
06000152 C400                  		mov.b	@(adapter,gbr),r0
06000154 C980                  		and 	#FM,r0
06000156 C880                  		tst 	#FM,r0
06000158 8900                  		bt	@no_models
0600015A                      		
0600015A D000                       		mov	#Vdp_WaitFrame,r0
0600015C 400B                       		jsr	@r0
0600015E 0009                       		nop
06000160 D000                       		mov	#Vdp_ClearFrame,r0
06000162 400B                       		jsr	@r0
06000164 0009                       		nop
06000166                            		
06000166 D000                       		mov	#models_run,r0
06000168 400B                       		jsr	@r0
0600016A 0009                       		nop
0600016C                      		
0600016C D000                       		mov	#Vdp_FlipFrame,r0
0600016E 400B                       		jsr	@r0
06000170 0009                       		nop
06000172                      
06000172                      @no_models:
06000172 AFE9                 		bra	master_loop
06000174 0009                 		nop
06000176                      
06000176                      ; -------------------------
06000176                      ; list
06000176                      ; -------------------------
06000176                      
06000176 0000                 		cnop 0,4
06000178                      master_requests:
06000178 0000 0000            		dc.l 0
0600017C 0000 0000            		dc.l @cmd_1		; Load picture
06000180 0000 0000            		dc.l @cmd_2		; Load pal 
06000184 0000 0000            		dc.l @cmd_3		; Load palfade
06000188 0000 0000            		dc.l @cmd_0
0600018C 0000 0000            		dc.l @cmd_0
06000190 0000 0000            		dc.l @cmd_0
06000194 0000 0000            		dc.l @cmd_0
06000198 0000 0000            		dc.l @cmd_0
0600019C 0000 0000            		dc.l @cmd_0
060001A0 0000 0000            		dc.l @cmd_0
060001A4 0000 0000            		dc.l @cmd_0
060001A8 0000 0000            		dc.l @cmd_C		; Request fade
060001AC 0000 0000            		dc.l @cmd_D		; Wait until it finishes
060001B0 0000 0000            		dc.l @cmd_E		; Set video mode
060001B4 0000 0000            		dc.l @cmd_F		; Display next frame
060001B8                      		
060001B8 0000 0000            		dc.l @cmd_10		; Enable/Disable features
060001BC 0000 0000            		dc.l @cmd_0
060001C0 0000 0000            		dc.l @cmd_0
060001C4 0000 0000            		dc.l @cmd_0
060001C8 0000 0000            		dc.l @cmd_0
060001CC 0000 0000            		dc.l @cmd_0
060001D0 0000 0000            		dc.l @cmd_0
060001D4 0000 0000            		dc.l @cmd_0
060001D8 0000 0000            		dc.l @cmd_0
060001DC 0000 0000            		dc.l @cmd_0
060001E0 0000 0000            		dc.l @cmd_0
060001E4 0000 0000            		dc.l @cmd_0
060001E8 0000 0000            		dc.l @cmd_0
060001EC 0000 0000            		dc.l @cmd_0
060001F0 0000 0000            		dc.l @cmd_0
060001F4 0000 0000            		dc.l @cmd_0
060001F8                      
060001F8 0000 0000            		dc.l @cmd_20		;Model: NEW Model
060001FC 0000 0000            		dc.l @cmd_0		;Model: DELETE Model
06000200 0000 0000            		dc.l @cmd_22		;Model: Modify X Y Z
06000204 0000 0000            		dc.l @cmd_23		;Model: Modify Xrot Yrot Zrot
06000208 0000 0000            		dc.l @cmd_0
0600020C 0000 0000            		dc.l @cmd_0
06000210 0000 0000            		dc.l @cmd_0
06000214 0000 0000            		dc.l @cmd_0
06000218 0000 0000            		dc.l @cmd_0
0600021C 0000 0000            		dc.l @cmd_0
06000220 0000 0000            		dc.l @cmd_0
06000224 0000 0000            		dc.l @cmd_0
06000228 0000 0000            		dc.l @cmd_0
0600022C 0000 0000            		dc.l @cmd_0
06000230 0000 0000            		dc.l @cmd_0
06000234 0000 0000            		dc.l @cmd_0
06000238                      		
06000238 0000 0000            		dc.l @cmd_0
0600023C 0000 0000            		dc.l @cmd_0
06000240 0000 0000            		dc.l @cmd_0
06000244 0000 0000            		dc.l @cmd_0
06000248 0000 0000            		dc.l @cmd_0
0600024C 0000 0000            		dc.l @cmd_0
06000250 0000 0000            		dc.l @cmd_0
06000254 0000 0000            		dc.l @cmd_0
06000258 0000 0000            		dc.l @cmd_0
0600025C 0000 0000            		dc.l @cmd_0
06000260 0000 0000            		dc.l @cmd_0
06000264 0000 0000            		dc.l @cmd_0
06000268 0000 0000            		dc.l @cmd_0
0600026C 0000 0000            		dc.l @cmd_0
06000270 0000 0000            		dc.l @cmd_0
06000274 0000 0000            		dc.l @cmd_0
06000278                      		
06000278                      ; ------------------------------------------------
06000278                      ; command ??
06000278                      ;
06000278                      ; nothing
06000278                      ; ------------------------------------------------
06000278                      
06000278                      @cmd_0:
06000278 000B                 		rts
0600027A 0009                 		nop
0600027C                      		cnop 0,4
0600027C 0000 0000 0000    +  		lits
060002A0                      
060002A0                      ; ------------------------------------------------
060002A0                      ; command 01
060002A0                      ;
060002A0                      ; Load art
060002A0                      ;
060002A0                      ; comm4 | LONG - address
060002A0                      ; comm8 | WORD - X start
060002A0                      ; comm10| WORD - Y start
060002A0                      ; comm12| WORD - X size
060002A0                      ; comm14| WORD - Y size
060002A0                      ; comm16| WORD - Target mode
060002A0                      ; ------------------------------------------------
060002A0                      
060002A0                      @cmd_1:
060002A0 4F22                 		mov.l	pr,@-r15
060002A2                      		
060002A2 C609                  		mov.l	@(comm4,gbr),r0
060002A4 6103                  		mov	r0,r1
060002A6 E000                  		mov 	#0,r0
060002A8 C514                  		mov.w	@(comm8,gbr),r0
060002AA 6203                  		mov	r0,r2
060002AC C515                  		mov.w	@(comm10,gbr),r0
060002AE 6303                  		mov	r0,r3
060002B0 C516                   		mov.w	@(comm12,gbr),r0
060002B2 6403                  		mov	r0,r4	
060002B4 C517                  		mov.w	@(comm14,gbr),r0
060002B6 6503                  		mov	r0,r5
060002B8 E601                  		mov	#1,r6
060002BA B000                  		bsr 	Vdp_LoadArt
060002BC 0009                  		nop
060002BE                      
060002BE 4F26                 		mov.l	@r15+,pr
060002C0 000B                 		rts
060002C2 0009                 		nop
060002C4                      		cnop 0,4
060002C4                      		lits
060002C4                      		
060002C4                      ; ------------------------------------------------
060002C4                      ; command 02
060002C4                      ;
060002C4                      ; Load palette
060002C4                      ; 
060002C4                      ; comm4 | LONG - address
060002C4                      ; comm8 | WORD - start from
060002C4                      ; comm10| WORD - number of colors
060002C4                      ; ------------------------------------------------
060002C4                      
060002C4                      @cmd_2:
060002C4 4F22                 		mov.l	pr,@-r15
060002C6                      		
060002C6 C609                 		mov.l	@(comm4,gbr),r0
060002C8 6103                 		mov	r0,r1
060002CA E000                 		mov 	#0,r0
060002CC C515                 		mov.w	@(comm10,gbr),r0
060002CE 6303                 		mov	r0,r3
060002D0 D400                  		mov.l	#pal_buffer,r4
060002D2 B000                 		bsr 	Vdp_LoadPal_Raw
060002D4 0009                 		nop
060002D6                      		
060002D6 4F26                 		mov.l	@r15+,pr
060002D8 000B                 		rts
060002DA 0009                 		nop
060002DC                      		cnop 0,4
060002DC 0000 0000            		lits
060002E0                      
060002E0                      ; ------------------------------------------------
060002E0                      ; command 03
060002E0                      ;
060002E0                      ; Load palette for fade
060002E0                      ; 
060002E0                      ; comm4 | LONG - address
060002E0                      ; comm8 | WORD - start from
060002E0                      ; comm10| WORD - number of colors
060002E0                      ; ------------------------------------------------
060002E0                      
060002E0                      @cmd_3:
060002E0 4F22                 		mov.l	pr,@-r15
060002E2                      		
060002E2 C609                 		mov.l	@(comm4,gbr),r0
060002E4 6103                 		mov	r0,r1
060002E6 E000                 		mov 	#0,r0
060002E8 C515                 		mov.w	@(comm10,gbr),r0
060002EA 6303                 		mov	r0,r3
060002EC D400                 		mov.l	#pal_fadebuff,r4
060002EE E000                 		mov 	#0,r0
060002F0 C514                 		mov.w	@(comm8,gbr),r0
060002F2 600D                 		extu	r0,r0
060002F4 4000                 		shll	r0
060002F6 340C                 		add 	r0,r4
060002F8 B000                 		bsr 	Vdp_LoadPal_Raw
060002FA 0009                 		nop
060002FC                      		
060002FC 4F26                 		mov.l	@r15+,pr
060002FE 000B                 		rts
06000300 0009                 		nop
06000302 0000                 		cnop 0,4
06000304 0000 0000            		lits
06000308                      
06000308                      ; ------------------------------------------------
06000308                      ; command 0C
06000308                      ;
06000308                      ; Request fade
06000308                      ;
06000308                      ; comm4 | WORD - request type
06000308                      ; comm6 | WORD - speed
06000308                      ; comm8 | WORD - start from
06000308                      ; comm10| WORD - number of colors
06000308                      ; ------------------------------------------------
06000308                      
06000308                      @cmd_C:
06000308 4F22                 		mov.l	pr,@-r15
0600030A                      		
0600030A E000                  		mov 	#0,r0
0600030C C512                  		mov.w	@(comm4,gbr),r0
0600030E 6103                  		mov	r0,r1
06000310 C513                  		mov.w	@(comm6,gbr),r0
06000312 6203                  		mov	r0,r2
06000314 C514                  		mov.w	@(comm8,gbr),r0
06000316 6303                  		mov	r0,r3
06000318 C515                  		mov.w	@(comm10,gbr),r0
0600031A 6403                  		mov	r0,r4
0600031C B000                      		bsr	palfade_set
0600031E 0009                       		nop
06000320                           		
06000320 4F26                 		mov.l	@r15+,pr
06000322 000B                 		rts
06000324 0009                 		nop
06000326 0000                 		cnop 0,4
06000328                      		lits
06000328                      		
06000328                      ; ------------------------------------------------
06000328                      ; command 0D
06000328                      ;
06000328                      ; Wait fade
06000328                      ; ------------------------------------------------
06000328                      
06000328                      @cmd_D:
06000328 4F22                 		mov.l	pr,@-r15
0600032A                      
0600032A D100                 		mov.l	#palfade_control,r1
0600032C                      @wait:
0600032C 5010                 		mov	@(fade_request,r1),r0
0600032E 8800                 		cmp/eq	#0,r0
06000330 8BFC                 		bf	@wait
06000332                           		
06000332 4F26                 		mov.l	@r15+,pr
06000334 000B                 		rts
06000336 0009                 		nop
06000338                      		cnop 0,4
06000338 0000 0000            		lits
0600033C                      		
0600033C                      ; ------------------------------------------------
0600033C                      ; command 0E
0600033C                      ;
0600033C                      ; Set video mode
0600033C                      ;
0600033C                      ; comm4| WORD - mode ID
0600033C                      ; ------------------------------------------------
0600033C                      
0600033C                      @cmd_E:
0600033C 4F22                 		mov.l	pr,@-r15
0600033E                      		
0600033E E000                 		mov 	#0,r0
06000340 C512                 		mov.w	@(comm4,gbr),r0
06000342 6103                 		mov	r0,r1
06000344 B000                      		bsr	Vdp_SetMode
06000346 0009                      		nop
06000348                           		
06000348 4F26                 		mov.l	@r15+,pr
0600034A 000B                 		rts
0600034C 0009                 		nop
0600034E 0000                 		cnop 0,4
06000350                      		lits
06000350                      		
06000350                      ; ------------------------------------------------
06000350                      ; command 0F
06000350                      ;
06000350                      ; Show next frame
06000350                      ; ------------------------------------------------
06000350                      
06000350                      @cmd_F:
06000350 4F22                 		mov.l	pr,@-r15
06000352                      		
06000352 B000                     		bsr	Vdp_FlipFrame
06000354 0009                      		nop
06000356 B000                      		bsr	Vdp_WaitFrame
06000358 0009                      		nop
0600035A                           		
0600035A 4F26                 		mov.l	@r15+,pr
0600035C 000B                 		rts
0600035E 0009                 		nop
06000360                      		cnop 0,4
06000360                      		lits
06000360                      		
06000360                      ; ------------------------------------------------
06000360                      ; command 10
06000360                      ;
06000360                      ; Enable/Disable features
06000360                      ; 
06000360                      ; Input:
06000360                      ; comm4 | WORD Disable/Enable flags (0,1)
06000360                      ; ------------------------------------------------
06000360                      
06000360                      @cmd_10:
06000360 4F22                 		mov.l	pr,@-r15
06000362                      
06000362 E000                  		mov	#0,r0
06000364 C512                     		mov.w	@(comm4,gbr),r0
06000366 D100                 		mov	#mars_features,r1
06000368 2102                 		mov	r0,@r1
0600036A                      		
0600036A 4F26                 		mov.l	@r15+,pr
0600036C 000B                 		rts
0600036E 0009                 		nop
06000370                      		cnop 0,4
06000370 0000 0000            		lits
06000374                      		
06000374                      ; ------------------------------------------------
06000374                      ; command 20
06000374                      ;
06000374                      ; Model: Set NEW Model
06000374                      ;
06000374                      ; Input:
06000374                      ; comm4 | LONG - Model address
06000374                      ; comm8 | WORD - Slot
06000374                      ; ------------------------------------------------
06000374                      
06000374                      @cmd_20:
06000374 4F22                 		mov.l	pr,@-r15
06000376                      		
06000376 E000                  		mov	#0,r0
06000378 C514                     		mov.w	@(comm8,gbr),r0
0600037A 6203                     		mov	r0,r2
0600037C C609                     		mov.l	@(comm4,gbr),r0
0600037E 6103                     		mov	r0,r1
06000380 D000                      		mov.l	#Mars3d_ModelSet,r0
06000382 400B                      		jsr	@r0
06000384 0009                      		nop
06000386                      		
06000386 4F26                 		mov.l	@r15+,pr
06000388 000B                 		rts
0600038A 0009                 		nop
0600038C                      		cnop 0,4
0600038C 0000 0000            		lits
06000390                      
06000390                      ; ------------------------------------------------
06000390                      ; command 22
06000390                      ;
06000390                      ; Model: Modify X,Y,Z
06000390                      ;
06000390                      ; Input:
06000390                      ;  comm4 | WORD - Slot
06000390                      ;  comm6 | WORD - X
06000390                      ;  comm8 | WORD - Y
06000390                      ; comm10 | WORD - Z
06000390                      ; ------------------------------------------------
06000390                      
06000390                      @cmd_22:
06000390 4F22                 		mov.l	pr,@-r15
06000392                      		
06000392 D400                 		mov.l	#models_buffer,r4
06000394 E000                     		mov	#0,r0
06000396 C512                     		mov.w	@(comm4,gbr),r0
06000398 600D                     		extu	r0,r0
0600039A 6203                     		mov	r0,r2
0600039C D000                 		mov	#sizeof_model,r0
0600039E 202E                 		mulu	r2,r0
060003A0 001A                 		mov	macl,r0
060003A2 340C                 		add 	r0,r4
060003A4                      		
060003A4 E000                      		mov	#0,r0
060003A6 C513                       		mov.w	@(comm6,gbr),r0
060003A8 600F                        		exts.w	r0,r0
060003AA 1400                      		mov	r0,@(model_x,r4)
060003AC E000                      		mov	#0,r0
060003AE C514                      		mov.w	@(comm8,gbr),r0
060003B0 600F                      		exts.w	r0,r0
060003B2 1400                      		mov	r0,@(model_y,r4)
060003B4 E000                      		mov	#0,r0
060003B6 C515                      		mov.w	@(comm10,gbr),r0
060003B8 600F                      		exts.w	r0,r0
060003BA 1400                      		mov	r0,@(model_z,r4)
060003BC                         		
060003BC 4F26                 		mov.l	@r15+,pr
060003BE 000B                 		rts
060003C0 0009                 		nop
060003C2 0000                 		cnop 0,4
060003C4 0000 0000 0000    +  		lits
060003CC                      		
060003CC                      ; ------------------------------------------------
060003CC                      ; command 23
060003CC                      ;
060003CC                      ; Model: Modify X,Y,Z Rotation
060003CC                      ;
060003CC                      ; Input:
060003CC                      ;  comm4 | WORD - Slot
060003CC                      ;  comm6 | WORD - Xrot
060003CC                      ;  comm8 | WORD - Yrot
060003CC                      ; comm10 | WORD - Zrot
060003CC                      ; ------------------------------------------------
060003CC                      
060003CC                      @cmd_23:
060003CC 4F22                 		mov.l	pr,@-r15
060003CE                      		
060003CE D400                 		mov.l	#models_buffer,r4
060003D0 E000                     		mov	#0,r0
060003D2 C512                     		mov.w	@(comm4,gbr),r0
060003D4 600D                     		extu	r0,r0
060003D6 6203                     		mov	r0,r2
060003D8 D000                 		mov	#sizeof_model,r0
060003DA 202E                 		mulu	r2,r0
060003DC 001A                 		mov	macl,r0
060003DE 340C                 		add 	r0,r4
060003E0                      		
060003E0 E000                      		mov	#0,r0
060003E2 C513                       		mov.w	@(comm6,gbr),r0
060003E4 600F                        		exts	r0,r0
060003E6 1400                      		mov	r0,@(model_x_rot,r4)
060003E8 E000                      		mov	#0,r0
060003EA C514                      		mov.w	@(comm8,gbr),r0
060003EC 600F                        		exts	r0,r0
060003EE 1400                      		mov	r0,@(model_y_rot,r4)
060003F0 E000                      		mov	#0,r0
060003F2 C515                      		mov.w	@(comm10,gbr),r0
060003F4 600F                        		exts	r0,r0
060003F6 1400                      		mov	r0,@(model_z_rot,r4)
060003F8                         		
060003F8 4F26                 		mov.l	@r15+,pr
060003FA 000B                 		rts
060003FC 0009                 		nop
060003FE 0000                 		cnop 0,4
06000400 0000 0000 0000    +  		lits
06000408                      		
06000408                      ; =================================================================
06000408                      ; ------------------------------------------------
06000408                      ; Error
06000408                      ; ------------------------------------------------
06000408                      
06000408                      ErrorTrap:
06000408 AFFE                 		bra	ErrorTrap
0600040A 0009                 		nop
0600040C                      		lits
0600040C                      
0600040C                      ; =================================================================
0600040C                      ; ------------------------------------------------
0600040C                      ; Subs 
0600040C                      ; ------------------------------------------------
0600040C                      
0600040C                      		include	"mars/sh2/subs/vdp.asm"
0600040C                      ; ==================================================================
0600040C                      ; ---------------------------------------------------
0600040C                      ; Super VDP
0600040C                      ; ---------------------------------------------------
0600040C                      
0600040C                      Vdp_NextFrame:
0600040C D100                 		mov	#_vdpreg,r1
0600040E E000                 		mov 	#0,r0
06000410 841B                 		mov.b	@(framectl,r1),r0
06000412 CA01                 		xor	#1,r0
06000414 801B                 		mov.b	r0,@(framectl,r1)
06000416 6203                 		mov 	r0,r2
06000418                      @wait3:
06000418 E000                 		mov 	#0,r0
0600041A 841B                 		mov.b	@(framectl,r1),r0
0600041C 3200                 		cmp/eq	r0,r2
0600041E 8BFB                 		bf	@wait3
06000420 000B                 		rts
06000422 0009                 		nop
06000424                      		cnop 0,4
06000424 0000 0000            		lits
06000428                      
06000428                      ; ---------------------------------------------------
06000428                      ; Vdp_FlipFrame
06000428                      ;
06000428                      ; Flips the framebuffer
06000428                      ;
06000428                      ; Uses:
06000428                      ; r0-r2
06000428                      ; ---------------------------------------------------
06000428                      
06000428                      Vdp_FlipFrame:	
06000428 D100                 		mov	#_vdpreg,r1
0600042A D200                 		mov	#curr_frame,r2
0600042C 841B                 		mov.b	@(framectl,r1),r0
0600042E CA01                 		xor	#1,r0
06000430 801B                 		mov.b	r0,@(framectl,r1)
06000432 2202                 		mov	r0,@r2
06000434 000B                 		rts
06000436 0009                 		nop
06000438                      		cnop 0,4
06000438 0000 0000 0000    +  		lits
06000440                      		
06000440                      ; ----------------------------------------------------
06000440                      ; Wait frame swap
06000440                      ;
06000440                      ; Make sure frame buffer has swapped
06000440                      ;
06000440                      ; Uses:
06000440                      ; r0-r2
06000440                      ; ----------------------------------------------------
06000440                      
06000440                      Vdp_WaitFrame:
06000440 D100                 		mov	#_vdpreg,r1
06000442 D200                 		mov	#curr_frame,r2
06000444 6022                 		mov	@r2,r0
06000446 6203                 		mov	r0,r2
06000448                      @wait3:
06000448 E000                 		mov 	#0,r0
0600044A 841B                 		mov.b	@(framectl,r1),r0
0600044C 3200                 		cmp/eq	r0,r2
0600044E 8BFB                 		bf	@wait3
06000450 000B                 		rts
06000452 0009                 		nop
06000454                      		cnop 0,4
06000454 0000 0000 0000    +  		lits
0600045C                      		
0600045C                      ; ----------------------------------------------------
0600045C                      ; Clear frame buffer
0600045C                      ;
0600045C                      ; Uses:
0600045C                      ; r0-r6
0600045C                      ; ----------------------------------------------------
0600045C                      
0600045C                      		align	4
0600045C                      Vdp_ClearFrame:
0600045C D100                 		mov	#_vdpreg,r1
0600045E D200                 		mov	#255,r2		; 256 words per pass
06000460 D300                 		mov	#$100,r3	; Starting address
06000462 E400                 		mov	#0,r4		; Clear to zero
06000464 D500                 		mov	#256,r5		; Increment address by 256
06000466 D600                 		mov	#140,r6		; 140 passes ((320 * 224) / 256)
06000468                      @loop
06000468 8515                 		mov.w	@(10,r1),r0	; Wait for FEN to clear
0600046A 4001                 		shlr	r0
0600046C 4001                 		shlr	r0
0600046E 89FB                 		bt	@loop
06000470                       
06000470 6023                 		mov	r2,r0
06000472 8112                 		mov.w	r0,@(4,r1)	; Set length
06000474 6033                 		mov	r3,r0
06000476 8113                 		mov.w	r0,@(6,r1)	; Set address
06000478 6043                 		mov	r4,r0
0600047A 8114                 		mov.w	r0,@(8,r1)	; Set data
0600047C                       
0600047C 335C                 		add	r5,r3
0600047E                       
0600047E 4610                 		dt	r6
06000480 8BF2                 		bf	@loop
06000482                       
06000482                      @wait
06000482 8515                 		mov.w	@(10,r1),r0	; Wait for FEN to clear
06000484 4001                 		shlr	r0
06000486 4001                 		shlr	r0
06000488 89FB                 		bt	@wait
0600048A 000B                 		rts
0600048C 0009                 		nop
0600048E                      
0600048E                      ; ---------------------------------------------------
0600048E                      ; VDP_SetMode
0600048E                      ;
0600048E                      ; Set video mode
0600048E                      ; 
0600048E                      ; Input:
0600048E                      ; r1 - mode id
0600048E                      ; 
0600048E                      ; Uses:
0600048E                      ; r1
0600048E                      ; ---------------------------------------------------
0600048E                      
0600048E                      Vdp_SetMode:
0600048E 6013                 		mov	r1,r0
06000490 D100                 		mov.l	#_vdpreg,r1
06000492 8011                 		mov.b	r0,@(bitmapmd,r1)
06000494                      		
06000494 D800                 		mov.l	#_framebuffer,r8
06000496 D600                 		mov.l	#$100,r6
06000498 D500                 		mov.l	#(320/2),r5
0600049A D700                 		mov.l	#224,r7
0600049C                      @mapset1:
0600049C 2861                 		mov.w	r6,@r8
0600049E 7802                 		add	#2,r8
060004A0 365C                 		add	r5,r6
060004A2 4710                 		dt	r7
060004A4 8BFA                 		bf	@mapset1
060004A6                      
060004A6 D200                 		mov	#$80,r2
060004A8                      @wait:
060004A8 841A                 		mov.b	@(vdpsts,r1),r0		; Wait V Blank
060004AA 2028                 		tst	r2,r0
060004AC 89FC                 		bt	@wait
060004AE 841B                 		mov.b	@(framectl,r1),r0	; Frame Buffer Swap
060004B0 6007                 		not	r0,r0
060004B2 801B                 		mov.b	r0,@(framectl,r1)
060004B4                      	
060004B4                      ; ------------------------
060004B4                      ; next framebuffer page
060004B4                      ; ------------------------
060004B4                      
060004B4 D800                 		mov.l	#_framebuffer,r8
060004B6 D600                 		mov.l	#$100,r6
060004B8 D500                 		mov.l	#(320/2),r5
060004BA D700                 		mov.l	#224,r7
060004BC                      @mapset2:
060004BC 2861                 		mov.w	r6,@r8
060004BE 7802                 		add	#2,r8
060004C0 365C                 		add	r5,r6
060004C2 4710                 		dt	r7
060004C4 8BFA                 		bf	@mapset2
060004C6                      		
060004C6 D200                 		mov	#$80,r2
060004C8                      @wait2:
060004C8 841A                 		mov.b	@(vdpsts,r1),r0		; Wait V Blank
060004CA 2028                 		tst	r2,r0
060004CC 89FC                 		bt	@wait2
060004CE 841B                 		mov.b	@(framectl,r1),r0	; Frame Buffer Swap
060004D0 6007                 		not	r0,r0
060004D2 801B                 		mov.b	r0,@(framectl,r1)
060004D4                      		
060004D4 000B                 		rts
060004D6 0009                 		nop
060004D8                      		cnop 0,4
060004D8 0000 0000 0000    +  		lits
060004F8                      
060004F8                      ; ---------------------------------------------------
060004F8                      ; Vsync_M
060004F8                      ; 
060004F8                      ; Wait for VBlank, Master CPU
060004F8                      ; ---------------------------------------------------
060004F8                      
060004F8                      Vsync_M:
060004F8 D100                 		mov.l	#vint_m_sync,r1
060004FA E001                 		mov.l	#1,r0
060004FC 2102                 		mov.l	r0,@r1
060004FE                      
060004FE                      @wait:
060004FE 6012                 		mov.l	@r1,r0
06000500 8800                 		cmp/eq	#0,r0
06000502 8BFC                 		bf	@wait
06000504 000B                 		rts
06000506 0009                 		nop
06000508                      		cnop 0,4
06000508 0000 0000            		lits
0600050C                      
0600050C                      ; ---------------------------------------------------
0600050C                      ; Vsync_S
0600050C                      ; 
0600050C                      ; Wait for VBlank, Slave CPU
0600050C                      ; ---------------------------------------------------
0600050C                      
0600050C                      Vsync_S:
0600050C D100                 		mov.l	#vint_s_sync,r1
0600050E E001                 		mov.l	#1,r0
06000510 2102                 		mov.l	r0,@r1
06000512                      
06000512                      @wait:
06000512 6012                 		mov.l	@r1,r0
06000514 8800                 		cmp/eq	#0,r0
06000516 8BFC                 		bf	@wait
06000518 000B                 		rts
0600051A 0009                 		nop
0600051C                      		cnop 0,4
0600051C 0000 0000            		lits
06000520                      		
06000520                      ; ---------------------------------------------------
06000520                      ; Vdp_LoadPal_Raw
06000520                      ;
06000520                      ; Loads RAW palette, modes 1 and 3 only.
06000520                      ; 
06000520                      ; Input:
06000520                      ; r1 - input
06000520                      ; r2 - start from
06000520                      ; r3 - number of colors
06000520                      ; r4 - output
06000520                      ;
06000520                      ; Uses:
06000520                      ; r4-r5
06000520                      ; ---------------------------------------------------
06000520                      
06000520                      Vdp_LoadPal_Raw:
06000520                      ; 		mov.l	#pal_buffer,r4
06000520 D600                  		mov.l	#pal_priobuff,r6
06000522 7301                  		add 	#1,r3
06000524                      ; 		mov.l	#256,r3
06000524                      @next:
06000524 E700                 		mov.l	#$0000,r7		;prio
06000526                      
06000526 6014                  		mov.b	@r1+,r0			;R
06000528 C9FF                   		and	#$FF,r0
0600052A 4009                   		shlr2	r0
0600052C 4001                  		shlr 	r0
0600052E 370C                  		add	r0,r7
06000530 6014                   		mov.b	@r1+,r0			;G
06000532 C9FF                   		and	#$FF,r0
06000534 4009                   		shlr2	r0
06000536 4001                   		shlr 	r0
06000538 4008                   		shll2	r0
0600053A 4008                   		shll2	r0
0600053C 4000                   		shll	r0
0600053E 370C                   		add	r0,r7
06000540 6014                   		mov.b	@r1+,r0			;B
06000542 C9FF                   		and	#$FF,r0
06000544 4009                   		shlr2	r0
06000546 4001                   		shlr 	r0
06000548 4018                   		shll8	r0
0600054A 4008                   		shll2	r0
0600054C 370C                   		add	r0,r7
0600054E                       		
0600054E 2471                  		mov.w	r7,@r4	
06000550 4310                  		dt	r3
06000552 8FE7                  		bf/s	@next
06000554 7402                  		add	#2,r4	
06000556                      
06000556 000B                  		rts
06000558 0009                  		nop
0600055A 0000                  		cnop 0,4
0600055C 0000 0000             		lits
06000560                       		
06000560                      ; ; ---------------------------------------------------
06000560                      ; ; Vdp_LoadPal_Fade
06000560                      ; ;
06000560                      ; ; Loads RAW palette, fadein/fadeout
06000560                      ; ; modes 1 and 3 only.
06000560                      ; ; 
06000560                      ; ; Input:
06000560                      ; ; r1 - input
06000560                      ; ; r2 - start from
06000560                      ; ; r3 - number of colors
06000560                      ; ; r4 - output
06000560                      ; ;
06000560                      ; ; Uses:
06000560                      ; ; r4-r5
06000560                      ; ; ---------------------------------------------------
06000560                      ; 
06000560                      ; Vdp_LoadPal_Fade:
06000560                      ; 		mov.l	#pal_fadebuff,r4
06000560                      ;  		mov.l	#pal_priobuff,r6
06000560                      ; 		mov.l	#256,r5
06000560                      ; @next:
06000560                      ; 		mov.l	#$0000,r7		;prio
06000560                      ; 
06000560                      ;  		mov.b	@r1+,r0			;R
06000560                      ;   		and	#$FF,r0
06000560                      ;   		shlr2	r0
06000560                      ;  		shlr 	r0
06000560                      ;  		add	r0,r7
06000560                      ;   		mov.b	@r1+,r0			;G
06000560                      ;   		and	#$FF,r0
06000560                      ;   		shlr2	r0
06000560                      ;   		shlr 	r0
06000560                      ;   		shll2	r0
06000560                      ;   		shll2	r0
06000560                      ;   		shll	r0
06000560                      ;   		add	r0,r7
06000560                      ;   		mov.b	@r1+,r0			;B
06000560                      ;   		and	#$FF,r0
06000560                      ;   		shlr2	r0
06000560                      ;   		shlr 	r0
06000560                      ;   		shll8	r0
06000560                      ;   		shll2	r0
06000560                      ;   		add	r0,r7
06000560                      ;  		
06000560                      ;  		mov.w	r7,@r4	
06000560                      ;  		dt	r5
06000560                      ;  		bf/s	@next
06000560                      ;  		add	#2,r4	
06000560                      ; 
06000560                      ;  		rts
06000560                      ;  		nop
06000560                      ;  		cnop 0,4
06000560                      ;  		lits
06000560                      		
06000560                      ; ---------------------------------------------------
06000560                      ; Vdp_LoadArt
06000560                      ;
06000560                      ; Loads graphics
06000560                      ; 
06000560                      ; Input:
06000560                      ; r1 - Data
06000560                      ; r2 - Xpos
06000560                      ; r3 - Ypos
06000560                      ; r4 - Width
06000560                      ; r5 - Height
06000560                      ; r6 - Mode
06000560                      ;
06000560                      ; Uses:
06000560                      ; r7-r9
06000560                      ; ---------------------------------------------------
06000560                      
06000560                      Vdp_LoadArt:
06000560 6063                 		mov.l	r6,r0
06000562 8803                  		cmp/eq	#3,r0
06000564 8900                 		bt	@rle_art
06000566 8802                  		cmp/eq	#2,r0
06000568 8900                 		bt	@hicolor_art
0600056A                      
0600056A D600                 		mov.l	#_framebuffer+$200,r6
0600056C 362C                   		add	r2,r6			; X-pos
0600056E                       
0600056E D000                     		mov	#320,r0			; Y-pos
06000570 203E                     		mulu	r3,r0
06000572 001A                     		mov	macl,r0
06000574 360C                     		add 	r0,r6
06000576                          		
06000576 D000                     		mov.l	#224,r0
06000578 3507                     		cmp/gt	r0,r5
0600057A 8B00                     		bf	@loop_Y
0600057C D500                     		mov.l	#224,r5
0600057E                      @loop_Y:
0600057E 6763                 		mov.l	r6,r7			; Save framebuffer address
06000580 6813                 		mov.l	r1,r8			; Save art address
06000582 6943                 		mov.l	r4,r9			; Save width
06000584                      @loop_X:
06000584 6014                 		mov.b	@r1+,r0
06000586 2600                  		mov.b	r0,@r6
06000588 7601                  		add 	#1,r6
0600058A                      		
0600058A 4410                  		dt	r4
0600058C 8BFA                  		bf	@loop_X
0600058E                      
0600058E 6493                 		mov.l	r9,r4			; Restore width
06000590 6183                 		mov.l	r8,r1			; Restore art address
06000592 6673                 		mov.l	r7,r6			; Restore framebuffer address
06000594 314C                 		add	r4,r1			; art + width = new addr
06000596 364C                 		add	r4,r6			; framebuffer + width = new addr
06000598                      
06000598 4510                 		dt	r5
0600059A 8BF0                 		bf	@loop_Y
0600059C 000B                 		rts
0600059E 0009                 		nop
060005A0                      		cnop 0,4
060005A0 0000 0000 0000    +  		lits
060005AC                      
060005AC                      ; -------------------------
060005AC                      ; mode 2
060005AC                      ; -------------------------
060005AC                      
060005AC                      @hicolor_art:
060005AC D600                 		mov.l	#_framebuffer+$200,r6
060005AE                        		;Xadd here
060005AE                        		;Yadd here
060005AE                      
060005AE D000                     		mov.l	#204,r0
060005B0 3507                     		cmp/gt	r0,r5
060005B2 8B00                     		bf	@hloop_Y
060005B4 D500                     		mov.l	#204,r5
060005B6                      @hloop_Y:
060005B6 6763                 		mov.l	r6,r7			; Save framebuffer address
060005B8 6813                 		mov.l	r1,r8			; Save art address
060005BA 6943                 		mov.l	r4,r9			; Save width
060005BC                      		
060005BC                      @hloop_X:
060005BC E200                 		mov.l	#$0000,r2		; priority
060005BE                      
060005BE 6014                 		mov.b	@r1+,r0			; R
060005C0 C9FF                 		and	#$FF,r0
060005C2 4009                  		shlr2	r0
060005C4 4001                 		shlr 	r0
060005C6 320C                 		add	r0,r2
060005C8                      
060005C8 6014                  		mov.b	@r1+,r0			; G
060005CA C9FF                 		and	#$FF,r0
060005CC 4009                  		shlr2	r0
060005CE 4001                  		shlr 	r0
060005D0 4008                  		shll2	r0
060005D2 4008                  		shll2	r0
060005D4 4000                  		shll	r0
060005D6 320C                  		add	r0,r2
060005D8                       
060005D8 6014                  		mov.b	@r1+,r0			; B
060005DA C9FF                 		and	#$FF,r0
060005DC 4009                  		shlr2	r0
060005DE 4001                  		shlr 	r0
060005E0 4018                  		shll8	r0
060005E2 4008                  		shll2	r0
060005E4 320C                  		add	r0,r2
060005E6                      		
060005E6 2621                 		mov.w	r2,@r6
060005E8 7602                 		add.l	#2,r6
060005EA                      		
060005EA 4410                  		dt	r4
060005EC 8BE6                  		bf	@hloop_X
060005EE                       		
060005EE 6493                 		mov.l	r9,r4			; Restore width
060005F0 6183                 		mov.l	r8,r1			; Restore art address
060005F2 6673                 		mov.l	r7,r6			; Restore framebuffer address
060005F4                      		
060005F4 E002                 		mov.l	#2,r0
060005F6 240E                 		mulu	r0,r4
060005F8 001A                 		mov	macl,r0
060005FA 360C                 		add	r0,r6
060005FC                      		
060005FC E003                 		mov.l	#3,r0
060005FE 240E                 		mulu	r0,r4
06000600 001A                 		mov	macl,r0
06000602 310C                      		add 	r0,r1
06000604                      		
06000604 4510                  		dt	r5
06000606 8BD6                  		bf	@hloop_Y
06000608                       		
06000608 000B                 		rts
0600060A 0009                 		nop
0600060C                      		cnop 0,4
0600060C 0000 0000 0000    +  		lits
06000614                      	
06000614                      ; -------------------------
06000614                      ; mode 3
06000614                      ; -------------------------
06000614                      
06000614                      @rle_art:
06000614 D600                 		mov.l	#_framebuffer+$200,r6
06000616 362C                   		add	r2,r6			;X-pos
06000618                       
06000618 D000                     		mov	#320,r0			;Y-pos
0600061A 203E                     		mulu	r3,r0
0600061C 001A                     		mov	macl,r0
0600061E 360C                     		add 	r0,r6
06000620                      
06000620                      @rleloop_Y:
06000620 6763                 		mov.l	r6,r7			; Save framebuffer address
06000622 6813                 		mov.l	r1,r8			; Save art address
06000624 6943                 		mov.l	r4,r9			; Save width
06000626                      
06000626                      @rleloop_X:
06000626 6014                 		mov.b	@r1+,r0
06000628 2600                 		mov.b	r0,@r6
0600062A 7601                  		add 	#1,r6
0600062C                      		
0600062C 4410                  		dt	r4
0600062E 8BFA                  		bf	@rleloop_X
06000630                      
06000630 6493                 		mov.l	r9,r4			; Restore width
06000632 6183                 		mov.l	r8,r1			; Restore art address
06000634 6673                 		mov.l	r7,r6			; Restore framebuffer address
06000636 314C                 		add	r4,r1			; art + width = new addr
06000638 364C                 		add	r4,r6			; framebuffer + width = new addr
0600063A                      
0600063A 4510                 		dt	r5
0600063C 8B9F                 		bf	@loop_Y
0600063E 000B                 		rts
06000640 0009                 		nop
06000642 0000                 		cnop 0,4
06000644 0000 0000 0000    +  		lits
0600064C                      		
0600064C                      		
0600064C                      		include	"mars/sh2/subs/fade.asm"
0600064C                      ; ==================================================================
0600064C                      ; ---------------------------------------------------
0600064C                      ; FadeIn / FadeOut
0600064C                      ; ---------------------------------------------------
0600064C                      
0600064C                      ; ---------------------------------------
0600064C                      ; Variables
0600064C                      ; ---------------------------------------
0600064C                      
0600064C =00000001            ID_FadeOut		equ	$01
0600064C =00000002            ID_FadeIn		equ	$02
0600064C =00000003            ID_ToWhite		equ	$03
0600064C =00000004            ID_FadeWhite		equ	$04
0600064C                      
0600064C                      ; ---------------------------------------
0600064C                      
0600064C                      			rsreset
0600064C =00000000            fade_request		rs.l	1
0600064C =00000004            fade_flags		rs.l	1
0600064C =00000008            fade_start		rs.l	1
0600064C =0000000C            fade_end		rs.l	1
0600064C =00000010            fade_timer		rs.l	1
0600064C =00000014            fade_timerset		rs.l	1
0600064C                      
0600064C                      ; ---------------------------------------
0600064C                      
0600064C =00000007            bitFinished		equ 	7
0600064C                      		
0600064C                      ; ==================================================================
0600064C                      ; ---------------------------------------------------
0600064C                      ; pal_fade
0600064C                      ; ---------------------------------------------------
0600064C                      	
0600064C                      pal_fade:
0600064C D900                 		mov.l	#palfade_control,r9
0600064E 5091                 		mov.l	@(fade_flags,r9),r0
06000650 8800                 		cmp/eq	#0,r0
06000652 8900                 		bt	@NotFinished
06000654 5094                 		mov.l	@(fade_timer,r9),r0
06000656 70FF                 		sub 	#1,r0
06000658 1904                 		mov.l	r0,@(fade_timer,r9)
0600065A 4011                 		cmp/pz	r0
0600065C 8B00                 		bf	@Finished
0600065E 000B                 		rts
06000660 0009                 		nop
06000662                      @NotFinished:
06000662 5090                 		mov.l	@(fade_request,r9),r0
06000664 4008                 		shll2	r0
06000666 D100                 		mov.l	#@DoList,r1
06000668 301C                 		add	r1,r0
0600066A 6102                 		mov.l	@r0,r1
0600066C 412B                 		jmp	@r1
0600066E 0009                 		nop
06000670                      @Finished:
06000670 5095                 		mov.l	@(fade_timerset,r9),r0
06000672 1904                 		mov.l	r0,@(fade_timer,r9)
06000674 E000                 		mov 	#0,r0
06000676 1900                 		mov 	r0,@(fade_request,r9)
06000678 1901                 		mov 	r0,@(fade_flags,r9)
0600067A                      		
0600067A C421                 		mov.b	@(comm0+1,gbr),r0
0600067C C9EF                 		and 	#%11101111,r0				;PalFade flag RESET
0600067E C021                 		mov.b	r0,@(comm0+1,gbr)
06000680                      		
06000680 000B                 		rts
06000682 0009                 		nop
06000684                      		align 4
06000684 0000 0000 0000    +  		lits
0600068C                      		
0600068C                      ; =====================================================
0600068C                      
0600068C                      @DoList:
0600068C 0000 0000            		dc.l	@Return
06000690 0000 0000            		dc.l	@FadeOut
06000694 0000 0000            		dc.l	@FadeIn
06000698 0000 0000            		dc.l	@Return
0600069C 0000 0000            		dc.l	@Return
060006A0                      		even
060006A0                      
060006A0                      ; =====================================================
060006A0                      ; ---------------------------------------------------
060006A0                      ; FadeOut
060006A0                      ; ---------------------------------------------------
060006A0                      	
060006A0                      @FadeOut:
060006A0 5094                 		mov.l	@(fade_timer,r9),r0
060006A2 70FF                 		sub 	#1,r0
060006A4 1904                 		mov.l	r0,@(fade_timer,r9)
060006A6 4011                 		cmp/pz	r0
060006A8 8900                 		bt	@Return_Out
060006AA 5095                 		mov	@(fade_timerset,r9),r0
060006AC 1904                 		mov 	r0,@(fade_timer,r9)
060006AE                      	
060006AE D700                 		mov.l	#pal_buffer,r7
060006B0 5092                 		mov.l	@(fade_start,r9),r0
060006B2 4000                 		shll 	r0
060006B4 370C                 		add 	r0,r7
060006B6                      
060006B6 5693                 		mov.l	@(fade_end,r9),r6
060006B8 7601                 		add 	#1,r6	
060006BA E500                  		mov	#0,r5
060006BC E200                  		mov 	#0,r2
060006BE                      @Next_ColorOut:
060006BE E41F                  		move.w	#%11111,r4		;MAX color
060006C0 E000                  		mov 	#0,r0
060006C2 6071                  		mov.w	@r7,r0
060006C4 6103                    		mov	r0,r1
060006C6 2149                    		and	r4,r1
060006C8 3120                    		cmp/eq	r2,r1
060006CA 8900                    		bt	@RedFirstOut
060006CC E101                   		mov 	#1,r1
060006CE 3018                  		sub	r1,r0
060006D0                      @RedFirstOut:
060006D0 4408                  		shll2 	r4
060006D2 4408                  		shll2 	r4
060006D4 4400                  		shll 	r4
060006D6 6103                   		mov	r0,r1
060006D8 2149                   		and	r4,r1
060006DA 3120                   		cmp/eq	r2,r1
060006DC 8900                   		bt	@GreenFirstOut
060006DE E120                   		mov 	#$20,r1
060006E0 3018                  		sub	r1,r0
060006E2                      @GreenFirstOut:
060006E2 4408                  		shll2 	r4
060006E4 4408                  		shll2 	r4
060006E6 4400                  		shll 	r4
060006E8 6103                   		mov	r0,r1
060006EA 2149                   		and	r4,r1
060006EC 3120                   		cmp/eq	r2,r1
060006EE 8900                   		bt	@BlueFirstOut
060006F0 D100                   		mov 	#$400,r1
060006F2 3018                   		sub 	r1,r0
060006F4                      @BlueFirstOut:
060006F4 D300                  		mov 	#$7FFF,r3
060006F6 6103                  		mov	r0,r1
060006F8 2139                  		and	r3,r1
060006FA 3120                  		cmp/eq	r2,r1
060006FC 8B00                  		bf	@NotBlackOut
060006FE 7501                  		add	#1,r5
06000700                      @NotBlackOut:
06000700 2039                 		and 	r3,r0
06000702 2701                 		mov.w	r0,@r7
06000704 7702                 		add 	#2,r7
06000706 4610                 		dt	r6
06000708 8BD9                 		bf	@Next_ColorOut
0600070A                      		
0600070A 5093                  		mov.l	@(fade_end,r9),r0
0600070C 3503                  		cmp/ge	r0,r5
0600070E 8B00                  		bf	@Return_Out
06000710                       		
06000710 E001                 		mov	#1,r0
06000712 1901                 		mov.l	r0,@(fade_flags,r9)
06000714                       	
06000714                      @Return_Out:
06000714 000B                 		rts
06000716 0009                 		nop
06000718                      		align 4
06000718 0000 0000 0000    +  		lits
06000724                      		
06000724                      ; =====================================================
06000724                      ; ---------------------------------------------------
06000724                      ; FadeIn
06000724                      ; ---------------------------------------------------
06000724                      
06000724                      @FadeIn:
06000724 5094                 		mov.l	@(fade_timer,r9),r0
06000726 70FF                 		sub 	#1,r0
06000728 1904                 		mov.l	r0,@(fade_timer,r9)
0600072A 4011                 		cmp/pz	r0
0600072C 8900                 		bt	@Return
0600072E 5095                 		mov	@(fade_timerset,r9),r0
06000730 1904                 		mov 	r0,@(fade_timer,r9)
06000732                      	
06000732 D700                 		mov.l	#pal_buffer,r7
06000734 D800                 		mov.l	#pal_fadebuff,r8
06000736                      		
06000736 5092                 		mov.l	@(fade_start,r9),r0
06000738 4000                 		shll 	r0
0600073A 370C                 		add 	r0,r7
0600073C 380C                 		add 	r0,r8
0600073E                      
0600073E 5693                 		mov.l	@(fade_end,r9),r6
06000740                      ; 		mov 	#0,r0
06000740                      ; 		cmp/eq	r0,r6
06000740                      ; 		bt	@zero
06000740 7601                 		add 	#1,r6	
06000742                      ; @zero:
06000742 E500                 		mov	#0,r5
06000744                      		
06000744                      @Next_Color:
06000744 E41F                 		move.w	#%11111,r4		;MAX color
06000746 E000                 		mov 	#0,r0
06000748 E100                 		mov 	#0,r1
0600074A 6071                  		mov.w	@r7,r0
0600074C 6181                  		mov.w	@r8,r1
0600074E 6203                  		mov	r0,r2
06000750 6313                  		mov	r1,r3
06000752 2249                  		and	r4,r2
06000754 2349                  		and	r4,r3
06000756 3233                  		cmp/ge	r3,r2
06000758 8900                  		bt	@RedFirst
0600075A E201                  		mov 	#1,r2
0600075C 302C                 		add	r2,r0
0600075E                      @RedFirst:
0600075E 4408                 		shll2 	r4
06000760 4408                 		shll2 	r4
06000762 4400                 		shll 	r4
06000764 6203                  		mov	r0,r2
06000766 6313                  		mov	r1,r3
06000768 2249                  		and	r4,r2
0600076A 2349                  		and	r4,r3
0600076C 3233                  		cmp/ge	r3,r2
0600076E 8900                  		bt	@GreenFirst
06000770 E220                  		mov 	#$20,r2
06000772 302C                 		add	r2,r0
06000774                      @GreenFirst:
06000774 4408                 		shll2 	r4
06000776 4408                 		shll2 	r4
06000778 4400                 		shll 	r4
0600077A 6203                  		mov	r0,r2
0600077C 6313                  		mov	r1,r3
0600077E 2249                  		and	r4,r2
06000780 2349                  		and	r4,r3
06000782 3233                  		cmp/ge	r3,r2
06000784 8900                  		bt	@BlueFirst
06000786 D200                  		mov 	#$400,r2
06000788 302C                 		add	r2,r0
0600078A                      @BlueFirst:
0600078A 3100                   		cmp/eq	r0,r1
0600078C 8B00                   		bf	@NotEqual
0600078E 7501                   		add	#1,r5
06000790                      @NotEqual:
06000790 2701                  		mov.w	r0,@r7
06000792 7702                  		add 	#2,r7
06000794 7802                  		add	#2,r8
06000796 4610                  		dt 	r6
06000798 8BD4                  		bf	@Next_Color
0600079A                      
0600079A 5093                  		mov.l	@(fade_end,r9),r0
0600079C 3503                  		cmp/ge	r0,r5
0600079E 8B00                  		bf	@Return
060007A0                       		
060007A0 E001                 		mov	#1,r0
060007A2 1901                 		mov.l	r0,@(fade_flags,r9)
060007A4                       		
060007A4 000B                 		rts
060007A6 0009                 		nop
060007A8                      		align 4
060007A8 0000 0000 0000    +  		lits
060007B4                      		
060007B4                      ; =====================================================
060007B4                      ; ---------------------------------------------------
060007B4                      ; Nothing
060007B4                      ; ---------------------------------------------------
060007B4                      
060007B4                      @Return:
060007B4 000B                 		rts
060007B6 0009                 		nop
060007B8                      		align 4
060007B8                      		lits
060007B8                      
060007B8                      ; ==================================================================
060007B8                      ; ---------------------------------------------------
060007B8                      ; pal_fade
060007B8                      ;
060007B8                      ; r1 - request type
060007B8                      ; r2 - speed
060007B8                      ; r3 - start from
060007B8                      ; r4 - number of colors
060007B8                      ; ---------------------------------------------------
060007B8                      
060007B8                      palfade_set:
060007B8 D500                 		mov.l	#palfade_control,r5
060007BA                      	
060007BA 1525                 		mov	r2,@(fade_timerset,r5)
060007BC 1532                 		mov 	r3,@(fade_start,r5)
060007BE 1543                 		mov 	r4,@(fade_end,r5)
060007C0 1510                 		mov	r1,@(fade_request,r5)
060007C2                      		
060007C2 C421                 		mov.b	@(comm0+1,gbr),r0
060007C4 CB10                 		or	#%00010000,r0		;PalFade flag SET
060007C6 C021                 		mov.b	r0,@(comm0+1,gbr)
060007C8                      		
060007C8 000B                 		rts
060007CA 0009                 		nop
060007CC                      		align 4
060007CC 0000 0000            		lits
060007D0                      		
060007D0                      		
060007D0                       		include	"mars/sh2/subs/3d.asm"
060007D0                      ; =================================================================
060007D0                      ; ----------------------------------------
060007D0                      ; MARS 3D
060007D0                      ;
060007D0                      ;
060007D0                      ; @model:
060007D0                      ;		dc.l @faces
060007D0                      ;		dc.l @nodes
060007D0                      ;		dc.l @material
060007D0                      ;		dc.l -32		; Farest Z to start	
060007D0                      ;		
060007D0                      ; @nodes:
060007D0                      ; 		dc.w 64,64,64		; X Y Z
060007D0                      ;
060007D0                      ; face options:
060007D0                      ;		3 - triangle
060007D0                      ;		4 - square
060007D0                      ;		other value: end-of-list
060007D0                      ; @faces:
060007D0                      ;		dc.w 3			; triangle or quad
060007D0                      ;		dc.w 0			; texture ID from @material
060007D0                      ; 		dc.w 0,12,14		; connect to these @nodes
060007D0                      ;
060007D0                      ; @material:
060007D0                      ; 		dc.l 1			; ID
060007D0                      ; 		dc.l 255,0		; Solid color, unused
060007D0                      ;        	dc.l 0
060007D0                      ;  		dc.l texture,0,0	; texture, width, $xx add
060007D0                      ;  		dc.l 128,  0		; texture setup
060007D0                      ;  		dc.l   0,  0
060007D0                      ;  		dc.l   0,128
060007D0                      ;        	dc.l   0,  0		; unused if triangle
060007D0                      ;		dc.l -1			; end of list
060007D0                      
060007D0                      ; SOURCE data format:
060007D0                      ; 
060007D0                      ; dc.l 3, points_num
060007D0                      
060007D0                      ; ----------------------------------------
060007D0                      ; Variables
060007D0                      ; ----------------------------------------
060007D0                      
060007D0 =00000140            max_width	equ	320
060007D0 =000000E0            max_height	equ	224
060007D0 =00000400            numof_faces	equ	1024
060007D0 =00000020            numof_models	equ	32
060007D0                      
060007D0                      ; ------------------------------------
060007D0                      ; TML
060007D0                      ; ------------------------------------
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            tml_dst_y	rs.l	1
060007D0 =00000004            tml_bottom_y	rs.l	1
060007D0                      
060007D0 =00000008            tml_texture	rs.l	1
060007D0 =0000000C            tml_texwidth	rs.l	1
060007D0 =00000010            tml_texadd	rs.l	1
060007D0 =00000014            tml_flags	rs.l	1
060007D0 =00000018            tml_left	rs.l	1
060007D0 =0000001C            tml_right	rs.l	1
060007D0 =00000020            sizeof_tml	rs.l	0
060007D0                      
060007D0                      ; ------------------------------------
060007D0                      ; DDA
060007D0                      ; ------------------------------------
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            dda_src_point	rs.l	1
060007D0 =00000004            dda_src_low	rs.l	1
060007D0 =00000008            dda_src_high	rs.l	1
060007D0 =0000000C            dda_src_x	rs.l	1
060007D0 =00000010            dda_src_dx	rs.l	1
060007D0 =00000014            dda_src_y	rs.l	1
060007D0 =00000018            dda_src_dy	rs.l	1
060007D0                      
060007D0 =0000001C            dda_dst_point	rs.l	1
060007D0 =00000020            dda_dst_low	rs.l	1
060007D0 =00000024            dda_dst_high	rs.l	1
060007D0 =00000028            dda_dst_x	rs.l	1
060007D0 =0000002C            dda_dst_dx	rs.l	1
060007D0 =00000030            dda_dst_h	rs.l	1
060007D0 =00000034            sizeof_dda	rs.l	0
060007D0                      
060007D0                      ; ------------------------------------
060007D0                      ; Points
060007D0                      ; for both source and destination
060007D0                      ; ------------------------------------
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            point_x		rs.l	1
060007D0 =00000004            point_y		rs.l	1
060007D0 =00000008            sizeof_point	rs.l	0
060007D0                      
060007D0                      ; ------------------------------------
060007D0                      ; Playfield buffer
060007D0                      ; ------------------------------------
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            world_x		rs.l	1
060007D0 =00000004            world_y		rs.l	1
060007D0 =00000008            world_z		rs.l	1
060007D0 =0000000C            world_x_rot	rs.l	1
060007D0 =00000010            world_y_rot	rs.l	1
060007D0 =00000014            world_z_rot	rs.l	1
060007D0                      
060007D0                      ; ------------------------------------
060007D0                      ; Models buffer
060007D0                      ; ------------------------------------
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            model_addr	rs.l	1
060007D0 =00000004            model_x		rs.l	1
060007D0 =00000008            model_y		rs.l	1
060007D0 =0000000C            model_z		rs.l	1
060007D0 =00000010            model_x_rot	rs.l	1
060007D0 =00000014            model_y_rot	rs.l	1
060007D0 =00000018            model_z_rot	rs.l	1				; NOT DONE
060007D0                      ; model_z_start	rs.l	1				; MAX Z back to check
060007D0 =0000001C            model_flags	rs.l	1				; 0 - normal, 1 - world algorithm NOT DONE
060007D0 =00000020            sizeof_model	rs.l	0
060007D0                      ;     		inform 0,"%h",sizeof_model
060007D0                      
060007D0                      ; ------------------------------------
060007D0                      ; Faces buffer
060007D0                      ; ------------------------------------
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            faces_used	rs.l	1
060007D0 =00000004            faces_data	rs.l	1
060007D0                      
060007D0                      		rsreset
060007D0 =00000000            face_flags	rs.l	1
060007D0 =00000004            face_tex	rs.l	1
060007D0 =00000008            face_tex_add	rs.l	1
060007D0 =0000000C            face_tex_width	rs.l	1
060007D0 =00000010            faces_type	rs.l	1
060007D0 =00000014            faces_srcaddr	rs.l	1
060007D0 =00000018            face_points	rs.l	3*4
060007D0 =00000048            sizeof_face	rs.l	0
060007D0                      
060007D0                      ; =================================================================
060007D0                      ; ----------------------------------------
060007D0                      ; Data
060007D0                      ; ----------------------------------------
060007D0                      
060007D0 0000 0000 0000    +  sin_table	dc.l $00000000,$000000c9,$00000192,$0000025b
060007E0 0000 0324 0000    +  		dc.l $00000324,$000003ed,$000004b6,$0000057f
060007F0 0000 0648 0000    +  		dc.l $00000648,$00000711,$000007da,$000008a3
06000800 0000 096C 0000    +  		dc.l $0000096c,$00000a35,$00000afe,$00000bc6
06000810 0000 0C8F 0000    +  		dc.l $00000c8f,$00000d58,$00000e21,$00000eea
06000820 0000 0FB2 0000    +  		dc.l $00000fb2,$0000107b,$00001144,$0000120c
06000830 0000 12D5 0000    +  		dc.l $000012d5,$0000139d,$00001466,$0000152e
06000840 0000 15F6 0000    +  		dc.l $000015f6,$000016bf,$00001787,$0000184f
06000850 0000 1917 0000    +  		dc.l $00001917,$000019df,$00001aa7,$00001b6f
06000860 0000 1C37 0000    +  		dc.l $00001c37,$00001cff,$00001dc7,$00001e8e
06000870 0000 1F56 0000    +  		dc.l $00001f56,$0000201d,$000020e5,$000021ac
06000880 0000 2273 0000    +  		dc.l $00002273,$0000233b,$00002402,$000024c9
06000890 0000 2590 0000    +  		dc.l $00002590,$00002656,$0000271d,$000027e4
060008A0 0000 28AA 0000    +  		dc.l $000028aa,$00002971,$00002a37,$00002afe
060008B0 0000 2BC4 0000    +  		dc.l $00002bc4,$00002c8a,$00002d50,$00002e15
060008C0 0000 2EDB 0000    +  		dc.l $00002edb,$00002fa1,$00003066,$0000312c
060008D0 0000 31F1 0000    +  		dc.l $000031f1,$000032b6,$0000337b,$00003440
060008E0 0000 3505 0000    +  		dc.l $00003505,$000035c9,$0000368e,$00003752
060008F0 0000 3817 0000    +  		dc.l $00003817,$000038db,$0000399f,$00003a62
06000900 0000 3B26 0000    +  		dc.l $00003b26,$00003bea,$00003cad,$00003d70
06000910 0000 3E33 0000    +  		dc.l $00003e33,$00003ef6,$00003fb9,$0000407c
06000920 0000 413E 0000    +  		dc.l $0000413e,$00004201,$000042c3,$00004385
06000930 0000 4447 0000    +  		dc.l $00004447,$00004508,$000045ca,$0000468b
06000940 0000 474D 0000    +  		dc.l $0000474d,$0000480e,$000048ce,$0000498f
06000950 0000 4A50 0000    +  		dc.l $00004a50,$00004b10,$00004bd0,$00004c90
06000960 0000 4D50 0000    +  		dc.l $00004d50,$00004e0f,$00004ecf,$00004f8e
06000970 0000 504D 0000    +  		dc.l $0000504d,$0000510c,$000051ca,$00005289
06000980 0000 5347 0000    +  		dc.l $00005347,$00005405,$000054c3,$00005581
06000990 0000 563E 0000    +  		dc.l $0000563e,$000056fb,$000057b8,$00005875
060009A0 0000 5931 0000    +  		dc.l $00005931,$000059ee,$00005aaa,$00005b66
060009B0 0000 5C22 0000    +  		dc.l $00005c22,$00005cdd,$00005d98,$00005e53
060009C0 0000 5F0E 0000    +  		dc.l $00005f0e,$00005fc9,$00006083,$0000613d
060009D0 0000 61F7 0000    +  		dc.l $000061f7,$000062b1,$0000636a,$00006423
060009E0 0000 64DC 0000    +  		dc.l $000064dc,$00006595,$0000664d,$00006705
060009F0 0000 67BD 0000    +  		dc.l $000067bd,$00006875,$0000692d,$000069e4
06000A00 0000 6A9B 0000    +  		dc.l $00006a9b,$00006b51,$00006c08,$00006cbe
06000A10 0000 6D74 0000    +  		dc.l $00006d74,$00006e29,$00006edf,$00006f94
06000A20 0000 7049 0000    +  		dc.l $00007049,$000070fd,$000071b1,$00007265
06000A30 0000 7319 0000    +  		dc.l $00007319,$000073cd,$00007480,$00007533
06000A40 0000 75E5 0000    +  		dc.l $000075e5,$00007698,$0000774a,$000077fb
06000A50 0000 78AD 0000    +  		dc.l $000078ad,$0000795e,$00007a0f,$00007ac0
06000A60 0000 7B70 0000    +  		dc.l $00007b70,$00007c20,$00007cd0,$00007d7f
06000A70 0000 7E2E 0000    +  		dc.l $00007e2e,$00007edd,$00007f8b,$0000803a
06000A80 0000 80E7 0000    +  		dc.l $000080e7,$00008195,$00008242,$000082ef
06000A90 0000 839C 0000    +  		dc.l $0000839c,$00008448,$000084f4,$000085a0
06000AA0 0000 864B 0000    +  		dc.l $0000864b,$000086f6,$000087a1,$0000884b
06000AB0 0000 88F5 0000    +  		dc.l $000088f5,$0000899f,$00008a48,$00008af1
06000AC0 0000 8B9A 0000    +  		dc.l $00008b9a,$00008c42,$00008cea,$00008d92
06000AD0 0000 8E39 0000    +  		dc.l $00008e39,$00008ee0,$00008f87,$0000902d
06000AE0 0000 90D3 0000    +  		dc.l $000090d3,$00009179,$0000921e,$000092c3
06000AF0 0000 9368 0000    +  		dc.l $00009368,$0000940c,$000094b0,$00009553
06000B00 0000 95F6 0000    +  		dc.l $000095f6,$00009699,$0000973c,$000097de
06000B10 0000 987F 0000    +  		dc.l $0000987f,$00009921,$000099c2,$00009a62
06000B20 0000 9B02 0000    +  		dc.l $00009b02,$00009ba2,$00009c42,$00009ce1
06000B30 0000 9D7F 0000    +  		dc.l $00009d7f,$00009e1e,$00009ebc,$00009f59
06000B40 0000 9FF6 0000    +  		dc.l $00009ff6,$0000a093,$0000a12f,$0000a1cb
06000B50 0000 A267 0000    +  		dc.l $0000a267,$0000a302,$0000a39d,$0000a438
06000B60 0000 A4D2 0000    +  		dc.l $0000a4d2,$0000a56b,$0000a605,$0000a69d
06000B70 0000 A736 0000    +  		dc.l $0000a736,$0000a7ce,$0000a866,$0000a8fd
06000B80 0000 A994 0000    +  		dc.l $0000a994,$0000aa2a,$0000aac0,$0000ab56
06000B90 0000 ABEB 0000    +  		dc.l $0000abeb,$0000ac80,$0000ad14,$0000ada8
06000BA0 0000 AE3B 0000    +  		dc.l $0000ae3b,$0000aece,$0000af61,$0000aff3
06000BB0 0000 B085 0000    +  		dc.l $0000b085,$0000b117,$0000b1a8,$0000b238
06000BC0 0000 B2C8 0000    +  		dc.l $0000b2c8,$0000b358,$0000b3e7,$0000b476
06000BD0 0000 B504 0000    +  		dc.l $0000b504,$0000b592,$0000b620,$0000b6ad
06000BE0 0000 B73A 0000    +  		dc.l $0000b73a,$0000b7c6,$0000b852,$0000b8dd
06000BF0 0000 B968 0000    +  		dc.l $0000b968,$0000b9f2,$0000ba7c,$0000bb06
06000C00 0000 BB8F 0000    +  		dc.l $0000bb8f,$0000bc17,$0000bca0,$0000bd27
06000C10 0000 BDAE 0000    +  		dc.l $0000bdae,$0000be35,$0000bebc,$0000bf41
06000C20 0000 BFC7 0000    +  		dc.l $0000bfc7,$0000c04c,$0000c0d0,$0000c154
06000C30 0000 C1D8 0000    +  		dc.l $0000c1d8,$0000c25b,$0000c2de,$0000c360
06000C40 0000 C3E2 0000    +  		dc.l $0000c3e2,$0000c463,$0000c4e3,$0000c564
06000C50 0000 C5E4 0000    +  		dc.l $0000c5e4,$0000c663,$0000c6e2,$0000c760
06000C60 0000 C7DE 0000    +  		dc.l $0000c7de,$0000c85b,$0000c8d8,$0000c955
06000C70 0000 C9D1 0000    +  		dc.l $0000c9d1,$0000ca4c,$0000cac7,$0000cb41
06000C80 0000 CBBB 0000    +  		dc.l $0000cbbb,$0000cc35,$0000ccae,$0000cd26
06000C90 0000 CD9F 0000    +  		dc.l $0000cd9f,$0000ce16,$0000ce8d,$0000cf04
06000CA0 0000 CF7A 0000    +  		dc.l $0000cf7a,$0000cfef,$0000d064,$0000d0d9
06000CB0 0000 D14D 0000    +  		dc.l $0000d14d,$0000d1c0,$0000d233,$0000d2a6
06000CC0 0000 D318 0000    +  		dc.l $0000d318,$0000d389,$0000d3fa,$0000d46b
06000CD0 0000 D4DB 0000    +  		dc.l $0000d4db,$0000d54a,$0000d5b9,$0000d627
06000CE0 0000 D695 0000    +  		dc.l $0000d695,$0000d703,$0000d770,$0000d7dc
06000CF0 0000 D848 0000    +  		dc.l $0000d848,$0000d8b3,$0000d91e,$0000d988
06000D00 0000 D9F2 0000    +  		dc.l $0000d9f2,$0000da5b,$0000dac4,$0000db2c
06000D10 0000 DB94 0000    +  		dc.l $0000db94,$0000dbfb,$0000dc61,$0000dcc7
06000D20 0000 DD2D 0000    +  		dc.l $0000dd2d,$0000dd92,$0000ddf6,$0000de5a
06000D30 0000 DEBE 0000    +  		dc.l $0000debe,$0000df20,$0000df83,$0000dfe4
06000D40 0000 E046 0000    +  		dc.l $0000e046,$0000e0a6,$0000e106,$0000e166
06000D50 0000 E1C5 0000    +  		dc.l $0000e1c5,$0000e224,$0000e282,$0000e2df
06000D60 0000 E33C 0000    +  		dc.l $0000e33c,$0000e398,$0000e3f4,$0000e44f
06000D70 0000 E4AA 0000    +  		dc.l $0000e4aa,$0000e504,$0000e55e,$0000e5b7
06000D80 0000 E60F 0000    +  		dc.l $0000e60f,$0000e667,$0000e6be,$0000e715
06000D90 0000 E76B 0000    +  		dc.l $0000e76b,$0000e7c1,$0000e816,$0000e86b
06000DA0 0000 E8BF 0000    +  		dc.l $0000e8bf,$0000e912,$0000e965,$0000e9b7
06000DB0 0000 EA09 0000    +  		dc.l $0000ea09,$0000ea5a,$0000eaab,$0000eafb
06000DC0 0000 EB4B 0000    +  		dc.l $0000eb4b,$0000eb99,$0000ebe8,$0000ec36
06000DD0 0000 EC83 0000    +  		dc.l $0000ec83,$0000ecd0,$0000ed1c,$0000ed67
06000DE0 0000 EDB2 0000    +  		dc.l $0000edb2,$0000edfc,$0000ee46,$0000ee8f
06000DF0 0000 EED8 0000    +  		dc.l $0000eed8,$0000ef20,$0000ef68,$0000efaf
06000E00 0000 EFF5 0000    +  		dc.l $0000eff5,$0000f03b,$0000f080,$0000f0c5
06000E10 0000 F109 0000    +  		dc.l $0000f109,$0000f14c,$0000f18f,$0000f1d1
06000E20 0000 F213 0000    +  		dc.l $0000f213,$0000f254,$0000f294,$0000f2d4
06000E30 0000 F314 0000    +  		dc.l $0000f314,$0000f353,$0000f391,$0000f3ce
06000E40 0000 F40B 0000    +  		dc.l $0000f40b,$0000f448,$0000f484,$0000f4bf
06000E50 0000 F4FA 0000    +  		dc.l $0000f4fa,$0000f534,$0000f56d,$0000f5a6
06000E60 0000 F5DE 0000    +  		dc.l $0000f5de,$0000f616,$0000f64d,$0000f684
06000E70 0000 F6BA 0000    +  		dc.l $0000f6ba,$0000f6ef,$0000f724,$0000f758
06000E80 0000 F78B 0000    +  		dc.l $0000f78b,$0000f7be,$0000f7f1,$0000f822
06000E90 0000 F853 0000    +  		dc.l $0000f853,$0000f884,$0000f8b4,$0000f8e3
06000EA0 0000 F912 0000    +  		dc.l $0000f912,$0000f940,$0000f96e,$0000f99b
06000EB0 0000 F9C7 0000    +  		dc.l $0000f9c7,$0000f9f3,$0000fa1e,$0000fa49
06000EC0 0000 FA73 0000    +  		dc.l $0000fa73,$0000fa9c,$0000fac5,$0000faed
06000ED0 0000 FB14 0000    +  		dc.l $0000fb14,$0000fb3b,$0000fb61,$0000fb87
06000EE0 0000 FBAC 0000    +  		dc.l $0000fbac,$0000fbd1,$0000fbf5,$0000fc18
06000EF0 0000 FC3B 0000    +  		dc.l $0000fc3b,$0000fc5d,$0000fc7e,$0000fc9f
06000F00 0000 FCBF 0000    +  		dc.l $0000fcbf,$0000fcdf,$0000fcfe,$0000fd1c
06000F10 0000 FD3A 0000    +  		dc.l $0000fd3a,$0000fd57,$0000fd74,$0000fd90
06000F20 0000 FDAB 0000    +  		dc.l $0000fdab,$0000fdc6,$0000fde0,$0000fdfa
06000F30 0000 FE13 0000    +  		dc.l $0000fe13,$0000fe2b,$0000fe43,$0000fe5a
06000F40 0000 FE70 0000    +  		dc.l $0000fe70,$0000fe86,$0000fe9b,$0000feb0
06000F50 0000 FEC4 0000    +  		dc.l $0000fec4,$0000fed7,$0000feea,$0000fefc
06000F60 0000 FF0E 0000    +  		dc.l $0000ff0e,$0000ff1f,$0000ff2f,$0000ff3f
06000F70 0000 FF4E 0000    +  		dc.l $0000ff4e,$0000ff5c,$0000ff6a,$0000ff78
06000F80 0000 FF84 0000    +  		dc.l $0000ff84,$0000ff90,$0000ff9c,$0000ffa6
06000F90 0000 FFB1 0000    +  		dc.l $0000ffb1,$0000ffba,$0000ffc3,$0000ffcb
06000FA0 0000 FFD3 0000    +  		dc.l $0000ffd3,$0000ffda,$0000ffe1,$0000ffe7
06000FB0 0000 FFEC 0000    +  		dc.l $0000ffec,$0000fff0,$0000fff4,$0000fff8
06000FC0 0000 FFFB 0000    +  		dc.l $0000fffb,$0000fffd,$0000fffe,$0000ffff
06000FD0                      		
06000FD0 0001 0000 0000    +  cos_table	dc.l $00010000,$0000ffff,$0000fffe,$0000fffd
06000FE0 0000 FFFB 0000    +  		dc.l $0000fffb,$0000fff8,$0000fff4,$0000fff0
06000FF0 0000 FFEC 0000    +  		dc.l $0000ffec,$0000ffe7,$0000ffe1,$0000ffda
06001000 0000 FFD3 0000    +  		dc.l $0000ffd3,$0000ffcb,$0000ffc3,$0000ffba
06001010 0000 FFB1 0000    +  		dc.l $0000ffb1,$0000ffa6,$0000ff9c,$0000ff90
06001020 0000 FF84 0000    +  		dc.l $0000ff84,$0000ff78,$0000ff6a,$0000ff5c
06001030 0000 FF4E 0000    +  		dc.l $0000ff4e,$0000ff3f,$0000ff2f,$0000ff1f
06001040 0000 FF0E 0000    +  		dc.l $0000ff0e,$0000fefc,$0000feea,$0000fed7
06001050 0000 FEC4 0000    +  		dc.l $0000fec4,$0000feb0,$0000fe9b,$0000fe86
06001060 0000 FE70 0000    +  		dc.l $0000fe70,$0000fe5a,$0000fe43,$0000fe2b
06001070 0000 FE13 0000    +  		dc.l $0000fe13,$0000fdfa,$0000fde0,$0000fdc6
06001080 0000 FDAB 0000    +  		dc.l $0000fdab,$0000fd90,$0000fd74,$0000fd57
06001090 0000 FD3A 0000    +  		dc.l $0000fd3a,$0000fd1c,$0000fcfe,$0000fcdf
060010A0 0000 FCBF 0000    +  		dc.l $0000fcbf,$0000fc9f,$0000fc7e,$0000fc5d
060010B0 0000 FC3B 0000    +  		dc.l $0000fc3b,$0000fc18,$0000fbf5,$0000fbd1
060010C0 0000 FBAC 0000    +  		dc.l $0000fbac,$0000fb87,$0000fb61,$0000fb3b
060010D0 0000 FB14 0000    +  		dc.l $0000fb14,$0000faed,$0000fac5,$0000fa9c
060010E0 0000 FA73 0000    +  		dc.l $0000fa73,$0000fa49,$0000fa1e,$0000f9f3
060010F0 0000 F9C7 0000    +  		dc.l $0000f9c7,$0000f99b,$0000f96e,$0000f940
06001100 0000 F912 0000    +  		dc.l $0000f912,$0000f8e3,$0000f8b4,$0000f884
06001110 0000 F853 0000    +  		dc.l $0000f853,$0000f822,$0000f7f1,$0000f7be
06001120 0000 F78B 0000    +  		dc.l $0000f78b,$0000f758,$0000f724,$0000f6ef
06001130 0000 F6BA 0000    +  		dc.l $0000f6ba,$0000f684,$0000f64d,$0000f616
06001140 0000 F5DE 0000    +  		dc.l $0000f5de,$0000f5a6,$0000f56d,$0000f534
06001150 0000 F4FA 0000    +  		dc.l $0000f4fa,$0000f4bf,$0000f484,$0000f448
06001160 0000 F40B 0000    +  		dc.l $0000f40b,$0000f3ce,$0000f391,$0000f353
06001170 0000 F314 0000    +  		dc.l $0000f314,$0000f2d4,$0000f294,$0000f254
06001180 0000 F213 0000    +  		dc.l $0000f213,$0000f1d1,$0000f18f,$0000f14c
06001190 0000 F109 0000    +  		dc.l $0000f109,$0000f0c5,$0000f080,$0000f03b
060011A0 0000 EFF5 0000    +  		dc.l $0000eff5,$0000efaf,$0000ef68,$0000ef20
060011B0 0000 EED8 0000    +  		dc.l $0000eed8,$0000ee8f,$0000ee46,$0000edfc
060011C0 0000 EDB2 0000    +  		dc.l $0000edb2,$0000ed67,$0000ed1c,$0000ecd0
060011D0 0000 EC83 0000    +  		dc.l $0000ec83,$0000ec36,$0000ebe8,$0000eb99
060011E0 0000 EB4B 0000    +  		dc.l $0000eb4b,$0000eafb,$0000eaab,$0000ea5a
060011F0 0000 EA09 0000    +  		dc.l $0000ea09,$0000e9b7,$0000e965,$0000e912
06001200 0000 E8BF 0000    +  		dc.l $0000e8bf,$0000e86b,$0000e816,$0000e7c1
06001210 0000 E76B 0000    +  		dc.l $0000e76b,$0000e715,$0000e6be,$0000e667
06001220 0000 E60F 0000    +  		dc.l $0000e60f,$0000e5b7,$0000e55e,$0000e504
06001230 0000 E4AA 0000    +  		dc.l $0000e4aa,$0000e44f,$0000e3f4,$0000e398
06001240 0000 E33C 0000    +  		dc.l $0000e33c,$0000e2df,$0000e282,$0000e224
06001250 0000 E1C5 0000    +  		dc.l $0000e1c5,$0000e166,$0000e106,$0000e0a6
06001260 0000 E046 0000    +  		dc.l $0000e046,$0000dfe4,$0000df83,$0000df20
06001270 0000 DEBE 0000    +  		dc.l $0000debe,$0000de5a,$0000ddf6,$0000dd92
06001280 0000 DD2D 0000    +  		dc.l $0000dd2d,$0000dcc7,$0000dc61,$0000dbfb
06001290 0000 DB94 0000    +  		dc.l $0000db94,$0000db2c,$0000dac4,$0000da5b
060012A0 0000 D9F2 0000    +  		dc.l $0000d9f2,$0000d988,$0000d91e,$0000d8b3
060012B0 0000 D848 0000    +  		dc.l $0000d848,$0000d7dc,$0000d770,$0000d703
060012C0 0000 D695 0000    +  		dc.l $0000d695,$0000d627,$0000d5b9,$0000d54a
060012D0 0000 D4DB 0000    +  		dc.l $0000d4db,$0000d46b,$0000d3fa,$0000d389
060012E0 0000 D318 0000    +  		dc.l $0000d318,$0000d2a6,$0000d233,$0000d1c0
060012F0 0000 D14D 0000    +  		dc.l $0000d14d,$0000d0d9,$0000d064,$0000cfef
06001300 0000 CF7A 0000    +  		dc.l $0000cf7a,$0000cf04,$0000ce8d,$0000ce16
06001310 0000 CD9F 0000    +  		dc.l $0000cd9f,$0000cd26,$0000ccae,$0000cc35
06001320 0000 CBBB 0000    +  		dc.l $0000cbbb,$0000cb41,$0000cac7,$0000ca4c
06001330 0000 C9D1 0000    +  		dc.l $0000c9d1,$0000c955,$0000c8d8,$0000c85b
06001340 0000 C7DE 0000    +  		dc.l $0000c7de,$0000c760,$0000c6e2,$0000c663
06001350 0000 C5E4 0000    +  		dc.l $0000c5e4,$0000c564,$0000c4e3,$0000c463
06001360 0000 C3E2 0000    +  		dc.l $0000c3e2,$0000c360,$0000c2de,$0000c25b
06001370 0000 C1D8 0000    +  		dc.l $0000c1d8,$0000c154,$0000c0d0,$0000c04c
06001380 0000 BFC7 0000    +  		dc.l $0000bfc7,$0000bf41,$0000bebc,$0000be35
06001390 0000 BDAE 0000    +  		dc.l $0000bdae,$0000bd27,$0000bca0,$0000bc17
060013A0 0000 BB8F 0000    +  		dc.l $0000bb8f,$0000bb06,$0000ba7c,$0000b9f2
060013B0 0000 B968 0000    +  		dc.l $0000b968,$0000b8dd,$0000b852,$0000b7c6
060013C0 0000 B73A 0000    +  		dc.l $0000b73a,$0000b6ad,$0000b620,$0000b592
060013D0 0000 B504 0000    +  		dc.l $0000b504,$0000b476,$0000b3e7,$0000b358
060013E0 0000 B2C8 0000    +  		dc.l $0000b2c8,$0000b238,$0000b1a8,$0000b117
060013F0 0000 B085 0000    +  		dc.l $0000b085,$0000aff3,$0000af61,$0000aece
06001400 0000 AE3B 0000    +  		dc.l $0000ae3b,$0000ada8,$0000ad14,$0000ac80
06001410 0000 ABEB 0000    +  		dc.l $0000abeb,$0000ab56,$0000aac0,$0000aa2a
06001420 0000 A994 0000    +  		dc.l $0000a994,$0000a8fd,$0000a866,$0000a7ce
06001430 0000 A736 0000    +  		dc.l $0000a736,$0000a69d,$0000a605,$0000a56b
06001440 0000 A4D2 0000    +  		dc.l $0000a4d2,$0000a438,$0000a39d,$0000a302
06001450 0000 A267 0000    +  		dc.l $0000a267,$0000a1cb,$0000a12f,$0000a093
06001460 0000 9FF6 0000    +  		dc.l $00009ff6,$00009f59,$00009ebc,$00009e1e
06001470 0000 9D7F 0000    +  		dc.l $00009d7f,$00009ce1,$00009c42,$00009ba2
06001480 0000 9B02 0000    +  		dc.l $00009b02,$00009a62,$000099c2,$00009921
06001490 0000 987F 0000    +  		dc.l $0000987f,$000097de,$0000973c,$00009699
060014A0 0000 95F6 0000    +  		dc.l $000095f6,$00009553,$000094b0,$0000940c
060014B0 0000 9368 0000    +  		dc.l $00009368,$000092c3,$0000921e,$00009179
060014C0 0000 90D3 0000    +  		dc.l $000090d3,$0000902d,$00008f87,$00008ee0
060014D0 0000 8E39 0000    +  		dc.l $00008e39,$00008d92,$00008cea,$00008c42
060014E0 0000 8B9A 0000    +  		dc.l $00008b9a,$00008af1,$00008a48,$0000899f
060014F0 0000 88F5 0000    +  		dc.l $000088f5,$0000884b,$000087a1,$000086f6
06001500 0000 864B 0000    +  		dc.l $0000864b,$000085a0,$000084f4,$00008448
06001510 0000 839C 0000    +  		dc.l $0000839c,$000082ef,$00008242,$00008195
06001520 0000 80E7 0000    +  		dc.l $000080e7,$0000803a,$00007f8b,$00007edd
06001530 0000 7E2E 0000    +  		dc.l $00007e2e,$00007d7f,$00007cd0,$00007c20
06001540 0000 7B70 0000    +  		dc.l $00007b70,$00007ac0,$00007a0f,$0000795e
06001550 0000 78AD 0000    +  		dc.l $000078ad,$000077fb,$0000774a,$00007698
06001560 0000 75E5 0000    +  		dc.l $000075e5,$00007533,$00007480,$000073cd
06001570 0000 7319 0000    +  		dc.l $00007319,$00007265,$000071b1,$000070fd
06001580 0000 7049 0000    +  		dc.l $00007049,$00006f94,$00006edf,$00006e29
06001590 0000 6D74 0000    +  		dc.l $00006d74,$00006cbe,$00006c08,$00006b51
060015A0 0000 6A9B 0000    +  		dc.l $00006a9b,$000069e4,$0000692d,$00006875
060015B0 0000 67BD 0000    +  		dc.l $000067bd,$00006705,$0000664d,$00006595
060015C0 0000 64DC 0000    +  		dc.l $000064dc,$00006423,$0000636a,$000062b1
060015D0 0000 61F7 0000    +  		dc.l $000061f7,$0000613d,$00006083,$00005fc9
060015E0 0000 5F0E 0000    +  		dc.l $00005f0e,$00005e53,$00005d98,$00005cdd
060015F0 0000 5C22 0000    +  		dc.l $00005c22,$00005b66,$00005aaa,$000059ee
06001600 0000 5931 0000    +  		dc.l $00005931,$00005875,$000057b8,$000056fb
06001610 0000 563E 0000    +  		dc.l $0000563e,$00005581,$000054c3,$00005405
06001620 0000 5347 0000    +  		dc.l $00005347,$00005289,$000051ca,$0000510c
06001630 0000 504D 0000    +  		dc.l $0000504d,$00004f8e,$00004ecf,$00004e0f
06001640 0000 4D50 0000    +  		dc.l $00004d50,$00004c90,$00004bd0,$00004b10
06001650 0000 4A50 0000    +  		dc.l $00004a50,$0000498f,$000048ce,$0000480e
06001660 0000 474D 0000    +  		dc.l $0000474d,$0000468b,$000045ca,$00004508
06001670 0000 4447 0000    +  		dc.l $00004447,$00004385,$000042c3,$00004201
06001680 0000 413E 0000    +  		dc.l $0000413e,$0000407c,$00003fb9,$00003ef6
06001690 0000 3E33 0000    +  		dc.l $00003e33,$00003d70,$00003cad,$00003bea
060016A0 0000 3B26 0000    +  		dc.l $00003b26,$00003a62,$0000399f,$000038db
060016B0 0000 3817 0000    +  		dc.l $00003817,$00003752,$0000368e,$000035c9
060016C0 0000 3505 0000    +  		dc.l $00003505,$00003440,$0000337b,$000032b6
060016D0 0000 31F1 0000    +  		dc.l $000031f1,$0000312c,$00003066,$00002fa1
060016E0 0000 2EDB 0000    +  		dc.l $00002edb,$00002e15,$00002d50,$00002c8a
060016F0 0000 2BC4 0000    +  		dc.l $00002bc4,$00002afe,$00002a37,$00002971
06001700 0000 28AA 0000    +  		dc.l $000028aa,$000027e4,$0000271d,$00002656
06001710 0000 2590 0000    +  		dc.l $00002590,$000024c9,$00002402,$0000233b
06001720 0000 2273 0000    +  		dc.l $00002273,$000021ac,$000020e5,$0000201d
06001730 0000 1F56 0000    +  		dc.l $00001f56,$00001e8e,$00001dc7,$00001cff
06001740 0000 1C37 0000    +  		dc.l $00001c37,$00001b6f,$00001aa7,$000019df
06001750 0000 1917 0000    +  		dc.l $00001917,$0000184f,$00001787,$000016bf
06001760 0000 15F6 0000    +  		dc.l $000015f6,$0000152e,$00001466,$0000139d
06001770 0000 12D5 0000    +  		dc.l $000012d5,$0000120c,$00001144,$0000107b
06001780 0000 0FB2 0000    +  		dc.l $00000fb2,$00000eea,$00000e21,$00000d58
06001790 0000 0C8F 0000    +  		dc.l $00000c8f,$00000bc6,$00000afe,$00000a35
060017A0 0000 096C 0000    +  		dc.l $0000096c,$000008a3,$000007da,$00000711
060017B0 0000 0648 0000    +  		dc.l $00000648,$0000057f,$000004b6,$000003ed
060017C0 0000 0324 0000    +  		dc.l $00000324,$0000025b,$00000192,$000000c9
060017D0 0000 0000 FFFF    +  		dc.l $00000000,$ffffff37,$fffffe6e,$fffffda5
060017E0 FFFF FCDC FFFF    +  		dc.l $fffffcdc,$fffffc13,$fffffb4a,$fffffa81
060017F0 FFFF F9B8 FFFF    +  		dc.l $fffff9b8,$fffff8ef,$fffff826,$fffff75d
06001800 FFFF F694 FFFF    +  		dc.l $fffff694,$fffff5cb,$fffff502,$fffff43a
06001810 FFFF F371 FFFF    +  		dc.l $fffff371,$fffff2a8,$fffff1df,$fffff116
06001820 FFFF F04E FFFF    +  		dc.l $fffff04e,$ffffef85,$ffffeebc,$ffffedf4
06001830 FFFF ED2B FFFF    +  		dc.l $ffffed2b,$ffffec63,$ffffeb9a,$ffffead2
06001840 FFFF EA0A FFFF    +  		dc.l $ffffea0a,$ffffe941,$ffffe879,$ffffe7b1
06001850 FFFF E6E9 FFFF    +  		dc.l $ffffe6e9,$ffffe621,$ffffe559,$ffffe491
06001860 FFFF E3C9 FFFF    +  		dc.l $ffffe3c9,$ffffe301,$ffffe239,$ffffe172
06001870 FFFF E0AA FFFF    +  		dc.l $ffffe0aa,$ffffdfe3,$ffffdf1b,$ffffde54
06001880 FFFF DD8D FFFF    +  		dc.l $ffffdd8d,$ffffdcc5,$ffffdbfe,$ffffdb37
06001890 FFFF DA70 FFFF    +  		dc.l $ffffda70,$ffffd9aa,$ffffd8e3,$ffffd81c
060018A0 FFFF D756 FFFF    +  		dc.l $ffffd756,$ffffd68f,$ffffd5c9,$ffffd502
060018B0 FFFF D43C FFFF    +  		dc.l $ffffd43c,$ffffd376,$ffffd2b0,$ffffd1eb
060018C0 FFFF D125 FFFF    +  		dc.l $ffffd125,$ffffd05f,$ffffcf9a,$ffffced4
060018D0 FFFF CE0F FFFF    +  		dc.l $ffffce0f,$ffffcd4a,$ffffcc85,$ffffcbc0
060018E0 FFFF CAFB FFFF    +  		dc.l $ffffcafb,$ffffca37,$ffffc972,$ffffc8ae
060018F0 FFFF C7E9 FFFF    +  		dc.l $ffffc7e9,$ffffc725,$ffffc661,$ffffc59e
06001900 FFFF C4DA FFFF    +  		dc.l $ffffc4da,$ffffc416,$ffffc353,$ffffc290
06001910 FFFF C1CD FFFF    +  		dc.l $ffffc1cd,$ffffc10a,$ffffc047,$ffffbf84
06001920 FFFF BEC2 FFFF    +  		dc.l $ffffbec2,$ffffbdff,$ffffbd3d,$ffffbc7b
06001930 FFFF BBB9 FFFF    +  		dc.l $ffffbbb9,$ffffbaf8,$ffffba36,$ffffb975
06001940 FFFF B8B3 FFFF    +  		dc.l $ffffb8b3,$ffffb7f2,$ffffb732,$ffffb671
06001950 FFFF B5B0 FFFF    +  		dc.l $ffffb5b0,$ffffb4f0,$ffffb430,$ffffb370
06001960 FFFF B2B0 FFFF    +  		dc.l $ffffb2b0,$ffffb1f1,$ffffb131,$ffffb072
06001970 FFFF AFB3 FFFF    +  		dc.l $ffffafb3,$ffffaef4,$ffffae36,$ffffad77
06001980 FFFF ACB9 FFFF    +  		dc.l $ffffacb9,$ffffabfb,$ffffab3d,$ffffaa7f
06001990 FFFF A9C2 FFFF    +  		dc.l $ffffa9c2,$ffffa905,$ffffa848,$ffffa78b
060019A0 FFFF A6CF FFFF    +  		dc.l $ffffa6cf,$ffffa612,$ffffa556,$ffffa49a
060019B0 FFFF A3DE FFFF    +  		dc.l $ffffa3de,$ffffa323,$ffffa268,$ffffa1ad
060019C0 FFFF A0F2 FFFF    +  		dc.l $ffffa0f2,$ffffa037,$ffff9f7d,$ffff9ec3
060019D0 FFFF 9E09 FFFF    +  		dc.l $ffff9e09,$ffff9d4f,$ffff9c96,$ffff9bdd
060019E0 FFFF 9B24 FFFF    +  		dc.l $ffff9b24,$ffff9a6b,$ffff99b3,$ffff98fb
060019F0 FFFF 9843 FFFF    +  		dc.l $ffff9843,$ffff978b,$ffff96d3,$ffff961c
06001A00 FFFF 9565 FFFF    +  		dc.l $ffff9565,$ffff94af,$ffff93f8,$ffff9342
06001A10 FFFF 928C FFFF    +  		dc.l $ffff928c,$ffff91d7,$ffff9121,$ffff906c
06001A20 FFFF 8FB7 FFFF    +  		dc.l $ffff8fb7,$ffff8f03,$ffff8e4f,$ffff8d9b
06001A30 FFFF 8CE7 FFFF    +  		dc.l $ffff8ce7,$ffff8c33,$ffff8b80,$ffff8acd
06001A40 FFFF 8A1B FFFF    +  		dc.l $ffff8a1b,$ffff8968,$ffff88b6,$ffff8805
06001A50 FFFF 8753 FFFF    +  		dc.l $ffff8753,$ffff86a2,$ffff85f1,$ffff8540
06001A60 FFFF 8490 FFFF    +  		dc.l $ffff8490,$ffff83e0,$ffff8330,$ffff8281
06001A70 FFFF 81D2 FFFF    +  		dc.l $ffff81d2,$ffff8123,$ffff8075,$ffff7fc6
06001A80 FFFF 7F19 FFFF    +  		dc.l $ffff7f19,$ffff7e6b,$ffff7dbe,$ffff7d11
06001A90 FFFF 7C64 FFFF    +  		dc.l $ffff7c64,$ffff7bb8,$ffff7b0c,$ffff7a60
06001AA0 FFFF 79B5 FFFF    +  		dc.l $ffff79b5,$ffff790a,$ffff785f,$ffff77b5
06001AB0 FFFF 770B FFFF    +  		dc.l $ffff770b,$ffff7661,$ffff75b8,$ffff750f
06001AC0 FFFF 7466 FFFF    +  		dc.l $ffff7466,$ffff73be,$ffff7316,$ffff726e
06001AD0 FFFF 71C7 FFFF    +  		dc.l $ffff71c7,$ffff7120,$ffff7079,$ffff6fd3
06001AE0 FFFF 6F2D FFFF    +  		dc.l $ffff6f2d,$ffff6e87,$ffff6de2,$ffff6d3d
06001AF0 FFFF 6C98 FFFF    +  		dc.l $ffff6c98,$ffff6bf4,$ffff6b50,$ffff6aad
06001B00 FFFF 6A0A FFFF    +  		dc.l $ffff6a0a,$ffff6967,$ffff68c4,$ffff6822
06001B10 FFFF 6781 FFFF    +  		dc.l $ffff6781,$ffff66df,$ffff663e,$ffff659e
06001B20 FFFF 64FE FFFF    +  		dc.l $ffff64fe,$ffff645e,$ffff63be,$ffff631f
06001B30 FFFF 6281 FFFF    +  		dc.l $ffff6281,$ffff61e2,$ffff6144,$ffff60a7
06001B40 FFFF 600A FFFF    +  		dc.l $ffff600a,$ffff5f6d,$ffff5ed1,$ffff5e35
06001B50 FFFF 5D99 FFFF    +  		dc.l $ffff5d99,$ffff5cfe,$ffff5c63,$ffff5bc8
06001B60 FFFF 5B2E FFFF    +  		dc.l $ffff5b2e,$ffff5a95,$ffff59fb,$ffff5963
06001B70 FFFF 58CA FFFF    +  		dc.l $ffff58ca,$ffff5832,$ffff579a,$ffff5703
06001B80 FFFF 566C FFFF    +  		dc.l $ffff566c,$ffff55d6,$ffff5540,$ffff54aa
06001B90 FFFF 5415 FFFF    +  		dc.l $ffff5415,$ffff5380,$ffff52ec,$ffff5258
06001BA0 FFFF 51C5 FFFF    +  		dc.l $ffff51c5,$ffff5132,$ffff509f,$ffff500d
06001BB0 FFFF 4F7B FFFF    +  		dc.l $ffff4f7b,$ffff4ee9,$ffff4e58,$ffff4dc8
06001BC0 FFFF 4D38 FFFF    +  		dc.l $ffff4d38,$ffff4ca8,$ffff4c19,$ffff4b8a
06001BD0 FFFF 4AFC FFFF    +  		dc.l $ffff4afc,$ffff4a6e,$ffff49e0,$ffff4953
06001BE0 FFFF 48C6 FFFF    +  		dc.l $ffff48c6,$ffff483a,$ffff47ae,$ffff4723
06001BF0 FFFF 4698 FFFF    +  		dc.l $ffff4698,$ffff460e,$ffff4584,$ffff44fa
06001C00 FFFF 4471 FFFF    +  		dc.l $ffff4471,$ffff43e9,$ffff4360,$ffff42d9
06001C10 FFFF 4252 FFFF    +  		dc.l $ffff4252,$ffff41cb,$ffff4144,$ffff40bf
06001C20 FFFF 4039 FFFF    +  		dc.l $ffff4039,$ffff3fb4,$ffff3f30,$ffff3eac
06001C30 FFFF 3E28 FFFF    +  		dc.l $ffff3e28,$ffff3da5,$ffff3d22,$ffff3ca0
06001C40 FFFF 3C1E FFFF    +  		dc.l $ffff3c1e,$ffff3b9d,$ffff3b1d,$ffff3a9c
06001C50 FFFF 3A1C FFFF    +  		dc.l $ffff3a1c,$ffff399d,$ffff391e,$ffff38a0
06001C60 FFFF 3822 FFFF    +  		dc.l $ffff3822,$ffff37a5,$ffff3728,$ffff36ab
06001C70 FFFF 362F FFFF    +  		dc.l $ffff362f,$ffff35b4,$ffff3539,$ffff34bf
06001C80 FFFF 3445 FFFF    +  		dc.l $ffff3445,$ffff33cb,$ffff3352,$ffff32da
06001C90 FFFF 3261 FFFF    +  		dc.l $ffff3261,$ffff31ea,$ffff3173,$ffff30fc
06001CA0 FFFF 3086 FFFF    +  		dc.l $ffff3086,$ffff3011,$ffff2f9c,$ffff2f27
06001CB0 FFFF 2EB3 FFFF    +  		dc.l $ffff2eb3,$ffff2e40,$ffff2dcd,$ffff2d5a
06001CC0 FFFF 2CE8 FFFF    +  		dc.l $ffff2ce8,$ffff2c77,$ffff2c06,$ffff2b95
06001CD0 FFFF 2B25 FFFF    +  		dc.l $ffff2b25,$ffff2ab6,$ffff2a47,$ffff29d9
06001CE0 FFFF 296B FFFF    +  		dc.l $ffff296b,$ffff28fd,$ffff2890,$ffff2824
06001CF0 FFFF 27B8 FFFF    +  		dc.l $ffff27b8,$ffff274d,$ffff26e2,$ffff2678
06001D00 FFFF 260E FFFF    +  		dc.l $ffff260e,$ffff25a5,$ffff253c,$ffff24d4
06001D10 FFFF 246C FFFF    +  		dc.l $ffff246c,$ffff2405,$ffff239f,$ffff2339
06001D20 FFFF 22D3 FFFF    +  		dc.l $ffff22d3,$ffff226e,$ffff220a,$ffff21a6
06001D30 FFFF 2142 FFFF    +  		dc.l $ffff2142,$ffff20e0,$ffff207d,$ffff201c
06001D40 FFFF 1FBA FFFF    +  		dc.l $ffff1fba,$ffff1f5a,$ffff1efa,$ffff1e9a
06001D50 FFFF 1E3B FFFF    +  		dc.l $ffff1e3b,$ffff1ddc,$ffff1d7e,$ffff1d21
06001D60 FFFF 1CC4 FFFF    +  		dc.l $ffff1cc4,$ffff1c68,$ffff1c0c,$ffff1bb1
06001D70 FFFF 1B56 FFFF    +  		dc.l $ffff1b56,$ffff1afc,$ffff1aa2,$ffff1a49
06001D80 FFFF 19F1 FFFF    +  		dc.l $ffff19f1,$ffff1999,$ffff1942,$ffff18eb
06001D90 FFFF 1895 FFFF    +  		dc.l $ffff1895,$ffff183f,$ffff17ea,$ffff1795
06001DA0 FFFF 1741 FFFF    +  		dc.l $ffff1741,$ffff16ee,$ffff169b,$ffff1649
06001DB0 FFFF 15F7 FFFF    +  		dc.l $ffff15f7,$ffff15a6,$ffff1555,$ffff1505
06001DC0 FFFF 14B5 FFFF    +  		dc.l $ffff14b5,$ffff1467,$ffff1418,$ffff13ca
06001DD0 FFFF 137D FFFF    +  		dc.l $ffff137d,$ffff1330,$ffff12e4,$ffff1299
06001DE0 FFFF 124E FFFF    +  		dc.l $ffff124e,$ffff1204,$ffff11ba,$ffff1171
06001DF0 FFFF 1128 FFFF    +  		dc.l $ffff1128,$ffff10e0,$ffff1098,$ffff1051
06001E00 FFFF 100B FFFF    +  		dc.l $ffff100b,$ffff0fc5,$ffff0f80,$ffff0f3b
06001E10 FFFF 0EF7 FFFF    +  		dc.l $ffff0ef7,$ffff0eb4,$ffff0e71,$ffff0e2f
06001E20 FFFF 0DED FFFF    +  		dc.l $ffff0ded,$ffff0dac,$ffff0d6c,$ffff0d2c
06001E30 FFFF 0CEC FFFF    +  		dc.l $ffff0cec,$ffff0cad,$ffff0c6f,$ffff0c32
06001E40 FFFF 0BF5 FFFF    +  		dc.l $ffff0bf5,$ffff0bb8,$ffff0b7c,$ffff0b41
06001E50 FFFF 0B06 FFFF    +  		dc.l $ffff0b06,$ffff0acc,$ffff0a93,$ffff0a5a
06001E60 FFFF 0A22 FFFF    +  		dc.l $ffff0a22,$ffff09ea,$ffff09b3,$ffff097c
06001E70 FFFF 0946 FFFF    +  		dc.l $ffff0946,$ffff0911,$ffff08dc,$ffff08a8
06001E80 FFFF 0875 FFFF    +  		dc.l $ffff0875,$ffff0842,$ffff080f,$ffff07de
06001E90 FFFF 07AD FFFF    +  		dc.l $ffff07ad,$ffff077c,$ffff074c,$ffff071d
06001EA0 FFFF 06EE FFFF    +  		dc.l $ffff06ee,$ffff06c0,$ffff0692,$ffff0665
06001EB0 FFFF 0639 FFFF    +  		dc.l $ffff0639,$ffff060d,$ffff05e2,$ffff05b7
06001EC0 FFFF 058D FFFF    +  		dc.l $ffff058d,$ffff0564,$ffff053b,$ffff0513
06001ED0 FFFF 04EC FFFF    +  		dc.l $ffff04ec,$ffff04c5,$ffff049f,$ffff0479
06001EE0 FFFF 0454 FFFF    +  		dc.l $ffff0454,$ffff042f,$ffff040b,$ffff03e8
06001EF0 FFFF 03C5 FFFF    +  		dc.l $ffff03c5,$ffff03a3,$ffff0382,$ffff0361
06001F00 FFFF 0341 FFFF    +  		dc.l $ffff0341,$ffff0321,$ffff0302,$ffff02e4
06001F10 FFFF 02C6 FFFF    +  		dc.l $ffff02c6,$ffff02a9,$ffff028c,$ffff0270
06001F20 FFFF 0255 FFFF    +  		dc.l $ffff0255,$ffff023a,$ffff0220,$ffff0206
06001F30 FFFF 01ED FFFF    +  		dc.l $ffff01ed,$ffff01d5,$ffff01bd,$ffff01a6
06001F40 FFFF 0190 FFFF    +  		dc.l $ffff0190,$ffff017a,$ffff0165,$ffff0150
06001F50 FFFF 013C FFFF    +  		dc.l $ffff013c,$ffff0129,$ffff0116,$ffff0104
06001F60 FFFF 00F2 FFFF    +  		dc.l $ffff00f2,$ffff00e1,$ffff00d1,$ffff00c1
06001F70 FFFF 00B2 FFFF    +  		dc.l $ffff00b2,$ffff00a4,$ffff0096,$ffff0088
06001F80 FFFF 007C FFFF    +  		dc.l $ffff007c,$ffff0070,$ffff0064,$ffff005a
06001F90 FFFF 004F FFFF    +  		dc.l $ffff004f,$ffff0046,$ffff003d,$ffff0035
06001FA0 FFFF 002D FFFF    +  		dc.l $ffff002d,$ffff0026,$ffff001f,$ffff0019
06001FB0 FFFF 0014 FFFF    +  		dc.l $ffff0014,$ffff0010,$ffff000c,$ffff0008
06001FC0 FFFF 0005 FFFF    +  		dc.l $ffff0005,$ffff0003,$ffff0002,$ffff0001
06001FD0 FFFF 0000 FFFF    +  		dc.l $ffff0000,$ffff0001,$ffff0002,$ffff0003
06001FE0 FFFF 0005 FFFF    +  		dc.l $ffff0005,$ffff0008,$ffff000c,$ffff0010
06001FF0 FFFF 0014 FFFF    +  		dc.l $ffff0014,$ffff0019,$ffff001f,$ffff0026
06002000 FFFF 002D FFFF    +  		dc.l $ffff002d,$ffff0035,$ffff003d,$ffff0046
06002010 FFFF 004F FFFF    +  		dc.l $ffff004f,$ffff005a,$ffff0064,$ffff0070
06002020 FFFF 007C FFFF    +  		dc.l $ffff007c,$ffff0088,$ffff0096,$ffff00a4
06002030 FFFF 00B2 FFFF    +  		dc.l $ffff00b2,$ffff00c1,$ffff00d1,$ffff00e1
06002040 FFFF 00F2 FFFF    +  		dc.l $ffff00f2,$ffff0104,$ffff0116,$ffff0129
06002050 FFFF 013C FFFF    +  		dc.l $ffff013c,$ffff0150,$ffff0165,$ffff017a
06002060 FFFF 0190 FFFF    +  		dc.l $ffff0190,$ffff01a6,$ffff01bd,$ffff01d5
06002070 FFFF 01ED FFFF    +  		dc.l $ffff01ed,$ffff0206,$ffff0220,$ffff023a
06002080 FFFF 0255 FFFF    +  		dc.l $ffff0255,$ffff0270,$ffff028c,$ffff02a9
06002090 FFFF 02C6 FFFF    +  		dc.l $ffff02c6,$ffff02e4,$ffff0302,$ffff0321
060020A0 FFFF 0341 FFFF    +  		dc.l $ffff0341,$ffff0361,$ffff0382,$ffff03a3
060020B0 FFFF 03C5 FFFF    +  		dc.l $ffff03c5,$ffff03e8,$ffff040b,$ffff042f
060020C0 FFFF 0454 FFFF    +  		dc.l $ffff0454,$ffff0479,$ffff049f,$ffff04c5
060020D0 FFFF 04EC FFFF    +  		dc.l $ffff04ec,$ffff0513,$ffff053b,$ffff0564
060020E0 FFFF 058D FFFF    +  		dc.l $ffff058d,$ffff05b7,$ffff05e2,$ffff060d
060020F0 FFFF 0639 FFFF    +  		dc.l $ffff0639,$ffff0665,$ffff0692,$ffff06c0
06002100 FFFF 06EE FFFF    +  		dc.l $ffff06ee,$ffff071d,$ffff074c,$ffff077c
06002110 FFFF 07AD FFFF    +  		dc.l $ffff07ad,$ffff07de,$ffff080f,$ffff0842
06002120 FFFF 0875 FFFF    +  		dc.l $ffff0875,$ffff08a8,$ffff08dc,$ffff0911
06002130 FFFF 0946 FFFF    +  		dc.l $ffff0946,$ffff097c,$ffff09b3,$ffff09ea
06002140 FFFF 0A22 FFFF    +  		dc.l $ffff0a22,$ffff0a5a,$ffff0a93,$ffff0acc
06002150 FFFF 0B06 FFFF    +  		dc.l $ffff0b06,$ffff0b41,$ffff0b7c,$ffff0bb8
06002160 FFFF 0BF5 FFFF    +  		dc.l $ffff0bf5,$ffff0c32,$ffff0c6f,$ffff0cad
06002170 FFFF 0CEC FFFF    +  		dc.l $ffff0cec,$ffff0d2c,$ffff0d6c,$ffff0dac
06002180 FFFF 0DED FFFF    +  		dc.l $ffff0ded,$ffff0e2f,$ffff0e71,$ffff0eb4
06002190 FFFF 0EF7 FFFF    +  		dc.l $ffff0ef7,$ffff0f3b,$ffff0f80,$ffff0fc5
060021A0 FFFF 100B FFFF    +  		dc.l $ffff100b,$ffff1051,$ffff1098,$ffff10e0
060021B0 FFFF 1128 FFFF    +  		dc.l $ffff1128,$ffff1171,$ffff11ba,$ffff1204
060021C0 FFFF 124E FFFF    +  		dc.l $ffff124e,$ffff1299,$ffff12e4,$ffff1330
060021D0 FFFF 137D FFFF    +  		dc.l $ffff137d,$ffff13ca,$ffff1418,$ffff1467
060021E0 FFFF 14B5 FFFF    +  		dc.l $ffff14b5,$ffff1505,$ffff1555,$ffff15a6
060021F0 FFFF 15F7 FFFF    +  		dc.l $ffff15f7,$ffff1649,$ffff169b,$ffff16ee
06002200 FFFF 1741 FFFF    +  		dc.l $ffff1741,$ffff1795,$ffff17ea,$ffff183f
06002210 FFFF 1895 FFFF    +  		dc.l $ffff1895,$ffff18eb,$ffff1942,$ffff1999
06002220 FFFF 19F1 FFFF    +  		dc.l $ffff19f1,$ffff1a49,$ffff1aa2,$ffff1afc
06002230 FFFF 1B56 FFFF    +  		dc.l $ffff1b56,$ffff1bb1,$ffff1c0c,$ffff1c68
06002240 FFFF 1CC4 FFFF    +  		dc.l $ffff1cc4,$ffff1d21,$ffff1d7e,$ffff1ddc
06002250 FFFF 1E3B FFFF    +  		dc.l $ffff1e3b,$ffff1e9a,$ffff1efa,$ffff1f5a
06002260 FFFF 1FBA FFFF    +  		dc.l $ffff1fba,$ffff201c,$ffff207d,$ffff20e0
06002270 FFFF 2142 FFFF    +  		dc.l $ffff2142,$ffff21a6,$ffff220a,$ffff226e
06002280 FFFF 22D3 FFFF    +  		dc.l $ffff22d3,$ffff2339,$ffff239f,$ffff2405
06002290 FFFF 246C FFFF    +  		dc.l $ffff246c,$ffff24d4,$ffff253c,$ffff25a5
060022A0 FFFF 260E FFFF    +  		dc.l $ffff260e,$ffff2678,$ffff26e2,$ffff274d
060022B0 FFFF 27B8 FFFF    +  		dc.l $ffff27b8,$ffff2824,$ffff2890,$ffff28fd
060022C0 FFFF 296B FFFF    +  		dc.l $ffff296b,$ffff29d9,$ffff2a47,$ffff2ab6
060022D0 FFFF 2B25 FFFF    +  		dc.l $ffff2b25,$ffff2b95,$ffff2c06,$ffff2c77
060022E0 FFFF 2CE8 FFFF    +  		dc.l $ffff2ce8,$ffff2d5a,$ffff2dcd,$ffff2e40
060022F0 FFFF 2EB3 FFFF    +  		dc.l $ffff2eb3,$ffff2f27,$ffff2f9c,$ffff3011
06002300 FFFF 3086 FFFF    +  		dc.l $ffff3086,$ffff30fc,$ffff3173,$ffff31ea
06002310 FFFF 3261 FFFF    +  		dc.l $ffff3261,$ffff32da,$ffff3352,$ffff33cb
06002320 FFFF 3445 FFFF    +  		dc.l $ffff3445,$ffff34bf,$ffff3539,$ffff35b4
06002330 FFFF 362F FFFF    +  		dc.l $ffff362f,$ffff36ab,$ffff3728,$ffff37a5
06002340 FFFF 3822 FFFF    +  		dc.l $ffff3822,$ffff38a0,$ffff391e,$ffff399d
06002350 FFFF 3A1C FFFF    +  		dc.l $ffff3a1c,$ffff3a9c,$ffff3b1d,$ffff3b9d
06002360 FFFF 3C1E FFFF    +  		dc.l $ffff3c1e,$ffff3ca0,$ffff3d22,$ffff3da5
06002370 FFFF 3E28 FFFF    +  		dc.l $ffff3e28,$ffff3eac,$ffff3f30,$ffff3fb4
06002380 FFFF 4039 FFFF    +  		dc.l $ffff4039,$ffff40bf,$ffff4144,$ffff41cb
06002390 FFFF 4252 FFFF    +  		dc.l $ffff4252,$ffff42d9,$ffff4360,$ffff43e9
060023A0 FFFF 4471 FFFF    +  		dc.l $ffff4471,$ffff44fa,$ffff4584,$ffff460e
060023B0 FFFF 4698 FFFF    +  		dc.l $ffff4698,$ffff4723,$ffff47ae,$ffff483a
060023C0 FFFF 48C6 FFFF    +  		dc.l $ffff48c6,$ffff4953,$ffff49e0,$ffff4a6e
060023D0 FFFF 4AFC FFFF    +  		dc.l $ffff4afc,$ffff4b8a,$ffff4c19,$ffff4ca8
060023E0 FFFF 4D38 FFFF    +  		dc.l $ffff4d38,$ffff4dc8,$ffff4e58,$ffff4ee9
060023F0 FFFF 4F7B FFFF    +  		dc.l $ffff4f7b,$ffff500d,$ffff509f,$ffff5132
06002400 FFFF 51C5 FFFF    +  		dc.l $ffff51c5,$ffff5258,$ffff52ec,$ffff5380
06002410 FFFF 5415 FFFF    +  		dc.l $ffff5415,$ffff54aa,$ffff5540,$ffff55d6
06002420 FFFF 566C FFFF    +  		dc.l $ffff566c,$ffff5703,$ffff579a,$ffff5832
06002430 FFFF 58CA FFFF    +  		dc.l $ffff58ca,$ffff5963,$ffff59fb,$ffff5a95
06002440 FFFF 5B2E FFFF    +  		dc.l $ffff5b2e,$ffff5bc8,$ffff5c63,$ffff5cfe
06002450 FFFF 5D99 FFFF    +  		dc.l $ffff5d99,$ffff5e35,$ffff5ed1,$ffff5f6d
06002460 FFFF 600A FFFF    +  		dc.l $ffff600a,$ffff60a7,$ffff6144,$ffff61e2
06002470 FFFF 6281 FFFF    +  		dc.l $ffff6281,$ffff631f,$ffff63be,$ffff645e
06002480 FFFF 64FE FFFF    +  		dc.l $ffff64fe,$ffff659e,$ffff663e,$ffff66df
06002490 FFFF 6781 FFFF    +  		dc.l $ffff6781,$ffff6822,$ffff68c4,$ffff6967
060024A0 FFFF 6A0A FFFF    +  		dc.l $ffff6a0a,$ffff6aad,$ffff6b50,$ffff6bf4
060024B0 FFFF 6C98 FFFF    +  		dc.l $ffff6c98,$ffff6d3d,$ffff6de2,$ffff6e87
060024C0 FFFF 6F2D FFFF    +  		dc.l $ffff6f2d,$ffff6fd3,$ffff7079,$ffff7120
060024D0 FFFF 71C7 FFFF    +  		dc.l $ffff71c7,$ffff726e,$ffff7316,$ffff73be
060024E0 FFFF 7466 FFFF    +  		dc.l $ffff7466,$ffff750f,$ffff75b8,$ffff7661
060024F0 FFFF 770B FFFF    +  		dc.l $ffff770b,$ffff77b5,$ffff785f,$ffff790a
06002500 FFFF 79B5 FFFF    +  		dc.l $ffff79b5,$ffff7a60,$ffff7b0c,$ffff7bb8
06002510 FFFF 7C64 FFFF    +  		dc.l $ffff7c64,$ffff7d11,$ffff7dbe,$ffff7e6b
06002520 FFFF 7F19 FFFF    +  		dc.l $ffff7f19,$ffff7fc6,$ffff8075,$ffff8123
06002530 FFFF 81D2 FFFF    +  		dc.l $ffff81d2,$ffff8281,$ffff8330,$ffff83e0
06002540 FFFF 8490 FFFF    +  		dc.l $ffff8490,$ffff8540,$ffff85f1,$ffff86a2
06002550 FFFF 8753 FFFF    +  		dc.l $ffff8753,$ffff8805,$ffff88b6,$ffff8968
06002560 FFFF 8A1B FFFF    +  		dc.l $ffff8a1b,$ffff8acd,$ffff8b80,$ffff8c33
06002570 FFFF 8CE7 FFFF    +  		dc.l $ffff8ce7,$ffff8d9b,$ffff8e4f,$ffff8f03
06002580 FFFF 8FB7 FFFF    +  		dc.l $ffff8fb7,$ffff906c,$ffff9121,$ffff91d7
06002590 FFFF 928C FFFF    +  		dc.l $ffff928c,$ffff9342,$ffff93f8,$ffff94af
060025A0 FFFF 9565 FFFF    +  		dc.l $ffff9565,$ffff961c,$ffff96d3,$ffff978b
060025B0 FFFF 9843 FFFF    +  		dc.l $ffff9843,$ffff98fb,$ffff99b3,$ffff9a6b
060025C0 FFFF 9B24 FFFF    +  		dc.l $ffff9b24,$ffff9bdd,$ffff9c96,$ffff9d4f
060025D0 FFFF 9E09 FFFF    +  		dc.l $ffff9e09,$ffff9ec3,$ffff9f7d,$ffffa037
060025E0 FFFF A0F2 FFFF    +  		dc.l $ffffa0f2,$ffffa1ad,$ffffa268,$ffffa323
060025F0 FFFF A3DE FFFF    +  		dc.l $ffffa3de,$ffffa49a,$ffffa556,$ffffa612
06002600 FFFF A6CF FFFF    +  		dc.l $ffffa6cf,$ffffa78b,$ffffa848,$ffffa905
06002610 FFFF A9C2 FFFF    +  		dc.l $ffffa9c2,$ffffaa7f,$ffffab3d,$ffffabfb
06002620 FFFF ACB9 FFFF    +  		dc.l $ffffacb9,$ffffad77,$ffffae36,$ffffaef4
06002630 FFFF AFB3 FFFF    +  		dc.l $ffffafb3,$ffffb072,$ffffb131,$ffffb1f1
06002640 FFFF B2B0 FFFF    +  		dc.l $ffffb2b0,$ffffb370,$ffffb430,$ffffb4f0
06002650 FFFF B5B0 FFFF    +  		dc.l $ffffb5b0,$ffffb671,$ffffb732,$ffffb7f2
06002660 FFFF B8B3 FFFF    +  		dc.l $ffffb8b3,$ffffb975,$ffffba36,$ffffbaf8
06002670 FFFF BBB9 FFFF    +  		dc.l $ffffbbb9,$ffffbc7b,$ffffbd3d,$ffffbdff
06002680 FFFF BEC2 FFFF    +  		dc.l $ffffbec2,$ffffbf84,$ffffc047,$ffffc10a
06002690 FFFF C1CD FFFF    +  		dc.l $ffffc1cd,$ffffc290,$ffffc353,$ffffc416
060026A0 FFFF C4DA FFFF    +  		dc.l $ffffc4da,$ffffc59e,$ffffc661,$ffffc725
060026B0 FFFF C7E9 FFFF    +  		dc.l $ffffc7e9,$ffffc8ae,$ffffc972,$ffffca37
060026C0 FFFF CAFB FFFF    +  		dc.l $ffffcafb,$ffffcbc0,$ffffcc85,$ffffcd4a
060026D0 FFFF CE0F FFFF    +  		dc.l $ffffce0f,$ffffced4,$ffffcf9a,$ffffd05f
060026E0 FFFF D125 FFFF    +  		dc.l $ffffd125,$ffffd1eb,$ffffd2b0,$ffffd376
060026F0 FFFF D43C FFFF    +  		dc.l $ffffd43c,$ffffd502,$ffffd5c9,$ffffd68f
06002700 FFFF D756 FFFF    +  		dc.l $ffffd756,$ffffd81c,$ffffd8e3,$ffffd9aa
06002710 FFFF DA70 FFFF    +  		dc.l $ffffda70,$ffffdb37,$ffffdbfe,$ffffdcc5
06002720 FFFF DD8D FFFF    +  		dc.l $ffffdd8d,$ffffde54,$ffffdf1b,$ffffdfe3
06002730 FFFF E0AA FFFF    +  		dc.l $ffffe0aa,$ffffe172,$ffffe239,$ffffe301
06002740 FFFF E3C9 FFFF    +  		dc.l $ffffe3c9,$ffffe491,$ffffe559,$ffffe621
06002750 FFFF E6E9 FFFF    +  		dc.l $ffffe6e9,$ffffe7b1,$ffffe879,$ffffe941
06002760 FFFF EA0A FFFF    +  		dc.l $ffffea0a,$ffffead2,$ffffeb9a,$ffffec63
06002770 FFFF ED2B FFFF    +  		dc.l $ffffed2b,$ffffedf4,$ffffeebc,$ffffef85
06002780 FFFF F04E FFFF    +  		dc.l $fffff04e,$fffff116,$fffff1df,$fffff2a8
06002790 FFFF F371 FFFF    +  		dc.l $fffff371,$fffff43a,$fffff502,$fffff5cb
060027A0 FFFF F694 FFFF    +  		dc.l $fffff694,$fffff75d,$fffff826,$fffff8ef
060027B0 FFFF F9B8 FFFF    +  		dc.l $fffff9b8,$fffffa81,$fffffb4a,$fffffc13
060027C0 FFFF FCDC FFFF    +  		dc.l $fffffcdc,$fffffda5,$fffffe6e,$ffffff37
060027D0                      		
060027D0 0000 0000 0000    +  		dc.l $00000000,$000000c9,$00000192,$0000025b
060027E0 0000 0324 0000    +  		dc.l $00000324,$000003ed,$000004b6,$0000057f
060027F0 0000 0648 0000    +  		dc.l $00000648,$00000711,$000007da,$000008a3
06002800 0000 096C 0000    +  		dc.l $0000096c,$00000a35,$00000afe,$00000bc6
06002810 0000 0C8F 0000    +  		dc.l $00000c8f,$00000d58,$00000e21,$00000eea
06002820 0000 0FB2 0000    +  		dc.l $00000fb2,$0000107b,$00001144,$0000120c
06002830 0000 12D5 0000    +  		dc.l $000012d5,$0000139d,$00001466,$0000152e
06002840 0000 15F6 0000    +  		dc.l $000015f6,$000016bf,$00001787,$0000184f
06002850 0000 1917 0000    +  		dc.l $00001917,$000019df,$00001aa7,$00001b6f
06002860 0000 1C37 0000    +  		dc.l $00001c37,$00001cff,$00001dc7,$00001e8e
06002870 0000 1F56 0000    +  		dc.l $00001f56,$0000201d,$000020e5,$000021ac
06002880 0000 2273 0000    +  		dc.l $00002273,$0000233b,$00002402,$000024c9
06002890 0000 2590 0000    +  		dc.l $00002590,$00002656,$0000271d,$000027e4
060028A0 0000 28AA 0000    +  		dc.l $000028aa,$00002971,$00002a37,$00002afe
060028B0 0000 2BC4 0000    +  		dc.l $00002bc4,$00002c8a,$00002d50,$00002e15
060028C0 0000 2EDB 0000    +  		dc.l $00002edb,$00002fa1,$00003066,$0000312c
060028D0 0000 31F1 0000    +  		dc.l $000031f1,$000032b6,$0000337b,$00003440
060028E0 0000 3505 0000    +  		dc.l $00003505,$000035c9,$0000368e,$00003752
060028F0 0000 3817 0000    +  		dc.l $00003817,$000038db,$0000399f,$00003a62
06002900 0000 3B26 0000    +  		dc.l $00003b26,$00003bea,$00003cad,$00003d70
06002910 0000 3E33 0000    +  		dc.l $00003e33,$00003ef6,$00003fb9,$0000407c
06002920 0000 413E 0000    +  		dc.l $0000413e,$00004201,$000042c3,$00004385
06002930 0000 4447 0000    +  		dc.l $00004447,$00004508,$000045ca,$0000468b
06002940 0000 474D 0000    +  		dc.l $0000474d,$0000480e,$000048ce,$0000498f
06002950 0000 4A50 0000    +  		dc.l $00004a50,$00004b10,$00004bd0,$00004c90
06002960 0000 4D50 0000    +  		dc.l $00004d50,$00004e0f,$00004ecf,$00004f8e
06002970 0000 504D 0000    +  		dc.l $0000504d,$0000510c,$000051ca,$00005289
06002980 0000 5347 0000    +  		dc.l $00005347,$00005405,$000054c3,$00005581
06002990 0000 563E 0000    +  		dc.l $0000563e,$000056fb,$000057b8,$00005875
060029A0 0000 5931 0000    +  		dc.l $00005931,$000059ee,$00005aaa,$00005b66
060029B0 0000 5C22 0000    +  		dc.l $00005c22,$00005cdd,$00005d98,$00005e53
060029C0 0000 5F0E 0000    +  		dc.l $00005f0e,$00005fc9,$00006083,$0000613d
060029D0 0000 61F7 0000    +  		dc.l $000061f7,$000062b1,$0000636a,$00006423
060029E0 0000 64DC 0000    +  		dc.l $000064dc,$00006595,$0000664d,$00006705
060029F0 0000 67BD 0000    +  		dc.l $000067bd,$00006875,$0000692d,$000069e4
06002A00 0000 6A9B 0000    +  		dc.l $00006a9b,$00006b51,$00006c08,$00006cbe
06002A10 0000 6D74 0000    +  		dc.l $00006d74,$00006e29,$00006edf,$00006f94
06002A20 0000 7049 0000    +  		dc.l $00007049,$000070fd,$000071b1,$00007265
06002A30 0000 7319 0000    +  		dc.l $00007319,$000073cd,$00007480,$00007533
06002A40 0000 75E5 0000    +  		dc.l $000075e5,$00007698,$0000774a,$000077fb
06002A50 0000 78AD 0000    +  		dc.l $000078ad,$0000795e,$00007a0f,$00007ac0
06002A60 0000 7B70 0000    +  		dc.l $00007b70,$00007c20,$00007cd0,$00007d7f
06002A70 0000 7E2E 0000    +  		dc.l $00007e2e,$00007edd,$00007f8b,$0000803a
06002A80 0000 80E7 0000    +  		dc.l $000080e7,$00008195,$00008242,$000082ef
06002A90 0000 839C 0000    +  		dc.l $0000839c,$00008448,$000084f4,$000085a0
06002AA0 0000 864B 0000    +  		dc.l $0000864b,$000086f6,$000087a1,$0000884b
06002AB0 0000 88F5 0000    +  		dc.l $000088f5,$0000899f,$00008a48,$00008af1
06002AC0 0000 8B9A 0000    +  		dc.l $00008b9a,$00008c42,$00008cea,$00008d92
06002AD0 0000 8E39 0000    +  		dc.l $00008e39,$00008ee0,$00008f87,$0000902d
06002AE0 0000 90D3 0000    +  		dc.l $000090d3,$00009179,$0000921e,$000092c3
06002AF0 0000 9368 0000    +  		dc.l $00009368,$0000940c,$000094b0,$00009553
06002B00 0000 95F6 0000    +  		dc.l $000095f6,$00009699,$0000973c,$000097de
06002B10 0000 987F 0000    +  		dc.l $0000987f,$00009921,$000099c2,$00009a62
06002B20 0000 9B02 0000    +  		dc.l $00009b02,$00009ba2,$00009c42,$00009ce1
06002B30 0000 9D7F 0000    +  		dc.l $00009d7f,$00009e1e,$00009ebc,$00009f59
06002B40 0000 9FF6 0000    +  		dc.l $00009ff6,$0000a093,$0000a12f,$0000a1cb
06002B50 0000 A267 0000    +  		dc.l $0000a267,$0000a302,$0000a39d,$0000a438
06002B60 0000 A4D2 0000    +  		dc.l $0000a4d2,$0000a56b,$0000a605,$0000a69d
06002B70 0000 A736 0000    +  		dc.l $0000a736,$0000a7ce,$0000a866,$0000a8fd
06002B80 0000 A994 0000    +  		dc.l $0000a994,$0000aa2a,$0000aac0,$0000ab56
06002B90 0000 ABEB 0000    +  		dc.l $0000abeb,$0000ac80,$0000ad14,$0000ada8
06002BA0 0000 AE3B 0000    +  		dc.l $0000ae3b,$0000aece,$0000af61,$0000aff3
06002BB0 0000 B085 0000    +  		dc.l $0000b085,$0000b117,$0000b1a8,$0000b238
06002BC0 0000 B2C8 0000    +  		dc.l $0000b2c8,$0000b358,$0000b3e7,$0000b476
06002BD0 0000 B504 0000    +  		dc.l $0000b504,$0000b592,$0000b620,$0000b6ad
06002BE0 0000 B73A 0000    +  		dc.l $0000b73a,$0000b7c6,$0000b852,$0000b8dd
06002BF0 0000 B968 0000    +  		dc.l $0000b968,$0000b9f2,$0000ba7c,$0000bb06
06002C00 0000 BB8F 0000    +  		dc.l $0000bb8f,$0000bc17,$0000bca0,$0000bd27
06002C10 0000 BDAE 0000    +  		dc.l $0000bdae,$0000be35,$0000bebc,$0000bf41
06002C20 0000 BFC7 0000    +  		dc.l $0000bfc7,$0000c04c,$0000c0d0,$0000c154
06002C30 0000 C1D8 0000    +  		dc.l $0000c1d8,$0000c25b,$0000c2de,$0000c360
06002C40 0000 C3E2 0000    +  		dc.l $0000c3e2,$0000c463,$0000c4e3,$0000c564
06002C50 0000 C5E4 0000    +  		dc.l $0000c5e4,$0000c663,$0000c6e2,$0000c760
06002C60 0000 C7DE 0000    +  		dc.l $0000c7de,$0000c85b,$0000c8d8,$0000c955
06002C70 0000 C9D1 0000    +  		dc.l $0000c9d1,$0000ca4c,$0000cac7,$0000cb41
06002C80 0000 CBBB 0000    +  		dc.l $0000cbbb,$0000cc35,$0000ccae,$0000cd26
06002C90 0000 CD9F 0000    +  		dc.l $0000cd9f,$0000ce16,$0000ce8d,$0000cf04
06002CA0 0000 CF7A 0000    +  		dc.l $0000cf7a,$0000cfef,$0000d064,$0000d0d9
06002CB0 0000 D14D 0000    +  		dc.l $0000d14d,$0000d1c0,$0000d233,$0000d2a6
06002CC0 0000 D318 0000    +  		dc.l $0000d318,$0000d389,$0000d3fa,$0000d46b
06002CD0 0000 D4DB 0000    +  		dc.l $0000d4db,$0000d54a,$0000d5b9,$0000d627
06002CE0 0000 D695 0000    +  		dc.l $0000d695,$0000d703,$0000d770,$0000d7dc
06002CF0 0000 D848 0000    +  		dc.l $0000d848,$0000d8b3,$0000d91e,$0000d988
06002D00 0000 D9F2 0000    +  		dc.l $0000d9f2,$0000da5b,$0000dac4,$0000db2c
06002D10 0000 DB94 0000    +  		dc.l $0000db94,$0000dbfb,$0000dc61,$0000dcc7
06002D20 0000 DD2D 0000    +  		dc.l $0000dd2d,$0000dd92,$0000ddf6,$0000de5a
06002D30 0000 DEBE 0000    +  		dc.l $0000debe,$0000df20,$0000df83,$0000dfe4
06002D40 0000 E046 0000    +  		dc.l $0000e046,$0000e0a6,$0000e106,$0000e166
06002D50 0000 E1C5 0000    +  		dc.l $0000e1c5,$0000e224,$0000e282,$0000e2df
06002D60 0000 E33C 0000    +  		dc.l $0000e33c,$0000e398,$0000e3f4,$0000e44f
06002D70 0000 E4AA 0000    +  		dc.l $0000e4aa,$0000e504,$0000e55e,$0000e5b7
06002D80 0000 E60F 0000    +  		dc.l $0000e60f,$0000e667,$0000e6be,$0000e715
06002D90 0000 E76B 0000    +  		dc.l $0000e76b,$0000e7c1,$0000e816,$0000e86b
06002DA0 0000 E8BF 0000    +  		dc.l $0000e8bf,$0000e912,$0000e965,$0000e9b7
06002DB0 0000 EA09 0000    +  		dc.l $0000ea09,$0000ea5a,$0000eaab,$0000eafb
06002DC0 0000 EB4B 0000    +  		dc.l $0000eb4b,$0000eb99,$0000ebe8,$0000ec36
06002DD0 0000 EC83 0000    +  		dc.l $0000ec83,$0000ecd0,$0000ed1c,$0000ed67
06002DE0 0000 EDB2 0000    +  		dc.l $0000edb2,$0000edfc,$0000ee46,$0000ee8f
06002DF0 0000 EED8 0000    +  		dc.l $0000eed8,$0000ef20,$0000ef68,$0000efaf
06002E00 0000 EFF5 0000    +  		dc.l $0000eff5,$0000f03b,$0000f080,$0000f0c5
06002E10 0000 F109 0000    +  		dc.l $0000f109,$0000f14c,$0000f18f,$0000f1d1
06002E20 0000 F213 0000    +  		dc.l $0000f213,$0000f254,$0000f294,$0000f2d4
06002E30 0000 F314 0000    +  		dc.l $0000f314,$0000f353,$0000f391,$0000f3ce
06002E40 0000 F40B 0000    +  		dc.l $0000f40b,$0000f448,$0000f484,$0000f4bf
06002E50 0000 F4FA 0000    +  		dc.l $0000f4fa,$0000f534,$0000f56d,$0000f5a6
06002E60 0000 F5DE 0000    +  		dc.l $0000f5de,$0000f616,$0000f64d,$0000f684
06002E70 0000 F6BA 0000    +  		dc.l $0000f6ba,$0000f6ef,$0000f724,$0000f758
06002E80 0000 F78B 0000    +  		dc.l $0000f78b,$0000f7be,$0000f7f1,$0000f822
06002E90 0000 F853 0000    +  		dc.l $0000f853,$0000f884,$0000f8b4,$0000f8e3
06002EA0 0000 F912 0000    +  		dc.l $0000f912,$0000f940,$0000f96e,$0000f99b
06002EB0 0000 F9C7 0000    +  		dc.l $0000f9c7,$0000f9f3,$0000fa1e,$0000fa49
06002EC0 0000 FA73 0000    +  		dc.l $0000fa73,$0000fa9c,$0000fac5,$0000faed
06002ED0 0000 FB14 0000    +  		dc.l $0000fb14,$0000fb3b,$0000fb61,$0000fb87
06002EE0 0000 FBAC 0000    +  		dc.l $0000fbac,$0000fbd1,$0000fbf5,$0000fc18
06002EF0 0000 FC3B 0000    +  		dc.l $0000fc3b,$0000fc5d,$0000fc7e,$0000fc9f
06002F00 0000 FCBF 0000    +  		dc.l $0000fcbf,$0000fcdf,$0000fcfe,$0000fd1c
06002F10 0000 FD3A 0000    +  		dc.l $0000fd3a,$0000fd57,$0000fd74,$0000fd90
06002F20 0000 FDAB 0000    +  		dc.l $0000fdab,$0000fdc6,$0000fde0,$0000fdfa
06002F30 0000 FE13 0000    +  		dc.l $0000fe13,$0000fe2b,$0000fe43,$0000fe5a
06002F40 0000 FE70 0000    +  		dc.l $0000fe70,$0000fe86,$0000fe9b,$0000feb0
06002F50 0000 FEC4 0000    +  		dc.l $0000fec4,$0000fed7,$0000feea,$0000fefc
06002F60 0000 FF0E 0000    +  		dc.l $0000ff0e,$0000ff1f,$0000ff2f,$0000ff3f
06002F70 0000 FF4E 0000    +  		dc.l $0000ff4e,$0000ff5c,$0000ff6a,$0000ff78
06002F80 0000 FF84 0000    +  		dc.l $0000ff84,$0000ff90,$0000ff9c,$0000ffa6
06002F90 0000 FFB1 0000    +  		dc.l $0000ffb1,$0000ffba,$0000ffc3,$0000ffcb
06002FA0 0000 FFD3 0000    +  		dc.l $0000ffd3,$0000ffda,$0000ffe1,$0000ffe7
06002FB0 0000 FFEC 0000    +  		dc.l $0000ffec,$0000fff0,$0000fff4,$0000fff8
06002FC0 0000 FFFB 0000    +  		dc.l $0000fffb,$0000fffd,$0000fffe,$0000ffff
06002FD0                      
06002FD0                      ; ----------------------------------------
06002FD0                      ; This table is "off by one" - to get 1/n you must fetch the (n-1)th entry.
06002FD0                      ; ----------------------------------------
06002FD0                      
06002FD0                      		align	4
06002FD0                      div_table
06002FD0                      		incbin "mars/sh2/subs/data/divtable.bin"
060039D0                      		align 4
060039D0                      		
060039D0                      ; =================================================================
060039D0                      ; ----------------------------------------
060039D0                      ; Subs
060039D0                      ; ----------------------------------------
060039D0                      
060039D0                      ; ------------------------------
060039D0                      ; Rotate point around Z axis
060039D0                      ;
060039D0                      ; Entry:
060039D0                      ;
060039D0                      ; r5: x
060039D0                      ; r6: y
060039D0                      ; r0: theta
060039D0                      ;
060039D0                      ; Returns:
060039D0                      ;
060039D0                      ; r0: (x  cos @) + (y sin @)
060039D0                      ; r1: (x -sin @) + (y cos @)
060039D0                      ; ------------------------------
060039D0                      
060039D0                      Rotate_Point:
060039D0 D100                 		mov	#sin_table,r1
060039D2 D200                 		mov	#cos_table,r2
060039D4 031E                 		mov	@(r0,r1),r3
060039D6 042E                 		mov	@(r0,r2),r4
060039D8                      
060039D8 345D                 		dmuls	r5,r4		; x cos @
060039DA 001A                 		mov	macl,r0
060039DC 010A                 		mov	mach,r1
060039DE 201D                 		xtrct	r1,r0
060039E0 336D                 		dmuls	r6,r3		; y sin @
060039E2 011A                 		mov	macl,r1
060039E4 020A                 		mov	mach,r2
060039E6 212D                 		xtrct	r2,r1
060039E8 301C                 		add	r1,r0
060039EA                      
060039EA 633B                 		neg	r3,r3
060039EC 335D                 		dmuls	r5,r3		; x -sin @
060039EE 011A                 		mov	macl,r1
060039F0 020A                 		mov	mach,r2
060039F2 212D                 		xtrct	r2,r1
060039F4 346D                 		dmuls	r6,r4		; y cos @
060039F6 021A                 		mov	macl,r2
060039F8 030A                 		mov	mach,r3
060039FA 223D                 		xtrct	r3,r2
060039FC 312C                 		add	r2,r1
060039FE 000B                  		rts
06003A00 0009                 		nop
06003A04 0000 0000 0000    +  		lits
06003A0C                      		cnop 0,4
06003A0C                      		
06003A0C                      ; ----------------------------------------
06003A0C                      ; Texture map line
06003A0C                      ; 
06003A0C                      ; Input:
06003A0C                      ; r1  - left_dda
06003A0C                      ; r2  - right_dda
06003A0C                      ; r10 - tml_data
06003A0C                      ;
06003A0C                      ; Uses:
06003A0C                      ; r0-r9
06003A0C                      ; ----------------------------------------
06003A0C                      
06003A0C                      		align	4
06003A0C                      Texture_Map_Line:
06003A0C                      
06003A0C                      ; --------------------------
06003A0C                      ; Setup the destinations
06003A0C                      ; --------------------------
06003A0C                      
06003A0C 592A                 		mov	@(dda_dst_x,r2),r9		; Line start/end
06003A0E 581A                 		mov	@(dda_dst_x,r1),r8
06003A10                      		
06003A10 54A2                  		mov	@(tml_texture,r10),r4
06003A12 D300                  		mov	#256,r3
06003A14 3433                  		cmp/ge	r3,r4
06003A16 8900                  		bt	@texture_setup
06003A18                       		
06003A18                      ; --------------------------
06003A18                      ; Solid color
06003A18                      ; --------------------------
06003A18                      
06003A18 6093                  		mov	r9,r0
06003A1A 3088                  		sub 	r8,r0
06003A1C 4011                  		cmp/pz	r0				; Line rotated?
06003A1E 8900                  		bt	@no_texture
06003A20 582A                 		mov	@(dda_dst_x,r2),r8		; Line start/end
06003A22 A000                 		bra	@no_texture
06003A24 591A                 		mov	@(dda_dst_x,r1),r9
06003A26                       
06003A26                      ; --------------------------
06003A26                      ; Has texture
06003A26                      ; --------------------------
06003A26                      
06003A26                      @texture_setup:
06003A26 5423                 		mov	@(dda_src_x,r2),r4		; Texture points
06003A28 5513                   		mov	@(dda_src_x,r1),r5
06003A2A 5625                  		mov	@(dda_src_y,r2),r6
06003A2C 5715                 		mov	@(dda_src_y,r1),r7
06003A2E                      
06003A2E 6093                  		mov	r9,r0
06003A30 3088                  		sub 	r8,r0
06003A32 4011                  		cmp/pz	r0				; Line rotated?
06003A34 8900                  		bt	@plus
06003A36                        		
06003A36 5523                 		mov	@(dda_src_x,r2),r5		; Texture points
06003A38 5413                   		mov	@(dda_src_x,r1),r4
06003A3A 5725                  		mov	@(dda_src_y,r2),r7
06003A3C 5615                 		mov	@(dda_src_y,r1),r6
06003A3E                        		
06003A3E 582A                 		mov	@(dda_dst_x,r2),r8		; Line start/end
06003A40 591A                 		mov	@(dda_dst_x,r1),r9
06003A42                       	
06003A42                      ; ------------------------------------
06003A42                      
06003A42                      @plus:
06003A42 6093                   		mov	r9,r0
06003A44 4029                     		shlr16	r0
06003A46 6103                     		mov	r0,r1
06003A48 6083                     		mov	r8,r0
06003A4A 4029                      		shlr16	r0
06003A4C 3108                     		sub	r0,r1
06003A4E 611F                      		exts	r1,r1
06003A50 D000                     		mov	#div_table,r0
06003A52 4108                     		shll2	r1				; Calculate width divisor
06003A54 001E                    		mov	@(r0,r1),r0
06003A56 3548                    		sub	r4,r5
06003A58 305D                    		dmuls	r5,r0
06003A5A 050A                    		mov	mach,r5
06003A5C 4524                    		rotcl	r5
06003A5E 3768                     		sub	r6,r7
06003A60 307D                     		dmuls	r7,r0
06003A62 070A                     		mov	mach,r7
06003A64 4724                    		rotcl	r7
06003A66                         	
06003A66                      ; ------------------------------------
06003A66                      
06003A66                      @no_texture:
06003A66 52A2                  		mov	@(tml_texture,r10),r2
06003A68                       		
06003A68                      ; ------------------------------------
06003A68                      ; Set Framebuffer Y pos
06003A68                      ; ------------------------------------
06003A68                      
06003A68 51A0                   		mov	@(tml_dst_y,r10),r1
06003A6A 4111                   		cmp/pz	r1				; Negative Y?
06003A6C 8B00                   		bf	@s_end
06003A6E D000                  		mov	#max_height,r0			; Reached bottom?
06003A70 3103                  		cmp/ge	r0,r1
06003A72 8900                  		bt	@s_end
06003A74                       		
06003A74 D000                  		mov	#320,r0				; Next Framebuffer line
06003A76 201E                  		mulu	r1,r0
06003A78 001A                  		mov	macl,r0
06003A7A D300                  		mov	#_framebuffer+$200,r3		; Framebuffer address
06003A7C 330C                  		add	r0,r3				; FB YPos
06003A7E                       		
06003A7E                      ; ------------------------------------
06003A7E                      ; Set line length
06003A7E                      ; ------------------------------------
06003A7E                      
06003A7E 4929                     		shlr16	r9
06003A80 699F                        		exts	r9,r9
06003A82 4911                            	cmp/pz	r9
06003A84 8B00                          	bf	@s_end
06003A86 339C                          	add 	r9,r3				;FB Xpos
06003A88 4829                     		shlr16	r8
06003A8A 688F                      		exts	r8,r8
06003A8C 4811                           	cmp/pz	r8
06003A8E 8900                         	bt	@check_type
06003A90 E800                         	mov	#0,r8
06003A92                       		
06003A92                      ; ------------------------------------
06003A92                      ; Check drawing mode
06003A92                      ; ------------------------------------
06003A92                      
06003A92                      @check_type:
06003A92 D000                  		mov	#256,r0				; Texture address $0-$FF?
06003A94 3207                  		cmp/gt	r0,r2
06003A96 8900                  		bt	@tex_write
06003A98                       		
06003A98                      ; ------------------------------------
06003A98                      ; Write solid color
06003A98                      ; ------------------------------------
06003A98                      
06003A98                      @solid_write:
06003A98 D000                    		mov	#max_width,r0			; Maximum X position?
06003A9A 3903                    		cmp/ge	r0,r9
06003A9C 8900                    		bt	@s_cont
06003A9E 50A5                    		mov 	@(tml_flags,r10),r0
06003AA0 C801                    		tst	#%01,r0
06003AA2 8900                    		bt	@not_under_s
06003AA4 E000                    		mov	#0,r0				; nothing written?
06003AA6 6030                    		mov.b	@r3,r0
06003AA8 8800                    		cmp/eq	#0,r0
06003AAA 8B00                    		bf	@s_cont
06003AAC                      @not_under_s:
06003AAC                      
06003AAC 6023                     		mov	r2,r0				; Solid color
06003AAE C9FF                  		and	#$FF,r0
06003AB0 2300                    		mov.b	r0,@r3	   			; Write pixel
06003AB2                      @s_cont:
06003AB2 73FF                 		sub 	#1,r3
06003AB4 3987                    		cmp/gt	r8,r9
06003AB6 8DEF                    		bt/s	@solid_write
06003AB8 79FF                  		sub 	#1,r9
06003ABA                      @s_end:
06003ABA 000B                  		rts
06003ABC 0009                  		nop
06003AC0 0000 0000 0000    +   		lits
06003AD4                       		align 4
06003AD4                       		
06003AD4                      ; ------------------------------------
06003AD4                      ; Write texture pixel
06003AD4                      ; ------------------------------------
06003AD4                       
06003AD4                      @tex_write:
06003AD4 D000                     		mov	#max_width,r0			; Maximum X position?
06003AD6 3903                     		cmp/ge	r0,r9
06003AD8 8900                     		bt	@max
06003ADA 50A5                    		mov 	@(tml_flags,r10),r0
06003ADC C801                    		tst	#%01,r0
06003ADE 8900                    		bt	@not_under
06003AE0 E000                    		mov	#0,r0				; nothing written?
06003AE2 6030                    		mov.b	@r3,r0
06003AE4 8800                    		cmp/eq	#0,r0
06003AE6 8B00                    		bf	@max
06003AE8                      @not_under:
06003AE8                       		; r6 - Y
06003AE8                       		; r4 - X
06003AE8 6169                      		swap	r6,r1				; r6 - yyyy0000 -> r1 - 0000yyyy
06003AEA 50A3                  		mov	@(tml_texwidth,r10),r0
06003AEC 201E                     		mulu	r1,r0				; macl = width * current Y
06003AEE 6143                     		mov	r4,r1	   			; xxxx0000 to r1
06003AF0 4129                     		shlr16	r1				; r1 = X (0000xxxx)
06003AF2 001A                     		mov	macl,r0				; r0 = Y (0000yyyy)
06003AF4 301C                     		add	r1,r0				; y + x
06003AF6 6123                     		mov 	r2,r1				; Texture address
06003AF8 310C                     		add 	r0,r1				; + line position
06003AFA 6010                     		mov.b	@r1,r0
06003AFC 51A4                  		mov 	@(tml_texadd,r10),r1
06003AFE 301C                      		add 	r1,r0
06003B00 C9FF                  		and	#$FF,r0
06003B02 2300                    		mov.b	r0,@r3	   			; Write pixel
06003B04                         		
06003B04                      @max:
06003B04 345C                    		add	r5,r4				; Update X
06003B06 367C                  		add	r7,r6				; Update Y
06003B08                      
06003B08                      @cont:
06003B08                      ; 		mov	#$1FF,r0
06003B08                      ; @TESTLOOP:	dt	r0
06003B08                      ; 		bf	@TESTLOOP
06003B08                      		
06003B08 73FF                 		sub 	#1,r3
06003B0A 3987                    		cmp/gt	r8,r9
06003B0C 8DE2                    		bt/s	@tex_write
06003B0E 79FF                  		sub 	#1,r9
06003B10                      @end:
06003B10 000B                  		rts
06003B12 0009                  		nop
06003B14 0000 0000             		lits
06003B18                       		align 4
06003B18                      
06003B18                      ; ----------------------------------------
06003B18                      ; Find top point
06003B18                      ;
06003B18                      ; Entry:
06003B18                      ;    r1: Source data
06003B18                      ;    r2: Destionation data
06003B18                      ;    r3: Num of points
06003B18                      ;
06003B18                      ; Returns:
06003B18                      ;
06003B18                      ;    r3: Start Y position
06003B18                      ;    r4: End Y position
06003B18                      ;    r5: Start dest point
06003B18                      ;    r6: Start source point
06003B18                      ;    r7: First dest point
06003B18                      ;    r8: Last  dest point
06003B18                      ;    r9: First source point
06003B18                      ; ----------------------------------------
06003B18                      
06003B18                      Preinit_DDA:
06003B18 6723                  		mov	r2,r7			; (DESTINATION address) -> r7
06003B1A 6233                 		mov	r3,r2			; r2 - Number of points to read (3 or 4)
06003B1C 6823                 		mov	r2,r8			; r2 -> r8
06003B1E 78FF                 		sub	#1,r8			; -1
06003B20 E008                 		mov	#sizeof_point,r0	; number of points (3 or 4) -1s
06003B22 280E                 		mulu	r0,r8			; * sizeof_point
06003B24 081A                 		mov	macl,r8			; r8 - result
06003B26 387C                 		add	r7,r8			; RETURN: r8 + (DESTINATION address) =  (last point address)
06003B28                      
06003B28 6973                 		mov	r7,r9			; (DESTINATION address) to r9, Search for dest start point
06003B2A D300                 		mov	#$7FFFFFFF,r3		; r3 - Default Start Y
06003B2C E4FF                 		mov	#$FFFFFFFF,r4		; r4 - Default End Y
06003B2E                      @loop
06003B2E 5091                 		mov	@(point_y,r9),r0	; r0 - Y point to check
06003B30                      		
06003B30 3033                 		cmp/ge	r3,r0			; This Y < $7FFFFFFF?
06003B32 8900                 		bt	@not_start
06003B34 6593                 		mov	r9,r5			; RETURN: r5 - New START destination points
06003B36 6303                 		mov	r0,r3			; RETURN: r3 - Update Start Y with this new position
06003B38                      @not_start:
06003B38 3403                 		cmp/ge	r0,r4			; This Y < $FFFFFFFF?
06003B3A 8900                 		bt	@not_end
06003B3C 6403                 		mov	r0,r4			; RETURN: r4 - Update End Y with this new position
06003B3E                      @not_end:
06003B3E 7908                 		add	#sizeof_point,r9	; Check next point
06003B40 4210                 		dt	r2			;
06003B42 8BF4                 		bf	@loop			;
06003B44                      
06003B44 6653                 		mov	r5,r6			; r6 - (DESTINATION Address) "Set source start point"
06003B46 3678                 		sub	r7,r6			; r6 - (DESTINATION Target) - (DESTINATION Start)
06003B48 361C                 		add	r1,r6			; r6 - (DESTINATION Target) + (SOURCE points)
06003B4A                      						; RETURN: r6 - Start SOURCE point
06003B4A 000B                 		rts
06003B4C 6913                 		mov 	r1,r9			; RETURN: r9 - First SOURCE point
06003B50 0000 0000 0000       		lits
06003B54                      		cnop 0,4
06003B54                      
06003B54                      ; ----------------------------------------
06003B54                      ; Init DDA
06003B54                      ;
06003B54                      ; Entry:
06003B54                      ;
06003B54                      ;    r2: DDA pointer
06003B54                      ;    r5: Start dest point
06003B54                      ;    r6: Start source point
06003B54                      ;    r7: First dest point
06003B54                      ;    r8: Last  dest point
06003B54                      ;    r9: First source point
06003B54                      ; ----------------------------------------
06003B54                      
06003B54                      		cnop 0,4
06003B54                      Init_DDA:
06003B54 6083                  		mov	r8,r0
06003B56 3078                  		sub	r7,r0
06003B58 309C                  		add	r9,r0
06003B5A 1257                  		mov	r5,@(dda_dst_point,r2)	; Set destination points
06003B5C 1260                  		mov	r6,@(dda_src_point,r2)  ; Set source point
06003B5E 1278                  		mov	r7,@(dda_dst_low,r2)
06003B60 1289                  		mov	r8,@(dda_dst_high,r2)
06003B62 1291                  		mov	r9,@(dda_src_low,r2)
06003B64 1202                  		mov	r0,@(dda_src_high,r2)
06003B66                      
06003B66 E000                 		mov	#0,r0			; Set height to zero
06003B68 000B                  		rts
06003B6A 120C                  		mov	r0,@(dda_dst_h,r2)
06003B6C                      
06003B6C                      ; ----------------------------------------
06003B6C                      ; Update left DDA
06003B6C                      ;
06003B6C                      ; r8: DDA pointer
06003B6C                      ; ----------------------------------------
06003B6C                      
06003B6C                      Update_Left_DDA:
06003B6C                      
06003B6C                      ; Start critical section
06003B6C                      
06003B6C 508C                 		mov	@(dda_dst_h,r8),r0	; Decrement height
06003B6E 8800                 		cmp/eq	#0,r0
06003B70 8900                 		bt	@next_point
06003B72 70FF                 		sub	#1,r0
06003B74 180C                 		mov	r0,@(dda_dst_h,r8)
06003B76                      
06003B76 518A                 		mov	@(dda_dst_x,r8),r1
06003B78 508B                 		mov	@(dda_dst_dx,r8),r0
06003B7A 310C                 		add 	r0,r1
06003B7C 181A                 		mov	r1,@(dda_dst_x,r8)
06003B7E 5183                 		mov	@(dda_src_x,r8),r1
06003B80 5084                 		mov	@(dda_src_dx,r8),r0
06003B82 310C                 		add 	r0,r1
06003B84 1813                 		mov	r1,@(dda_src_x,r8)
06003B86 5185                 		mov	@(dda_src_y,r8),r1
06003B88 5086                 		mov	@(dda_src_dy,r8),r0
06003B8A 310C                 		add 	r0,r1
06003B8C 000B                 		rts
06003B8E 1815                 		mov	r1,@(dda_src_y,r8)
06003B90                      
06003B90                      ; End critical section
06003B90                      
06003B90                      @next_point:
06003B90 D500                 		mov	#$80000000,r5
06003B92                      
06003B92 5687                 		mov	@(dda_dst_point,r8),r6	; Set dest to target point
06003B94 5160                 		mov	@(point_x,r6),r1
06003B96 6053                 		mov	r5,r0
06003B98 201D                 		xtrct	r1,r0
06003B9A 180A                 		mov	r0,@(dda_dst_x,r8)
06003B9C 5261                 		mov	@(point_y,r6),r2
06003B9E                      
06003B9E 5780                 		mov	@(dda_src_point,r8),r7	; Set source to target point
06003BA0 5370                 		mov	@(point_x,r7),r3
06003BA2 6053                 		mov	r5,r0
06003BA4 203D                 		xtrct	r3,r0
06003BA6 1803                 		mov	r0,@(dda_src_x,r8)
06003BA8 5471                 		mov	@(point_y,r7),r4
06003BAA 6053                 		mov	r5,r0
06003BAC 204D                 		xtrct	r4,r0
06003BAE 1805                 		mov	r0,@(dda_src_y,r8)
06003BB0                      
06003BB0 5589                 		mov	@(dda_dst_high,r8),r5	; Calculate next target point
06003BB2 7608                 		add	#SIZEOF_POINT,r6
06003BB4 7708                 		add	#SIZEOF_POINT,r7
06003BB6 3657                 		cmp/gt	r5,r6
06003BB8 8B00                 		bf	@save_new_target
06003BBA 5688                 		mov	@(dda_dst_low,r8),r6
06003BBC 5781                 		mov	@(dda_src_low,r8),r7
06003BBE                      
06003BBE                      @save_new_target
06003BBE 1867                 		mov	r6,@(dda_dst_point,r8)
06003BC0 1870                 		mov	r7,@(dda_src_point,r8)
06003BC2                      
06003BC2 5560                 		mov	@(point_x,r6),r5	; Calculate dest dx and dy
06003BC4 3518                 		sub	r1,r5
06003BC6 5661                 		mov	@(point_y,r6),r6
06003BC8 3628                 		sub	r2,r6
06003BCA                      
06003BCA 6063                 		mov	r6,r0
06003BCC 8800                 		cmp/eq	#0,r0
06003BCE 89DF                 		bt	@next_point
06003BD0 4011                 		cmp/pz	r0
06003BD2 8B00                 		bf	@exit
06003BD4                      
06003BD4 A000                 		bra	dda_upd_divide
06003BD6 186C                 		mov	r6,@(dda_dst_h,r8)
06003BD8                      		
06003BD8                      @exit:
06003BD8 000B                 		rts
06003BDA 0009                 		nop
06003BDC                      
06003BDC                      ; ----------------------------------------
06003BDC                      ; Update right DDA
06003BDC                      ;
06003BDC                      ; r8: DDA pointer
06003BDC                      ; ----------------------------------------
06003BDC                      
06003BDC                      Update_Right_DDA:	
06003BDC 508C                 		mov	@(dda_dst_h,r8),r0	; Decrement height
06003BDE 8800                 		cmp/eq	#0,r0
06003BE0 8900                 		bt	@next_point
06003BE2 70FF                 		sub	#1,r0
06003BE4 180C                 		mov	r0,@(dda_dst_h,r8)
06003BE6                      
06003BE6 518A                 		mov	@(dda_dst_x,r8),r1
06003BE8 508B                 		mov	@(dda_dst_dx,r8),r0
06003BEA 310C                 		add 	r0,r1
06003BEC 181A                 		mov	r1,@(dda_dst_x,r8)
06003BEE 5183                 		mov	@(dda_src_x,r8),r1
06003BF0 5084                 		mov	@(dda_src_dx,r8),r0
06003BF2 310C                 		add 	r0,r1
06003BF4 1813                 		mov	r1,@(dda_src_x,r8)
06003BF6 5185                 		mov	@(dda_src_y,r8),r1
06003BF8 5086                 		mov	@(dda_src_dy,r8),r0
06003BFA 310C                 		add 	r0,r1
06003BFC 000B                 		rts
06003BFE 1815                 		mov	r1,@(dda_src_y,r8)
06003C00                      
06003C00                      ; End critical section
06003C00                      
06003C00                      @next_point:
06003C00 D500                 		mov	#$80000000,r5
06003C02                      
06003C02 5687                 		mov	@(dda_dst_point,r8),r6	; Set dest to target point
06003C04 5160                 		mov	@(point_x,r6),r1
06003C06 6053                 		mov	r5,r0
06003C08 201D                 		xtrct	r1,r0
06003C0A 180A                 		mov	r0,@(dda_dst_x,r8)
06003C0C 5261                 		mov	@(point_y,r6),r2
06003C0E                      
06003C0E 5780                 		mov	@(dda_src_point,r8),r7	; Set source to target point
06003C10 5370                 		mov	@(point_x,r7),r3
06003C12 6053                 		mov	r5,r0
06003C14 203D                 		xtrct	r3,r0
06003C16 1803                 		mov	r0,@(dda_src_x,r8)
06003C18 5471                 		mov	@(point_y,r7),r4
06003C1A 6053                 		mov	r5,r0
06003C1C 204D                 		xtrct	r4,r0
06003C1E 1805                 		mov	r0,@(dda_src_y,r8)
06003C20                      
06003C20 5588                 		mov	@(dda_dst_low,r8),r5	; Calculate next target point
06003C22 76F8                 		sub	#SIZEOF_POINT,r6
06003C24 3653                 		cmp/ge	r5,r6
06003C26 8D00                 		bt/s	@save_new_target
06003C28 77F8                 		sub	#SIZEOF_POINT,r7
06003C2A 5689                 		mov	@(dda_dst_high,r8),r6
06003C2C 5782                 		mov	@(dda_src_high,r8),r7
06003C2E                      
06003C2E                      @save_new_target
06003C2E 1867                 		mov	r6,@(dda_dst_point,r8)
06003C30 1870                 		mov	r7,@(dda_src_point,r8)
06003C32                      
06003C32 5560                 		mov	@(point_x,r6),r5	; Calculate dest dx and dy
06003C34 3518                 		sub	r1,r5
06003C36 5661                 		mov	@(point_y,r6),r6
06003C38 3628                 		sub	r2,r6
06003C3A                      
06003C3A 6063                 		mov	r6,r0
06003C3C 8800                 		cmp/eq	#0,r0
06003C3E 89DF                 		bt	@next_point
06003C40 4011                 		cmp/pz	r0
06003C42 8B00                 		bf	@exit
06003C44                      
06003C44 A000                 		bra	dda_upd_divide
06003C46 186C                 		mov	r6,@(dda_dst_h,r8)
06003C48                      		
06003C48                      @exit:
06003C48 000B                 		rts
06003C4A 0009                 		nop
06003C4C                      		
06003C4C                      ; ----------------------------------------
06003C4C                      ; Shared DDA things
06003C4C                      ; 
06003C4C                      ; r3 - Src X point
06003C4C                      ; r6 - Dest Y point
06003C4C                      ; r7 - source points
06003C4C                      ; r8 - current dda
06003C4C                      ; ----------------------------------------
06003C4C                      
06003C4C                      dda_upd_divide:
06003C4C D000                 		mov	#div_table,r0		; Calculate divisor
06003C4E 4608                 		shll2	r6
06003C50 006E                 		mov	@(r0,r6),r0
06003C52 4528                 		shll16	r5			; Calculate dest dx
06003C54 305D                 		dmuls	r5,r0
06003C56 010A                 		mov	mach,r1
06003C58 4124                 		rotcl	r1
06003C5A 181B                 		mov	r1,@(dda_dst_dx,r8)
06003C5C                      
06003C5C 5570                 		mov	@(point_x,r7),r5	; Calculate source dx and dy
06003C5E 3538                 		sub	r3,r5
06003C60 5671                 		mov	@(point_y,r7),r6
06003C62 3648                 		sub	r4,r6
06003C64 4528                 		shll16	r5
06003C66 305D                 		dmuls	r5,r0			; Calculate source dx
06003C68 010A                 		mov	mach,r1
06003C6A 4124                 		rotcl	r1
06003C6C 1814                 		mov	r1,@(dda_src_dx,r8)
06003C6E 4628                 		shll16	r6
06003C70 306D                 		dmuls	r6,r0			; Calculate source dy
06003C72 010A                 		mov	mach,r1
06003C74 4124                 		rotcl	r1
06003C76 000B                 		rts
06003C78 1816                 		mov	r1,@(dda_src_dy,r8)
06003C7C 0000 0000 0000    +  		lits
06003C84                      		cnop 0,4
06003C84                      		
06003C84                      ; ----------------------------------------
06003C84                      ; Clone DDA
06003C84                      ;
06003C84                      ; r8: DDA pointer
06003C84                      ; ----------------------------------------
06003C84                      
06003C84                      Clone_DDA:
06003C84 D100                 		mov 	#left_dda,r1
06003C86 D200                 		mov	#left_dda_sl,r2
06003C88 D300                 		mov	#right_dda,r3
06003C8A D400                 		mov	#right_dda_sl,r4
06003C8C E534                 		mov	#sizeof_dda,r5
06003C8E                      @loop:
06003C8E 6016                 		mov	@r1+,r0
06003C90 2202                 		mov	r0,@r2
06003C92 7204                 		add 	#4,r2
06003C94 6036                 		mov	@r3+,r0
06003C96 2402                 		mov	r0,@r4
06003C98 7404                 		add 	#4,r4
06003C9A 4510                 		dt	r5
06003C9C 8BF7                 		bf	@loop
06003C9E                      		
06003C9E 000B                 		rts
06003CA0 0009                 		nop
06003CA4 0000 0000 0000    +  		lits
06003CB4                      		cnop 0,4
06003CB4                      		
06003CB4                      ; =================================================================
06003CB4                      ; ----------------------------------------
06003CB4                      ; Start
06003CB4                      ; ----------------------------------------
06003CB4                      
06003CB4                      ; ----------------------------------------
06003CB4                      ; Draw_Face
06003CB4                      ;
06003CB4                      ; Input:
06003CB4                      ; r1 - points source
06003CB4                      ; r2 - points destination
06003CB4                      ; r3 - number of points ($03 or $04)
06003CB4                      ; r4 - bitmap pointer/solid color $01-$FF(255)
06003CB4                      ; r5 - texture width (ignored if solid color)
06003CB4                      ; r6 - add $xx to indexed texture
06003CB4                      ; r7 - flags
06003CB4                      ; Uses:
06003CB4                      ; r0-r10
06003CB4                      ; ----------------------------------------
06003CB4                      
06003CB4                      Draw_Face_Slave:
06003CB4 DA00                 		mov	#tml_data_sl,r10
06003CB6 D000                 		mov	#left_dda_sl,r0
06003CB8 1A06                 		mov	r0,@(tml_left,r10)
06003CBA D000                 		mov	#right_dda_sl,r0
06003CBC 1A07                 		mov	r0,@(tml_right,r10)
06003CBE A000                 		bra	DrwTex_Go
06003CC0 E701                 		mov	#1,r7			;FLAG: Underwrite
06003CC2                      		
06003CC2                      Draw_Face:
06003CC2 DA00                 		mov	#tml_data,r10
06003CC4 D000                 		mov	#left_dda,r0
06003CC6 1A06                 		mov	r0,@(tml_left,r10)
06003CC8 D000                 		mov	#right_dda,r0
06003CCA 1A07                 		mov	r0,@(tml_right,r10)
06003CCC E701                 		mov	#1,r7			;FLAG: Underwrite
06003CCE                      
06003CCE                      ; --------------------
06003CCE                      ; Start drawing
06003CCE                      ; --------------------
06003CCE                      
06003CCE                      DrwTex_Go:
06003CCE 4F22                 		mov	pr,@-r15
06003CD0                      		
06003CD0 1A42                  		mov	r4,@(tml_texture,r10)
06003CD2 1A53                  		mov 	r5,@(tml_texwidth,r10)
06003CD4 1A64                   		mov 	r6,@(tml_texadd,r10)
06003CD6 BF1F                 		bsr	Preinit_DDA
06003CD8 1A75                 		mov	r7,@(tml_flags,r10)
06003CDA                       		
06003CDA                      ; --------------------
06003CDA                      ; Init DDA
06003CDA                      ; --------------------
06003CDA                      
06003CDA 3430                 		cmp/eq	r3,r4
06003CDC 8900                 		bt	@end
06003CDE 52A6                 		mov	@(tml_left,r10),r2
06003CE0 BF38                 		bsr	Init_DDA
06003CE2 0009                 		nop
06003CE4 52A7                 		mov	@(tml_right,r10),r2
06003CE6 BF35                 		bsr	Init_DDA
06003CE8 0009                 		nop
06003CEA                      		
06003CEA                      ; --------------------
06003CEA                      ; Fix Y
06003CEA                      ; 
06003CEA                      ; r3 - Start Y
06003CEA                      ; r4 - End Y
06003CEA                      ; --------------------
06003CEA                      
06003CEA 4415                 		cmp/pl	r4
06003CEC 8900                 		bt	@not_top
06003CEE E3FF                 		mov	#-1,r3	
06003CF0                      @not_top:
06003CF0 1A30                 		mov	r3,@(tml_dst_y,r10)
06003CF2 3437                 		cmp/gt	r3,r4
06003CF4 8B00                 		bf	@end
06003CF6 7401                 		add	#1,r4
06003CF8 1A41                 		mov	r4,@(tml_bottom_y,r10)
06003CFA                       		
06003CFA                      ; --------------------
06003CFA                      ; CPU save flag
06003CFA                      ; --------------------
06003CFA                      
06003CFA                      ;  		mov 	#0,r1
06003CFA                      ;      		sub 	r3,r4
06003CFA                      ;      		mov 	#$58,r0
06003CFA                      ;      		cmp/ge	r0,r4
06003CFA                      ;      		bf	@fullv
06003CFA                      ;      		mov 	#1,r1
06003CFA                      ; @fullv:
06003CFA                      ;   		mov 	r1,@(tml_flags,r10)
06003CFA                       		
06003CFA                       		
06003CFA                      ; --------------------
06003CFA                      ; Draw lines
06003CFA                      ; --------------------
06003CFA                      
06003CFA                      @loop:
06003CFA 58A6                 		mov	@(tml_left,r10),r8
06003CFC BF36                 		bsr	Update_Left_DDA
06003CFE 0009                 		nop
06003D00 58A7                 		mov	@(tml_right,r10),r8
06003D02 BF6B                  		bsr	Update_Right_DDA
06003D04 0009                  		nop
06003D06 51A6                 		mov	@(tml_left,r10),r1
06003D08 52A7                  		mov	@(tml_right,r10),r2
06003D0A BE7F                  		bsr	Texture_Map_Line
06003D0C 0009                  		nop
06003D0E                       		
06003D0E 52A0                 		mov	@(tml_dst_y,r10),r2			; Next texture line
06003D10 7201                 		add 	#1,r2
06003D12 1A20                 		mov	r2,@(tml_dst_y,r10)
06003D14 51A1                 		mov	@(tml_bottom_y,r10),r1			; Reached end?
06003D16 3217                 		cmp/gt	r1,r2
06003D18 8BEF                 		bf	@loop
06003D1A                      		
06003D1A                      @end:
06003D1A 4F26                 		mov	@r15+,pr
06003D1C 000B                 		rts
06003D1E 0009                 		nop
06003D20 0000 0000 0000    +  		lits
06003D38                      		cnop 0,4
06003D38                      		
06003D38                      ; =================================================================
06003D38                      ; ----------------------------------------
06003D38                      ; Set new model
06003D38                      ;
06003D38                      ; r1 - Model
06003D38                      ; r2 - Slot
06003D38                      ; ----------------------------------------
06003D38                      
06003D38                      Mars3d_ModelSet:
06003D38 DE00                 		mov	#models_buffer,r14
06003D3A E020                 		mov	#sizeof_model,r0
06003D3C 202E                 		mulu	r2,r0
06003D3E 001A                 		mov	macl,r0
06003D40 3E0C                 		add 	r0,r14
06003D42                      
06003D42 1E10                 		mov.l	r1,@(model_addr,r14)
06003D44 000B                  		rts
06003D46 0009                 		nop
06003D48 0000 0000            		lits
06003D4C                      		cnop 0,4
06003D4C                      
06003D4C                      ; =================================================================
06003D4C                      ; ----------------------------------
06003D4C                      ; Build model
06003D4C                      ; 
06003D4C                      ; r13 - model address
06003D4C                      ; ----------------------------------
06003D4C                      
06003D4C                      mars3d_makemdl:
06003D4C 4F22                 		mov.l	pr,@-r15
06003D4E                      		
06003D4E                      ; 		mov.l	@(model_addr,r14),r13
06003D4E 68D2                 		mov.l	@r13,r8			; r8 - Faces
06003D50 59D1                 		mov.l	@(4,r13),r9		; r9 - Points
06003D52 5AD2                 		mov.l	@(8,r13),r10		; r10 - Material
06003D54 50D3                 		mov.l	@($C,r13),r0		; Painter Z start
06003D56                      ; 		mov.l	r0,@(model_z_start,r14)
06003D56                      		
06003D56 DD00                 		mov	#faces_buffer,r13
06003D58 E000                  		mov	#0,r0
06003D5A 2D02                  		mov	r0,@r13
06003D5C 7D04                  		add 	#faces_data,r13
06003D5E                      
06003D5E                      ; ----------------------------------
06003D5E                      
06003D5E                      @next:
06003D5E E000                 		mov	#0,r0
06003D60 6085                 		mov.w	@r8+,r0
06003D62 6B03                 		mov	r0,r11
06003D64 E003                 		mov	#3,r0			;triangle?
06003D66 3B00                 		cmp/eq	r0,r11
06003D68 8900                 		bt	@valid
06003D6A 7001                 		add 	#1,r0
06003D6C 3B00                 		cmp/eq	r0,r11			;quad?
06003D6E 8900                 		bt	@valid
06003D70 A000                 		bra	@end
06003D72 0009                 		nop
06003D74                      		
06003D74                      ; ----------------------------------
06003D74                      ; Valid model
06003D74                      ; ----------------------------------
06003D74                      
06003D74                      @valid:
06003D74 1DB4                 		mov	r11,@(faces_type,r13)
06003D76                      		
06003D76                      ; ----------------------------------
06003D76                      ; find texture
06003D76                      ; ----------------------------------
06003D76                      
06003D76 D200                 		mov	#255,r2			; Undefined
06003D78 E300                 		mov	#0,r3			; Default $XX add
06003D7A E000                 		mov	#0,r0
06003D7C 6085                 		mov.w	@r8+,r0
06003D7E D100                 		mov	#256,r1
06003D80 3013                 		cmp/ge	r1,r0
06003D82 8B00                 		bf	@solid_color
06003D84 3018                 		sub 	r1,r0
06003D86 6103                 		mov	r0,r1			; ID
06003D88 64A3                 		mov	r10,r4			; materials
06003D8A                      @nexttex:
06003D8A 6046                 		mov.l	@r4+,r0			; ID
06003D8C 4011                 		cmp/pz	r0
06003D8E 8B00                 		bf	@notfound
06003D90 3100                 		cmp/eq	r0,r1
06003D92 8900                 		bt	@found
06003D94                      		
06003D94                      		;TODO: creo que tengo que deshacerme de esto
06003D94 D500                  		mov	#255,r5
06003D96 3053                  		cmp/ge	r5,r0
06003D98 8B00                  		bf	@solid_only
06003D9A 7420                 		add	#$20,r4			; skip texture setting (8 LONGS)
06003D9C                      @solid_only:
06003D9C                      
06003D9C AFF5                 		bra	@nexttex
06003D9E 740C                 		add	#$C,r4
06003DA0                      		
06003DA0                      @solid_color:
06003DA0                      ; 		mov	r0,r2
06003DA0 A000                 		bra	@notfound
06003DA2 6203                  		mov	r0,r2
06003DA4                      
06003DA4                      @found:
06003DA4 6246                  		mov.l	@r4+,r2			; Texture/SolidColor
06003DA6 6546                   		mov.l	@r4+,r5			; Texture width
06003DA8 6346                   		mov.l	@r4+,r3			; $xx Add
06003DAA                        		
06003DAA                      @notfound:
06003DAA 1D21                 		mov.l	r2,@(face_tex,r13)
06003DAC 1D32                 		mov.l	r3,@(face_tex_add,r13)		
06003DAE 1D53                 		mov.l	r5,@(face_tex_width,r13)	
06003DB0                      		
06003DB0                      @solid_tex:
06003DB0                      		
06003DB0                      ; ----------------------------------
06003DB0                      ; Set texture source
06003DB0                      ; ----------------------------------
06003DB0                      
06003DB0 1D45                 		mov 	r4,@(faces_srcaddr,r13)
06003DB2                      		
06003DB2                      ; ----------------------------------
06003DB2                      ; Send target points to buffer
06003DB2                      ; ----------------------------------
06003DB2                      	
06003DB2 67D3                 		mov	r13,r7
06003DB4 7718                 		add	#face_points,r7
06003DB6                      		
06003DB6 E100                  		mov	#0,r1
06003DB8                      @nextpoints:
06003DB8 6C93                 		mov	r9,r12
06003DBA E000                 		mov	#0,r0
06003DBC 6085                 		mov.w	@r8+,r0
06003DBE E106                 		mov	#6,r1
06003DC0 210E                 		mulu	r0,r1
06003DC2 001A                 		mov	macl,r0
06003DC4 3C0C                 		add 	r0,r12
06003DC6                      
06003DC6                      ; ----------------------------------
06003DC6                      
06003DC6 E000                  		mov	#0,r0
06003DC8 85C2                  		mov.w	@(4,r12),r0
06003DCA 600F                  		exts.w	r0,r0
06003DCC 51E3                      		mov	@(model_z,r14),r1
06003DCE 301C                      		add 	r1,r0	
06003DD0 6603                   		mov	r0,r6
06003DD2                        		
06003DD2 E000                 		mov	#0,r0
06003DD4 60C1                 		mov.w	@r12,r0
06003DD6 600F                  		exts.w	r0,r0
06003DD8 51E1                       		mov 	@(model_x,r14),r1
06003DDA 301C                        		add 	r1,r0
06003DDC B000                       		bsr 	@mdl_setresize_alt
06003DDE 6503                   		mov	r0,r5
06003DE0 350C                       		add 	r0,r5
06003DE2                            		
06003DE2                       		;r5 - X
06003DE2                       		;r6 - Z
06003DE2                       		
06003DE2 4528                  		shll16	r5
06003DE4 4628                  		shll16	r6
06003DE6 50E5                    		mov	@(model_y_rot,r14),r0
06003DE8 D100                     		mov	#$7FF,r1
06003DEA 2019                     		and	r1,r0
06003DEC                      ;    		shll2	r0  
06003DEC BDF0                  		bsr	Rotate_Point
06003DEE 4008                    		shll2	r0 
06003DF0 4029                  		shlr16	r0
06003DF2 600F                  		exts.w	r0,r0
06003DF4 2702                    		mov	r0,@r7
06003DF6                         		
06003DF6                       		;r1 = Z
06003DF6 6613                  		mov	r1,r6
06003DF8 E000                  		mov	#0,r0
06003DFA 85C1                 		mov.w	@(2,r12),r0
06003DFC 600F                  		exts.w	r0,r0
06003DFE 51E2                       		mov 	@(model_y,r14),r1
06003E00 301C                        		add 	r1,r0
06003E02 B000                      		bsr 	@mdl_setresize_alt
06003E04 6503                       		mov 	r0,r5
06003E06 350C                          	add 	r0,r5
06003E08 4528                   		shll16	r5
06003E0A 50E4                    		mov	@(model_x_rot,r14),r0
06003E0C D200                     		mov	#$7FF,r2
06003E0E 2029                     		and	r2,r0
06003E10                      ;    		shll2	r0
06003E10 BDDE                  		bsr	Rotate_Point
06003E12 4008                    		shll2	r0
06003E14                         		
06003E14 4029                  		shlr16	r0
06003E16 600F                  		exts.w	r0,r0
06003E18 4129                     		shlr16	r1
06003E1A 611F                     		exts.w	r1,r1
06003E1C 1712                       		mov	r1,@(8,r7)
06003E1E 1701                       		mov	r0,@(4,r7)
06003E20                            		
06003E20 770C                    		add	#$C,r7
06003E22 4B10                   		dt	r11
06003E24 8BC8                   		bf	@nextpoints
06003E26                      
06003E26                      ; ----------------------------------
06003E26                      ; Check if Z near or far
06003E26                      ; 
06003E26                      ; Also X
06003E26                      ; ----------------------------------
06003E26                      
06003E26 67D3                   		mov	r13,r7
06003E28 7718                   		add	#face_points,r7
06003E2A                      
06003E2A D100                   		mov	#-384,r1		; Z far  best: -256
06003E2C D200                   		mov	#1024,r2		; Z near best: 1024
06003E2E D300                   		mov 	#-384,r3		; X left best: -384
06003E30 D400                    		mov	#384,r4			; X right best: 384
06003E32                        		
06003E32 55D4                  		mov	@(faces_type,r13),r5
06003E34                      @next2:
06003E34 5072                   		mov	@(8,r7),r0
06003E36 3013                    		cmp/ge	r1,r0
06003E38 8B00                    		bf	@is_bad
06003E3A 3023                   		cmp/ge	r2,r0
06003E3C 8900                   		bt	@is_bad
06003E3E                      
06003E3E 6072                    		mov	@r7,r0
06003E40 3033                     		cmp/ge	r3,r0
06003E42 8B00                     		bf	@is_bad
06003E44 3043                    		cmp/ge	r4,r0
06003E46 8900                    		bt	@is_bad
06003E48                        		
06003E48 770C                      		add	#$C,r7
06003E4A 4510                      		dt 	r5
06003E4C 8BF2                      		bf	@next2
06003E4E                       
06003E4E                      ; -----------------------------
06003E4E                      
06003E4E E201                 		mov	#1,r2	
06003E50 4015                 		cmp/pl	r0
06003E52 8B00                 		bf	@set_it
06003E54 E202                 		mov	#2,r2
06003E56                      @set_it:
06003E56 1D20                 		mov	r2,@(face_flags,r13)
06003E58                      		
06003E58                      ; ----------------------------------
06003E58                      
06003E58 D100                   		mov 	#faces_buffer,r1
06003E5A 5010                    		mov	@(faces_used,r1),r0
06003E5C 7001                    		add 	#1,r0
06003E5E 1100                    		mov 	r0,@(faces_used,r1)
06003E60 D100                    		mov 	#numof_faces-1,r1
06003E62 3013                    		cmp/ge	r1,r0
06003E64 8900                    		bt	@end
06003E66 7D48                  		add 	#sizeof_face,r13
06003E68                      @is_bad:
06003E68 AF79                      		bra	@next
06003E6A 0009                      		nop
06003E6C                       	
06003E6C                      ; ----------------------------------
06003E6C                      ; end
06003E6C                      ; ----------------------------------
06003E6C                      
06003E6C                      @end:
06003E6C E000                 		mov	#0,r0
06003E6E 1D00                 		mov	r0,@(face_flags,r13)		; set end of list
06003E70                      		
06003E70                      ; ----------------------------------
06003E70                      ; draw faces
06003E70                      ; 
06003E70                      ; r12 - faces used
06003E70                      ; r11 - Z counter
06003E70                      ; ----------------------------------
06003E70                      
06003E70 DD00                       		mov	#faces_buffer,r13
06003E72 5CD0                       		mov 	@(faces_used,r13),r12
06003E74 7D04                       		add 	#faces_data,r13
06003E76 EB20                      		mov 	#32,r11			; lower = faster
06003E78 50E3                      		mov	@(model_z,r14),r0
06003E7A 3B0C                      		add 	r0,r11
06003E7C                           		
06003E7C D900                      		mov	#mstr_faces,r9
06003E7E DA00                      		mov	#slve_faces,r10
06003E80                           		
06003E80                      ; -----------------------------
06003E80                      
06003E80                      @num_next:
06003E80 50D0                   		mov	@(face_flags,r13),r0
06003E82 88FF                   		cmp/eq	#-1,r0
06003E84 8900                   		bt	@face_off
06003E86                      
06003E86                      ; -----------------------------
06003E86                      ; Z Check Painters algorithm
06003E86                      ; -----------------------------
06003E86                      
06003E86 64D3                       		mov	r13,r4
06003E88 7418                        		add 	#face_points,r4
06003E8A 5142                          	mov 	@(8,r4),r1		;point 1
06003E8C 740C                          	add 	#$C,r4
06003E8E                               	
06003E8E 5042                          	mov	@(8,r4),r0		;point 2
06003E90 740C                          	add 	#$C,r4
06003E92 3103                          	cmp/ge	r0,r1
06003E94 8B00                          	bf	@same_1
06003E96 6103                          	mov	r0,r1
06003E98                      @same_1:
06003E98 5042                          	mov	@(8,r4),r0		;point 3
06003E9A 740C                          	add 	#$C,r4
06003E9C 3103                          	cmp/ge	r0,r1
06003E9E 8B00                          	bf	@same_2
06003EA0 6103                          	mov	r0,r1
06003EA2                      @same_2:
06003EA2 50D4                 		mov	@(faces_type,r13),r0
06003EA4 8803                 		cmp/eq	#3,r0
06003EA6 8900                 		bt	@same_3
06003EA8 5042                          	mov	@(8,r4),r0		;point 4
06003EAA 740C                          	add 	#$C,r4
06003EAC 3103                          	cmp/ge	r0,r1
06003EAE 8B00                          	bf	@same_3
06003EB0 6103                          	mov	r0,r1
06003EB2                      @same_3:
06003EB2 3B17                          	cmp/gt	r1,r11
06003EB4 8900                          	bt	@face_off
06003EB6                             
06003EB6                      ; -----------------------------
06003EB6                      ; Convert model points to
06003EB6                      ; texture points
06003EB6                      ; -----------------------------
06003EB6                      
06003EB6 50D0                   		mov	@(face_flags,r13),r0
06003EB8 8801                   		cmp/eq	#1,r0
06003EBA 8900                   		bt	@master_side
06003EBC                        		
06003EBC 2AD2                 		mov 	r13,@r10
06003EBE A000                   		bra	@also_convert
06003EC0 7A04                 		add	#4,r10
06003EC2                        		
06003EC2                      @master_side:
06003EC2 29D2                 		mov 	r13,@r9
06003EC4 7904                 		add	#4,r9
06003EC6                                 
06003EC6                      @also_convert:
06003EC6 61D3                       		mov	r13,r1
06003EC8 7118                       		add 	#face_points,r1			; r1 - XYZ points
06003ECA 6213                       		mov 	r1,r2
06003ECC 53D4                       		mov 	@(faces_type,r13),r3
06003ECE                      @next_master:
06003ECE 6012                     		mov	@r1,r0
06003ED0 D400                        		mov	#(max_width/2),r4
06003ED2 304C                              	add 	r4,r0
06003ED4 2202                        		mov	r0,@r2
06003ED6 5011                     		mov	@(4,r1),r0
06003ED8 E470                        		mov	#(max_height/2),r4
06003EDA 304C                             	add 	r4,r0
06003EDC 1201                       		mov	r0,@(4,r2)
06003EDE 710C                    		add 	#$C,r1
06003EE0 7208                     		add 	#8,r2
06003EE2 4310                     		dt	r3
06003EE4 8BF3                     		bf	@next_master
06003EE6                                  	
06003EE6                      ; -----------------------------
06003EE6                      
06003EE6                      @force_done:
06003EE6 E0FF                 		mov	#-1,r0
06003EE8 1D00                    		mov 	r0,@(face_flags,r13)
06003EEA 7CFF                    		sub 	#1,r12				; Decrement number of faces
06003EEC                      
06003EEC                      @face_off:
06003EEC 4C15                  		cmp/pl	r12				; Still doing faces?
06003EEE 8B00                  		bf	@finished			; Finish if $00 or minus
06003EF0 7D48                  		add 	#sizeof_face,r13
06003EF2                       		
06003EF2 50D0                  		mov	@(face_flags,r13),r0		; Reached end of list?
06003EF4 8800                  		cmp/eq	#0,r0
06003EF6 8BC3                  		bf	@num_next
06003EF8                       		
06003EF8 DD00                        		mov	#faces_buffer+faces_data,r13	; Return to first face
06003EFA AFC1                      		bra	@num_next
06003EFC 7BFF                        		sub 	#1,r11
06003EFE                           		
06003EFE                      @finished:
06003EFE E0FF                 		mov	#-1,r0
06003F00 2902                 		mov	r0,@r9
06003F02 2A02                 		mov	r0,@r10	
06003F04                           		
06003F04                      ; ----------------------------------
06003F04                      	
06003F04 D100                   		mov	#taskfor_slave,r1
06003F06                      @wait_slv:
06003F06 6012                  		mov	@r1,r0
06003F08 8800                  		cmp/eq	#0,r0
06003F0A 8BFC                  		bf	@wait_slv
06003F0C E001                    		mov	#1,r0
06003F0E 2102                    		mov	r0,@r1
06003F10                      		
06003F10 DC00                 		mov	#mstr_faces,r12
06003F12                      @next_draw:
06003F12 6BC6                       		mov	@r12+,r11
06003F14 E0FF                       		mov	#-1,r0
06003F16 3B00                       		cmp/eq	r0,r11
06003F18 8900                       		bt	@end_this
06003F1A                      
06003F1A 51B5                        		mov	@(faces_srcaddr,r11),r1
06003F1C 53B4                       		mov	@(faces_type,r11),r3
06003F1E 54B1                            	mov	@(face_tex,r11),r4
06003F20 55B3                            	mov	@(face_tex_width,r11),r5
06003F22 56B2                            	mov	@(face_tex_add,r11),r6
06003F24 7B18                       		add 	#face_points,r11
06003F26 62B3                       		mov	r11,r2
06003F28 E700                            	mov 	#0,r7
06003F2A                                 	
06003F2A BECA                             	bsr	Draw_Face
06003F2C 0009                             	nop
06003F2E AFF0                               	bra	@next_draw
06003F30 0009                             	nop
06003F32                                  	
06003F32                      @end_this:
06003F32 D100                   		mov	#taskfor_slave,r1
06003F34                      @wait_slvfinish:
06003F34 6012                   		mov	@r1,r0
06003F36 8800                   		cmp/eq	#0,r0
06003F38 8BFC                   		bf	@wait_slvfinish
06003F3A                      
06003F3A 4F26                  		mov.l	@r15+,pr
06003F3C 000B                   		rts
06003F3E 0009                  		nop
06003F40 0000 0000 0000    +   		lits
06003F74                       		cnop 0,4
06003F74                      
06003F74                      ; ----------------------------------------
06003F74                      ; Fix point for resize (X and Y)
06003F74                      ; 
06003F74                      ; Input:
06003F74                      ; r0 - tan
06003F74                      ; r5 - point
06003F74                      ;
06003F74                      ; Output:
06003F74                      ; r0 - resized point (realpoint+r0)
06003F74                      ; ----------------------------------------
06003F74                      
06003F74                      @mdl_setresize:
06003F74 6403                 		mov 	r0,r4
06003F76 E000                 		mov 	#0,r0
06003F78 85C2                  		mov.w	@(4,r12),r0
06003F7A 630F                  		exts.w	r0,r3
06003F7C 51E3                      		mov	@(model_z,r14),r1
06003F7E 331C                      		add 	r1,r3
06003F80                      
06003F80 6043                          	mov	r4,r0
06003F82 4511                   		cmp/pz	r5
06003F84 8B00                           	bf	@plus_2
06003F86 633B                  		neg 	r3,r3
06003F88                      @plus_2:
06003F88 D100                        		mov	#$7FF,r1
06003F8A 2019                   		and	r1,r0
06003F8C 4008                   		shll2 	r0
06003F8E D100                          	mov	#sin_table,r1 
06003F90 001E                          	mov	@(r0,r1),r0
06003F92 303D                    		dmuls	r3,r0
06003F94 001A                    		mov	macl,r0
06003F96 4029                   		shlr16	r0
06003F98 600F                   		exts	r0,r0
06003F9A                        		
06003F9A 4511                   		cmp/pz	r5
06003F9C 8B00                           	bf	@plus_3
06003F9E 600B                  		neg 	r0,r0
06003FA0                      @plus_3:
06003FA0 000B                   		rts
06003FA2 0009                  		nop
06003FA4 0000 0000 0000    +   		lits
06003FAC                       		cnop 0,4
06003FAC                      	
06003FAC                      ; ----------------------------------------
06003FAC                      ; Fix point for resize (X and Y)
06003FAC                      ; 
06003FAC                      ; Input:
06003FAC                      ; r0 - tan
06003FAC                      ; r5 - point
06003FAC                      ;
06003FAC                      ; Output:
06003FAC                      ; r0 - resized point (realpoint+r0)
06003FAC                      ; ----------------------------------------
06003FAC                      
06003FAC                      @mdl_setresize_alt:
06003FAC 6403                 		mov 	r0,r4
06003FAE E000                 		mov 	#0,r0
06003FB0 85C2                  		mov.w	@(4,r12),r0
06003FB2 630F                  		exts.w	r0,r3
06003FB4 51E3                      		mov	@(model_z,r14),r1
06003FB6 331C                      		add 	r1,r3
06003FB8                      
06003FB8 4301                      		shlr	r3
06003FBA 633F                      		exts	r3,r3
06003FBC 6043                          	mov	r4,r0
06003FBE 4511                   		cmp/pz	r5
06003FC0 8B00                           	bf	@plus_4
06003FC2 633B                  		neg 	r3,r3
06003FC4                      @plus_4:
06003FC4 D100                        		mov	#$7FF,r1
06003FC6 2019                   		and	r1,r0
06003FC8 4008                   		shll2 	r0
06003FCA D100                          	mov	#sin_table,r1 
06003FCC 001E                          	mov	@(r0,r1),r0
06003FCE 303D                    		dmuls	r3,r0
06003FD0 001A                    		mov	macl,r0
06003FD2 4029                   		shlr16	r0
06003FD4 600F                   		exts	r0,r0
06003FD6                        		
06003FD6 4511                   		cmp/pz	r5
06003FD8 8B00                           	bf	@plus_5
06003FDA 600B                  		neg 	r0,r0
06003FDC                      @plus_5:
06003FDC 000B                   		rts
06003FDE 0009                  		nop
06003FE0 0000 0000 0000    +   		lits
06003FE8                       		cnop 0,4
06003FE8                       		
06003FE8                      ; =================================================================
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; ; *** SLAVE SIDE ***
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; 
06003FE8                      ; Mars3D_Slave:
06003FE8                      ; 		mov.l	pr,@-r15
06003FE8                      ; 		
06003FE8                      ;  		mov	#taskfor_slave,r14
06003FE8                      ; 		mov	@r14,r0
06003FE8                      ; 		cmp/eq	#0,r0
06003FE8                      ; 		bt	@no_req
06003FE8                      ; 		
06003FE8                      ; 		shll2	r0
06003FE8                      ; 		mov.l	#@TRIDI_TASKS,r1
06003FE8                      ; 		add	r1,r0
06003FE8                      ; 		mov.l	@r0,r1
06003FE8                      ; 		mov.l	pr,@-r15
06003FE8                      ; 		jsr	@r1
06003FE8                      ; 		nop
06003FE8                      ; 		mov.l	@r15+,pr
06003FE8                      ; 		
06003FE8                      ;  		mov	#0,r0
06003FE8                      ;  		mov	r0,@r14
06003FE8                      ; @no_req:
06003FE8                      ; 		mov.l	@r15+,pr
06003FE8                      ; 		rts
06003FE8                      ; 		nop
06003FE8                      ; 
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; 
06003FE8                      ; @TRIDI_TASKS:
06003FE8                      ; 		dc.l 0
06003FE8                      ; 		dc.l @task_1
06003FE8                      ; 		dc.l @task_2
06003FE8                      ; 		
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; ; Task 1
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; 
06003FE8                      ; @task_1:
06003FE8                      ; 		mov.l	pr,@-r15
06003FE8                      ; 
06003FE8                      ;  		mov	#face_num_sl,r0
06003FE8                      ;  		mov	@r0,r13
06003FE8                      ;     		mov	@(faces_srcaddr,r13),r1
06003FE8                      ;      		mov	r13,r2
06003FE8                      ;       		add 	#face_points,r2
06003FE8                      ;     		mov	@(faces_type,r13),r3
06003FE8                      ;          	mov	@(face_tex,r13),r4
06003FE8                      ;          	mov	@(face_tex_width,r13),r5
06003FE8                      ;          	mov	@(face_tex_add,r13),r6
06003FE8                      ;           	bsr	Draw_Face
06003FE8                      ;           	nop
06003FE8                      ;           	
06003FE8                      ; 		mov.l	@r15+,pr
06003FE8                      ; 		rts
06003FE8                      ; 		nop
06003FE8                      ; 		
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; ; Task 2
06003FE8                      ; ; ----------------------------------------
06003FE8                      ; 
06003FE8                      ; @task_2:
06003FE8                      ; 		mov.l	pr,@-r15
06003FE8                      ; 		
06003FE8                      ; 		mov.l	@r15+,pr
06003FE8                      ; 		rts
06003FE8                      ; 		nop
06003FE8                      		
06003FE8                      ; =================================================================
06003FE8                      ; ----------------------------------------
06003FE8                      ; Init
06003FE8                      ; ----------------------------------------
06003FE8                      
06003FE8                      ; models_init:
06003FE8                      ; 		mov.l	pr,@-r15
06003FE8                      ;     		
06003FE8                      ; 		mov.l	@r15+,pr
06003FE8                      ;  		rts
06003FE8                      ; 		nop
06003FE8                      ; 		lits
06003FE8                      ; 		cnop 0,4
06003FE8                      		
06003FE8                      ; =================================================================
06003FE8                      ; ----------------------------------------
06003FE8                      ; Run
06003FE8                      ; ----------------------------------------
06003FE8                      
06003FE8                      models_run:
06003FE8 4F22                 		mov.l	pr,@-r15
06003FEA                          		
06003FEA                      ; -------------------------
06003FEA                      ; Draw models
06003FEA                      ; -------------------------
06003FEA                      
06003FEA DE00                  		mov.l	#models_buffer,r14
06003FEC E11F                    		mov	#numof_models-1,r1
06003FEE                      @next_model:
06003FEE 5DE0                 		mov.l	@(model_addr,r14),r13
06003FF0 4D15                  		cmp/pl	r13
06003FF2 8B00                  		bf	@no_model
06003FF4                      
06003FF4 2F16                    		mov.l	r1,@-r15
06003FF6 BEA9                  		bsr	mars3d_makemdl
06003FF8 0009                  		nop
06003FFA 61F6                     		mov.l	@r15+,r1
06003FFC                      @no_model:
06003FFC 7E20                       		add	#sizeof_model,r14
06003FFE 4110                    		dt	r1
06004000 8BF5                     		bf	@next_model
06004002                          		
06004002                      ; -------------------------
06004002                      
06004002 4F26                 		mov.l	@r15+,pr
06004004 000B                  		rts
06004006 0009                 		nop
06004008 0000 0000            		lits
0600400C                      		cnop 0,4	
0600400C                      		
0600400C                      ; =================================================================
0600400C                      ; =================================================================
0600400C                       		cnop 0,4
0600400C                       		
0600400C                      ; =================================================================
0600400C                      ; ------------------------------------------------
0600400C                      ; irq
0600400C                      ; 
0600400C                      ; r0-r9 only
0600400C                      ; ------------------------------------------------
0600400C                      
0600400C                      master_irq:
0600400C 2F06                 		mov.l	r0,@-r15
0600400E 2F16                 		mov.l	r1,@-r15
06004010 2F26                 		mov.l	r2,@-r15
06004012 2F36                 		mov.l	r3,@-r15
06004014 2F46                 		mov.l	r4,@-r15
06004016 2F56                 		mov.l	r5,@-r15
06004018 2F66                 		mov.l	r6,@-r15
0600401A 2F76                 		mov.l	r7,@-r15
0600401C 2F86                 		mov.l	r8,@-r15
0600401E 2F96                 		mov.l	r9,@-r15
06004020 4F12                 		mov.l	macl,@-r15
06004022 4F02                 		mov.l	mach,@-r15
06004024 4F22                 		sts.l	pr,@-r15
06004026                      		
06004026 0002                 		stc	sr,r0
06004028 4009                 		shlr2	r0
0600402A C93C                 		and	#$3C,r0
0600402C D100                 		mov.l	#@list,r1
0600402E 301C                 		add	r1,r0
06004030 6102                 		mov.l	@r0,r1
06004032 410B                 		jsr	@r1
06004034 0009                 		nop
06004036                      		
06004036 4F26                 		lds.l	@r15+,pr
06004038 4F06                 		mov.l	@r15+,mach
0600403A 4F16                 		mov.l	@r15+,macl
0600403C 69F6                 		mov.l	@r15+,r9
0600403E 68F6                 		mov.l	@r15+,r8
06004040 67F6                 		mov.l	@r15+,r7
06004042 66F6                 		mov.l	@r15+,r6
06004044 65F6                 		mov.l	@r15+,r5
06004046 64F6                 		mov.l	@r15+,r4
06004048 63F6                 		mov.l	@r15+,r3
0600404A 62F6                 		mov.l	@r15+,r2
0600404C 61F6                 		mov.l	@r15+,r1
0600404E 60F6                 		mov.l	@r15+,r0
06004050 002B                 		rte
06004052 0009                 		nop
06004054 0000 0000            		lits
06004058                      
06004058                      ; ------------------------------------------------
06004058                      ; irq list
06004058                      ; ------------------------------------------------
06004058                      
06004058                      		align	4
06004058                      @list:
06004058 0000 0000 0000    +  		dc.l @invalid_irq,@invalid_irq
06004060 0000 0000 0000    +  		dc.l @invalid_irq,@invalid_irq
06004068 0000 0000 0000    +  		dc.l @invalid_irq,@invalid_irq
06004070 0000 0000 0000    +  		dc.l @pwm_irq,@pwm_irq
06004078 0000 0000 0000    +  		dc.l @cmd_irq,@cmd_irq
06004080 0000 0000 0000    +  		dc.l @h_irq,@h_irq
06004088 0000 0000 0000    +  		dc.l @v_irq,@v_irq
06004090 0000 0000 0000    +  		dc.l @vres_irq,@vres_irq
06004098                      
06004098                      ; =================================================================
06004098                      ; ------------------------------------------------
06004098                      ; Unused
06004098                      ; ------------------------------------------------
06004098                      
06004098                      @invalid_irq:
06004098 000B                 		rts
0600409A 0009                 		nop
0600409C                      		cnop 0,4
0600409C                      		lits
0600409C                      
0600409C                      ; =================================================================
0600409C                      ; ------------------------------------------------
0600409C                      ; Master | PWM Interrupt
0600409C                      ; ------------------------------------------------
0600409C                      
0600409C                      @pwm_irq:
0600409C                      
0600409C                      ; ----------------------------------
0600409C                      ; Run PWM driver
0600409C                      ; ----------------------------------
0600409C                      
0600409C C51C                  		mov.w	@(monowidth,gbr),r0
0600409E 4019                  		shlr8	r0
060040A0 C880                 		tst	#$80,r0
060040A2 8B00                 		bf	@exit
060040A4                      
060040A4 4F22                 		mov.l	pr,@-r15
060040A6 D000                  		mov.l	#pwm_run,r0
060040A8 400B                 		jsr	@r0
060040AA 0009                  		nop
060040AC 4F26                   		mov.l	@r15+,pr
060040AE                      @exit:
060040AE                      
060040AE                      ; ----------------------------------
060040AE                      
060040AE E001                 		mov	#1,r0
060040B0 C10E                 		mov.w	r0,@(pwmintclr,gbr)
060040B2                      		
060040B2 000B                 		rts
060040B4 0009                 		nop
060040B6 0000                 		cnop 0,4
060040B8 0000 0000            		lits
060040BC                      
060040BC                      ; =================================================================
060040BC                      ; ------------------------------------------------
060040BC                      ; Master | CMD Interrupt
060040BC                      ; ------------------------------------------------
060040BC                      
060040BC                      @cmd_irq:	
060040BC E000                 		mov 	#0,r0
060040BE C420                 		mov.b	@(comm0,gbr),r0
060040C0 8800                 		cmp/eq	#0,r0
060040C2 8900                 		bt	@no_req
060040C4                      		
060040C4 4008                 		shll2	r0
060040C6 D100                 		mov.l	#master_requests,r1
060040C8 301C                 		add	r1,r0
060040CA 6102                 		mov.l	@r0,r1
060040CC 4F22                 		mov.l	pr,@-r15
060040CE 410B                 		jsr	@r1
060040D0 0009                 		nop
060040D2 4F26                 		mov.l	@r15+,pr
060040D4                      		
060040D4 E000                 		mov 	#0,r0
060040D6 C020                 		mov.b	r0,@(comm0,gbr)
060040D8                      @no_req:
060040D8                      		
060040D8                      ; ----------------------------------
060040D8                      
060040D8 E001                 		mov	#1,r0
060040DA C10D                 		mov.w	r0,@(cmdintclr,gbr)
060040DC 000B                 		rts
060040DE 0009                 		nop
060040E0                      		cnop 0,4
060040E0 0000 0000            		lits
060040E4                      
060040E4                      ; =================================================================
060040E4                      ; ------------------------------------------------
060040E4                      ; Master | VRES Interrupt
060040E4                      ; ------------------------------------------------
060040E4                      
060040E4                      @vres_irq:
060040E4 E001                 		mov	#1,r0
060040E6 C10A                 		mov.w	r0,@(vresintclr,gbr)
060040E8 000B                 		rts
060040EA 0009                 		nop
060040EC                      		cnop 0,4
060040EC                      		lits
060040EC                      
060040EC                      ; =================================================================
060040EC                      ; ------------------------------------------------
060040EC                      ; Master | HBlank
060040EC                      ; ------------------------------------------------
060040EC                      
060040EC                      @h_irq:
060040EC E001                 		mov	#1,r0
060040EE C10C                 		mov.w	r0,@(hintclr,gbr)
060040F0                      
060040F0                      ; ----------------------------------
060040F0                      
060040F0                      ;  		mov.l	#@values+4,r1
060040F0                      ;  		mov.l	@r1,r0
060040F0                      ;  		add.l	#1,r0
060040F0                      ;  		mov.l	r0,@r1
060040F0 000B                 		rts
060040F2 0009                 		nop
060040F4                      		cnop 0,4
060040F4                      		lits
060040F4                      
060040F4                      ; =================================================================
060040F4                      ; ------------------------------------------------
060040F4                      ; Master | VBlank
060040F4                      ; ------------------------------------------------
060040F4                      
060040F4                      @v_irq:
060040F4 E001                 		mov	#1,r0
060040F6 C10B                 		mov.w	r0,@(vintclr,gbr)
060040F8                      
060040F8                      ; ----------------------------------
060040F8                      ; Fade colors
060040F8                      ; ----------------------------------
060040F8                      
060040F8 4F22                 		mov.l	pr,@-r15
060040FA D000                  		mov.l	#pal_fade,r0
060040FC 400B                 		jsr	@r0
060040FE 0009                  		nop
06004100 4F26                   		mov.l	@r15+,pr
06004102                      
06004102                      ; ----------------------------------
06004102                      ; Copy colors
06004102                      ; ----------------------------------
06004102                      
06004102 E000                 		mov.l	#0,r0
06004104 C400                 		mov.b	@(adapter,gbr),r0
06004106 C980                 		and 	#FM,r0
06004108 C880                 		tst 	#FM,r0
0600410A 8900                 		bt	@genesis_side
0600410C                      		
0600410C E000                 		mov 	#0,r0
0600410E D100                 		mov 	#pal_buffer,r1
06004110 D200                 		mov	#_palette,r2
06004112 E310                 		mov 	#256/$10,r3
06004114                      ; 		mov 	#$8000,r4		;TEMPORAL
06004114                      @next:
06004114                      		rept $10
06004114                      		mov.w	@r1+,r0
06004114                      ; 		or	r4,r0			;TEMPORAL
06004114                      		mov.w	r0,@r2
06004114                      		add 	#2,r2
06004114 6015 2201 7202    +  		endr
06004174                      		
06004174 4310                 		dt 	r3
06004176 8BCD                 		bf	@next
06004178                      
06004178                      ; 		mov	#_palette,r2		;TEMPORAL
06004178                      ; 		mov	@r2,r0			;TEMPORAL
06004178                      ; 		mov	#$7FFF,r1		;TEMPORAL
06004178                      ; 		and	r1,r0			;TEMPORAL
06004178                      ; 		mov 	r0,@r2			;TEMPORAL
06004178                      		
06004178                      @genesis_side:
06004178 D100                  		mov.l	#vint_m_sync,r1
0600417A E000                  		mov.l	#0,r0
0600417C 2102                  		mov.l	r0,@r1
0600417E 000B                 		rts
06004180 0009                 		nop
06004182 0000                 		cnop 0,4
06004184 0000 0000 0000    +  		lits
06004194                      
06004194                      ; =================================================================
06004194                      		
06004194                      		objend
06004194                      		inform 0,"MARS SH2 MASTER SIZE: %h",*-SH2_Master;,(SlaveEntry-CS3)
06004194                      		cnop 0,(SlaveEntry-CS3)
06008000                      		
06008000                      ; =================================================================
06008000                      ; ------------------------------------------------
06008000                      ; Slave CPU
06008000                      ; ------------------------------------------------
06008000                      
06008000                      		obj SlaveEntry
06008000                      SH2_Slave:
06008000 0000 0000 0603    +  		dc.l @Entry,S_STACK		; Cold PC,SP
06008008 0000 0000 0603    +  		dc.l @Entry,S_STACK		; Manual PC,SP
06008010                      
06008010 0600 0408            		dc.l ErrorTrap			; Illegal instruction
06008014 0000 0000            		dc.l 0				; reserved
06008018 0600 0408            		dc.l ErrorTrap			; Invalid slot instruction
0600801C 2010 0400            		dc.l $20100400			; reserved
06008020 2010 0420            		dc.l $20100420			; reserved
06008024 0600 0408            		dc.l ErrorTrap			; CPU address error
06008028 0600 0408            		dc.l ErrorTrap			; DMA address error
0600802C 0600 0408            		dc.l ErrorTrap			; NMI vector
06008030 0600 0408            		dc.l ErrorTrap			; User break vector
06008034                      
06008034 0000 0000 0000    +  		dcb.l 19,0			; reserved
06008080                      
06008080 0600 0408 0600    +  		dcb.l 32,ErrorTrap		; Trap vectors
06008100                      
06008100 0000 0000             		dc.l slave_irq			; Level 1 IRQ
06008104 0000 0000            		dc.l slave_irq			; Level 2 & 3 IRQ's
06008108 0000 0000            		dc.l slave_irq			; Level 4 & 5 IRQ's
0600810C 0000 0000            		dc.l slave_irq			; PWM interupt
06008110 0000 0000            		dc.l slave_irq			; Command interupt
06008114 0000 0000            		dc.l slave_irq			; H Blank interupt
06008118 0000 0000            		dc.l slave_irq			; V Blank interupt
0600811C 0000 0000            		dc.l slave_irq			; Reset Button
06008120                      
06008120                      ; =================================================================
06008120                      ; ------------------------------------------------
06008120                      ; Slave entry
06008120                      ; ------------------------------------------------
06008120                      
06008120                      @Entry:
06008120 DE00                 		mov.l	#_sysreg,r14
06008122 4E1E                 		ldc	r14,gbr
06008124                      		
06008124                      @wait_md:
06008124 C608                 		mov.l	@(comm0,gbr),r0
06008126 8800                 		cmp/eq	#0,r0
06008128 8BFC                 		bf	@wait_md
0600812A                      	
0600812A D000                 		mov.l	#"SLAV",r0
0600812C C20A                 		mov.l	r0,@(comm8,gbr)
0600812E                      
0600812E                      ; =================================================================
0600812E                      ; ------------------------------------------------
0600812E                      ; Hotstart
0600812E                      ; ------------------------------------------------
0600812E                      
0600812E                      s_hotstart:	
0600812E DF00                 		mov.l	#S_STACK,r15
06008130                      
06008130 DE00                 		mov.l	#_sysreg,r14
06008132 4E1E                 		ldc	r14,gbr
06008134                      	
06008134 E002                  		mov	#CMDIRQ_ON,r0
06008136 C001                     		mov.b	r0,@(intmask,gbr)
06008138 E020                 		mov.l	#$20,r0
0600813A 400E                 		ldc	r0,sr
0600813C                       		
0600813C D000                  		mov.l	#slave_start,r0
0600813E 402B                 		jmp	@r0
06008140 0009                  		nop
06008144 0000 0000 0000    +  		lits
06008154                       
06008154                      ; =================================================================
06008154                      ; ------------------------------------------------
06008154                      ; Subs 
06008154                      ; ------------------------------------------------
06008154                      
06008154                       		include	"mars/sh2/subs/pwm.asm"
06008154                      ; ==================================================================
06008154                      ; ---------------------------------------------------
06008154                      ; PWM
06008154                      ; ---------------------------------------------------
06008154                      
06008154                      ; ---------------------------------------------------
06008154                      ; Variables
06008154                      ; ---------------------------------------------------
06008154                      
06008154                      		rsreset
06008154 =00000000            chn_read	rs.l 1
06008154 =00000004            chn_loop	rs.l 1			;-1 = dont loop
06008154 =00000008            chn_end		rs.l 1
06008154 =0000000C            chn_flags	rs.l 1
06008154 =00000010            chn_note	rs.l 1
06008154 =00000014            chn_pitch	rs.l 1
06008154 =00000018            chn_pan		rs.l 1			;%000000LR
06008154 =0000001C            chn_vol		rs.l 1
06008154 =00000020            chn_wav		rs.l 1
06008154 =00000024            chn_timer	rs.l 1
06008154 =00000028            chn_smplid	rs.l 1
06008154 =0000002C            sizeof_chn	rs.l 0
06008154                      
06008154                      		rsreset
06008154 =00000000            smpl_start	rs.l 1
06008154 =00000004            smpl_end	rs.l 1
06008154 =00000008            smpl_loop	rs.l 1
06008154 =0000000C            smpl_pitch	rs.l 1
06008154 =00000010            smpl_pan	rs.l 1
06008154 =00000014            smpl_vol	rs.l 1
06008154 =00000018            smpl_null	rs.l 1
06008154 =0000001C            sizeof_list	rs.l 0
06008154                      
06008154 =00000020            maxsmpl		equ	32
06008154 =00000008            maxchnls	equ	8
06008154                      
06008154                      ; chn_flags
06008154 =00000001            bitOn		equ	%00000001
06008154                      
06008154                      ; chn_pan
06008154 =00000002            bitLeft		equ	%00000010
06008154 =00000001            bitRight	equ	%00000001
06008154                      
06008154                      ; ---------------------------------------------------
06008154                      ; Data
06008154                      ; ---------------------------------------------------
06008154                      
06008154                      		cnop 0,4
06008154                      pitch_table:
06008154 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00 ; C-0 (NULL)
06008164 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008174                          		
06008174 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; C#0 (NULL)
06008184 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008194                          		
06008194 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D-0 (NULL)
060081A4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060081B4                      
060081B4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D#0 (NULL)
060081C4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060081D4                          		
060081D4 0000 0000 00FF    +             	dc.b $00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; E-0 (NULL)
060081E4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060081F4                          		
060081F4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F-0 (NULL)
06008204 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008214                          		
06008214 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F#0 (NULL)
06008224 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008234                          		
06008234 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G-0 (NULL)
06008244 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008254                          		
06008254 0000 0000 FF00    +             	dc.b $00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G#0 (NULL)
06008264 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008274                      		
06008274 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; A-0 (NULL)
06008284 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008294                          		
06008294 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; A#0 (NULL)
060082A4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060082B4                      
060082B4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; B-0 (NULL)
060082C4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060082D4                          		
060082D4                      ; ------------------------------
060082D4                      
060082D4 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00 ; C-1 (NULL)
060082E4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060082F4                          		
060082F4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; C#1 (NULL)
06008304 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008314                          		
06008314 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D-1 (NULL)
06008324 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008334                      
06008334 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D#1 (NULL)
06008344 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008354                          		
06008354 0000 0000 00FF    +             	dc.b $00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; E-1 (NULL)
06008364 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008374                          		
06008374 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F-1 (NULL)
06008384 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008394                          		
06008394 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F#1 (NULL)
060083A4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060083B4                          		
060083B4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G-1 (NULL)
060083C4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060083D4                          		
060083D4 0000 0000 FF00    +             	dc.b $00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G#1 (NULL)
060083E4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060083F4                      		
060083F4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; A-1 (NULL)
06008404 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008414                          		
06008414 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; A#1 (NULL)
06008424 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008434                      
06008434 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; B-1 (NULL)
06008444 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008454                          		
06008454                      ; ------------------------------
06008454                      
06008454 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00 ; C-2
06008464 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008474                          		
06008474 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00,$00,$FF,$00 ; C#2
06008484 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008494                          		
06008494 0000 0000 0000    +             	dc.b $00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D-2
060084A4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060084B4                      
060084B4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00,$FF,$00,$00,$00 ; D#2
060084C4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060084D4                          		
060084D4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00,$01,$00,$00,$00 ; E-2
060084E4 0000 FF00 0000    +      		dc.b $00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060084F4                          		
060084F4 0000 0000 00FF    +             	dc.b $00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F-2
06008504 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008514                          		
06008514 0000 0000 0001    +             	dc.b $00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00 ; F#2
06008524 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008534                          		
06008534 0000 0000 0001    +      		dc.b $00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$00,$00,$FF ; G-2
06008544 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008554                          		
06008554 0000 0000 FF00    +            	dc.b $00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G#2
06008564 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008574                      		
06008574 0000 0000 0100    +      		dc.b $00,$00,$00,$00,$01,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00 ; A-2
06008584 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008594                          		
06008594 0000 0001 0000    +      		dc.b $00,$00,$00,$01,$00,$00,$00,$01,$00,$00,$00,$00,$FF,$00,$00,$00 ; A#2
060085A4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060085B4                      
060085B4 0000 0001 0000    +      		dc.b $00,$00,$00,$01,$00,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$00 ; B-2
060085C4 FF00 0000 0000    +      		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060085D4                          		
060085D4                      ; ------------------------------
060085D4                      
060085D4 0000 00FF 0000    +             	dc.b $00,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; C-3	;4000
060085E4 0000 0000 0000    +      		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060085F4                       
060085F4 0000 0001 0000    +             	dc.b $00,$00,$00,$01,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$FF,$00 ; C#3
06008604 0000 0000 0000    +     		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008614                      		
06008614 0000 0001 0000    +             	dc.b $00,$00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$00,$00,$FF,$00,$00 ; D-3
06008624 0000 0000 0000    +     		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008634                        
06008634 0000 0001 0000    +             	dc.b $00,$00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$00,$00,$01,$00,$00 ; D#3
06008644 FF00 0000 0000    +     		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008654                        		
06008654 0000 0100 0001    +             	dc.b $00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$00,$01,$00 ; E-3
06008664 0000 FF00 0000    +     		dc.b $00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008674                       
06008674 0000 0100 00FF    +             	dc.b $00,$00,$01,$00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F-3
06008684 0000 0000 0000    +     		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008694                        		
06008694 0000 0100 0001    +               	dc.b $00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$FF,$00,$00 ; F#3
060086A4 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060086B4                        
060086B4 0000 0100 0001    +               	dc.b $00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$01,$00,$FF ; G-3
060086C4 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060086D4                        		
060086D4 0000 0100 0001    +               	dc.b $00,$00,$01,$00,$00,$01,$00,$00,$01,$00,$01,$00,$00,$01,$FF,$00 ; G#3
060086E4 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060086F4                      
060086F4 0000 0100 0100    +               	dc.b $00,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$00,$01 ; A-3
06008704 0000 FF00 0000    +  		dc.b $00,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008714                        		
06008714 0000 0100 0100    +               	dc.b $00,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$00,$01 ; A#3
06008724 0000 01FF 0000    +  		dc.b $00,$00,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008734                      
06008734 0000 0100 0100    +               	dc.b $00,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$00,$01 ; B-3
06008744 0100 0100 FF00    +  		dc.b $01,$00,$01,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008754                      
06008754                      ; ------------------------------
06008754                      
06008754 00FF 0000 0000    +          	dc.b $00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; C-4	;8000
06008764 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008774                         		
06008774 0100 0100 0100    +       		dc.b $01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$01,$00,$FF,$00,$00,$00 ; C#4
06008784 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008794                          		
06008794 0100 0100 0100    +       		dc.b $01,$00,$01,$00,$01,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D-4
060087A4 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060087B4                          		
060087B4 0100 0100 0100    +       		dc.b $01,$00,$01,$00,$01,$00,$01,$00,$01,$FF,$00,$00,$00,$00,$00,$00 ; D#4
060087C4 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060087D4                          		
060087D4 0100 0100 0100    +      		dc.b $01,$00,$01,$00,$01,$00,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00 ; E-4 
060087E4 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060087F4                          		
060087F4 0100 0100 01FF    +      		dc.b $01,$00,$01,$00,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F-4
06008804 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008814                          		
06008814 0100 0100 0101    +     		dc.b $01,$00,$01,$00,$01,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F#4
06008824 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008834                          		
06008834 0101 00FF 0000    +   		dc.b $01,$01,$00,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G-4
06008844 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008854                      
06008854 0100 0101 0101    +    		dc.b $01,$00,$01,$01,$01,$01,$00,$01,$01,$FF,$00,$00,$00,$00,$00,$00 ; G#4
06008864 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008874                          		
06008874 0100 0101 0101    +    		dc.b $01,$00,$01,$01,$01,$01,$00,$01,$01,$01,$01,$01,$FF,$00,$00,$00 ; A-4
06008884 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008894                          		
06008894 0101 0101 0101    +   		dc.b $01,$01,$01,$01,$01,$01,$01,$01,$00,$FF,$00,$00,$00,$00,$00,$00 ; A#4
060088A4 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060088B4                      
060088B4 0101 0101 0101    +   		dc.b $01,$01,$01,$01,$01,$01,$01,$01,$00,$01,$01,$01,$01,$01,$01,$01 ; B-4
060088C4 FF00 0000 0000    +       		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060088D4                          		
060088D4                      ; ------------------------------
060088D4                      
060088D4 FF00 0000 0000    +   		dc.b $FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; C-5	;16000
060088E4 0000 0000 0000    +       		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060088F4                      
060088F4 0201 0101 0101    +   		dc.b $02,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$FF ; C#5
06008904 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008914                           		
06008914 0201 0101 0101    +   		dc.b $02,$01,$01,$01,$01,$01,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00 ; D-5
06008924 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008934                           		
06008934 0201 0101 FF00    +   		dc.b $02,$01,$01,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; D#5
06008944 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008954                           		
06008954 0201 01FF 0000    +   		dc.b $02,$01,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; E-5 ???
06008964 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008974                      
06008974 0201 FF00 0000    +   		dc.b $02,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F-5
06008984 0000 0000 0000    +        		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008994                      
06008994 0202 0101 FF00    +   		dc.b $02,$02,$01,$01,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; F#5
060089A4 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060089B4                      
060089B4 02FF 0000 0000    +  		dc.b $02,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ; G-5
060089C4 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060089D4                      
060089D4 0201 0201 0202    +  		dc.b $02,$01,$02,$01,$02,$02,$01,$02,$02,$FF,$00,$00,$00,$00,$00,$00 ; G#5
060089E4 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
060089F4                             		
060089F4 0201 0201 0202    +  		dc.b $02,$01,$02,$01,$02,$02,$02,$02,$02,$01,$02,$02,$01,$02,$FF,$00 ; A-5
06008A04 0000 0000 0000    +  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008A14                      
06008A14 0201 0201 0202    +  		dc.b $02,$01,$02,$01,$02,$02,$02,$02,$02,$01,$02,$02,$01,$02,$02,$02 ; A#5
06008A24 0202 0202 FF00    +  		dc.b $02,$02,$02,$02,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008A34                      
06008A34 0202 0202 0202    +  		dc.b $02,$02,$02,$02,$02,$02,$01,$02,$02,$02,$02,$02,$02,$02,$02,$02 ; B-5
06008A44 0202 0202 FF00    +  		dc.b $02,$02,$02,$02,$FF,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
06008A54                              	
06008A54                      ; ------------------------------
06008A54                      
06008A54 0302 0202 0202    +  		dc.b $03,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02 ; C-6
06008A64 0202 0202 0202    +  		dc.b $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$FF
06008A74                      
06008A74 0302 0202 0203    +   		dc.b $03,$02,$02,$02,$02,$03,$02,$02,$02,$02,$03,$02,$02,$02,$03,$02 ; C#6
06008A84 0202 0203 0202    +  		dc.b $02,$02,$02,$03,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$FF
06008A94                           		
06008A94 0302 0202 0203    +   		dc.b $03,$02,$02,$02,$02,$03,$02,$02,$02,$02,$03,$02,$03,$02,$03,$02 ; D-6
06008AA4 0202 0203 0203    +  		dc.b $02,$02,$02,$03,$02,$03,$02,$02,$03,$02,$02,$02,$02,$03,$02,$FF
06008AB4                           		
06008AB4 0302 0203 0203    +   		dc.b $03,$02,$02,$03,$02,$03,$02,$03,$02,$02,$03,$02,$03,$02,$03,$02 ; D#6
06008AC4 0203 0203 0203    +  		dc.b $02,$03,$02,$03,$02,$03,$02,$02,$03,$02,$03,$02,$02,$03,$02,$FF
06008AD4                           		
06008AD4 0303 0203 0303    +   		dc.b $03,$03,$02,$03,$03,$03,$02,$03,$02,$02,$03,$02,$03,$02,$03,$02 ; E-6
06008AE4 0203 0203 0203    +  		dc.b $02,$03,$02,$03,$02,$03,$03,$03,$03,$02,$03,$02,$03,$03,$02,$FF
06008AF4                      
06008AF4 0303 0203 0303    +   		dc.b $03,$03,$02,$03,$03,$03,$03,$03,$02,$03,$03,$02,$03,$02,$03,$03 ; F-6
06008B04 0203 0203 0303    +  		dc.b $02,$03,$02,$03,$03,$03,$03,$03,$03,$02,$03,$02,$03,$03,$02,$FF
06008B14                      
06008B14 0303 0203 0303    +   		dc.b $03,$03,$02,$03,$03,$03,$03,$03,$02,$03,$03,$02,$03,$03,$03,$03 ; F#6
06008B24 0303 0303 0303    +  		dc.b $03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$FF
06008B34                      
06008B34 0403 0303 0303    +   		dc.b $04,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03 ; G-6
06008B44 0303 0303 0303    +  		dc.b $03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$FF
06008B54                      
06008B54 0403 0303 0403    +   		dc.b $04,$03,$03,$03,$04,$03,$03,$03,$03,$03,$04,$03,$03,$03,$04,$03 ; G#6
06008B64 0403 0304 0303    +  		dc.b $04,$03,$03,$04,$03,$03,$03,$04,$03,$03,$03,$03,$03,$04,$03,$FF
06008B74                             		
06008B74 0403 0304 0403    +   		dc.b $04,$03,$03,$04,$04,$03,$04,$03,$04,$03,$04,$03,$04,$03,$04,$03 ; A-6
06008B84 0403 0304 0303    +  		dc.b $04,$03,$03,$04,$03,$03,$03,$04,$03,$03,$04,$03,$03,$04,$03,$FF
06008B94                      
06008B94 0403 0304 0403    +   		dc.b $04,$03,$03,$04,$04,$03,$04,$04,$04,$03,$04,$03,$04,$04,$04,$03 ; A#6
06008BA4 0404 0304 0403    +  		dc.b $04,$04,$03,$04,$04,$03,$03,$04,$03,$04,$04,$03,$03,$04,$03,$FF
06008BB4                      
06008BB4 0403 0404 0404    +   		dc.b $04,$03,$04,$04,$04,$04,$04,$04,$04,$03,$04,$03,$04,$04,$04,$04 ; B-6
06008BC4 0404 0404 0404    +  		dc.b $04,$04,$04,$04,$04,$04,$04,$04,$03,$04,$04,$04,$04,$04,$03,$FF
06008BD4                      		
06008BD4                      ; ------------------------------
06008BD4                      
06008BD4 0505 0504 0404    +   		dc.b $05,$05,$05,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04 ; C-7
06008BE4 0404 0404 0404    +  		dc.b $04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$FF
06008BF4                      
06008BF4 0505 0504 0405    +   		dc.b $05,$05,$05,$04,$04,$05,$04,$04,$05,$04,$04,$05,$04,$04,$04,$05 ; C#7
06008C04 0404 0504 0405    +  		dc.b $04,$04,$05,$04,$04,$05,$04,$04,$04,$04,$04,$04,$04,$04,$04,$FF
06008C14                           		
06008C14 0505 0504 0505    +   		dc.b $05,$05,$05,$04,$05,$05,$04,$05,$05,$04,$05,$05,$04,$05,$04,$05 ; D-7
06008C24 0504 0504 0405    +  		dc.b $05,$04,$05,$04,$04,$05,$05,$04,$04,$05,$04,$04,$05,$04,$05,$FF
06008C34                           		
06008C34 0302 0203 0203    +   		dc.b $03,$02,$02,$03,$02,$03,$02,$03,$02,$02,$03,$02,$03,$02,$03,$02 ; D#7		;TODO: later
06008C44 0203 0203 0203    +  		dc.b $02,$03,$02,$03,$02,$03,$02,$02,$03,$02,$03,$02,$02,$03,$02,$FF
06008C54                           		
06008C54 0303 0203 0303    +   		dc.b $03,$03,$02,$03,$03,$03,$02,$03,$02,$02,$03,$02,$03,$02,$03,$02 ; E-7
06008C64 0203 0203 0203    +  		dc.b $02,$03,$02,$03,$02,$03,$03,$03,$03,$02,$03,$02,$03,$03,$02,$FF
06008C74                      
06008C74 0303 0203 0303    +   		dc.b $03,$03,$02,$03,$03,$03,$03,$03,$02,$03,$03,$02,$03,$02,$03,$03 ; F-7
06008C84 0203 0203 0303    +  		dc.b $02,$03,$02,$03,$03,$03,$03,$03,$03,$02,$03,$02,$03,$03,$02,$FF
06008C94                      
06008C94 0303 0203 0303    +   		dc.b $03,$03,$02,$03,$03,$03,$03,$03,$02,$03,$03,$02,$03,$03,$03,$03 ; F#7
06008CA4 0303 0303 0303    +  		dc.b $03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$FF
06008CB4                      
06008CB4 0403 0303 0303    +   		dc.b $04,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03 ; G-7
06008CC4 0303 0303 0303    +  		dc.b $03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$03,$FF
06008CD4                      
06008CD4 0403 0303 0403    +   		dc.b $04,$03,$03,$03,$04,$03,$03,$03,$03,$03,$04,$03,$03,$03,$04,$03 ; G#7
06008CE4 0403 0304 0303    +  		dc.b $04,$03,$03,$04,$03,$03,$03,$04,$03,$03,$03,$03,$03,$04,$03,$FF
06008CF4                             		
06008CF4 0403 0304 0403    +   		dc.b $04,$03,$03,$04,$04,$03,$04,$03,$04,$03,$04,$03,$04,$03,$04,$03 ; A-7
06008D04 0403 0304 0303    +  		dc.b $04,$03,$03,$04,$03,$03,$03,$04,$03,$03,$04,$03,$03,$04,$03,$FF
06008D14                      
06008D14 0403 0304 0403    +   		dc.b $04,$03,$03,$04,$04,$03,$04,$04,$04,$03,$04,$03,$04,$04,$04,$03 ; A#7
06008D24 0404 0304 0403    +  		dc.b $04,$04,$03,$04,$04,$03,$03,$04,$03,$04,$04,$03,$03,$04,$03,$FF
06008D34                      
06008D34 0403 0404 0404    +   		dc.b $04,$03,$04,$04,$04,$04,$04,$04,$04,$03,$04,$03,$04,$04,$04,$04 ; B-7
06008D44 0404 0404 0404    +  		dc.b $04,$04,$04,$04,$04,$04,$04,$04,$03,$04,$04,$04,$04,$04,$03,$FF
06008D54                      		cnop 0,4
06008D54                      		
06008D54                      ; ---------------------------------------------------
06008D54                      ; pwm_init
06008D54                      ;
06008D54                      ; Inits pwm, also turns ON the pwm interrupt
06008D54                      ;
06008D54                      ; Uses:
06008D54                      ; r0
06008D54                      ; ---------------------------------------------------
06008D54                      
06008D54                      pwm_init:		
06008D54 D000                 		mov.l	#((((23011361<<1)/16000+1)>>1)+1),r0
06008D56 C119                 		mov.w	r0,@(cycle,gbr)
06008D58 D000                 		mov.l	#$0105,r0
06008D5A C118                 		mov.w	r0,@(timerctl,gbr)
06008D5C                        		
06008D5C E001                 		mov	#1,r0
06008D5E C11C                 		mov.w	r0,@(monowidth,gbr)
06008D60 C11C                 		mov.w	r0,@(monowidth,gbr)
06008D62 C11C                 		mov.w	r0,@(monowidth,gbr)
06008D64                      		
06008D64 000B                 		rts
06008D66 0009                 		nop
06008D68                      		cnop 0,4
06008D68 0000 0000 0000    +  		lits
06008D70                      
06008D70                      ; ---------------------------------------------------
06008D70                      ; pwm_setentry
06008D70                      ;
06008D70                      ; Sets a new entry to the pwm list
06008D70                      ;
06008D70                      ; Input:
06008D70                      ; r1 - Start
06008D70                      ; r2 - End
06008D70                      ; r3 - Loop, -1 dont loop
06008D70                      ; r4 - Note transpose
06008D70                      ; r5 - Instrument slot
06008D70                      ; ---------------------------------------------------
06008D70                      
06008D70                      pwm_setentry:
06008D70 D800                  		mov.l	#pwm_samplelist,r8
06008D72 E01C                   		mov	#sizeof_list,r0
06008D74 205E                   		mulu	r5,r0
06008D76 001A                   		mov	macl,r0
06008D78 380C                   		add 	r0,r8
06008D7A                        
06008D7A 1810                  		mov.l	r1,(smpl_start,r8)
06008D7C 1821                  		mov.l	r2,(smpl_end,r8)
06008D7E 1832                  		mov.l	r3,(smpl_loop,r8)
06008D80 1843                  		mov.l	r4,(smpl_pitch,r8)
06008D82 000B                 		rts
06008D84 0009                 		nop
06008D86 0000                 		cnop 0,4
06008D88 0000 0000            		lits
06008D8C                      
06008D8C                      ; ---------------------------------------------------
06008D8C                      ; pwm_setsmpl
06008D8C                      ;
06008D8C                      ; Plays a Channel
06008D8C                      ;
06008D8C                      ; Input:
06008D8C                      ; r1 - Channel
06008D8C                      ; r2 - Sample to use
06008D8C                      ; ---------------------------------------------------
06008D8C                      
06008D8C                      pwm_setvol:
06008D8C D800                  		mov.l	#pwm_channels,r8
06008D8E E02C                   		mov	#sizeof_chn,r0
06008D90 201E                   		mulu	r1,r0
06008D92 001A                   		mov	macl,r0
06008D94 380C                   		add 	r0,r8
06008D96                        		
06008D96 1827                  		mov.l	r2,(chn_vol,r8)
06008D98 000B                 		rts
06008D9A 0009                 		nop
06008D9C                      		cnop 0,4
06008D9C 0000 0000            		lits
06008DA0                      		
06008DA0                      ; ---------------------------------------------------
06008DA0                      ; pwm_setsmpl
06008DA0                      ;
06008DA0                      ; Plays a Channel
06008DA0                      ;
06008DA0                      ; Input:
06008DA0                      ; r1 - Channel
06008DA0                      ; r2 - Sample to use
06008DA0                      ; ---------------------------------------------------
06008DA0                      
06008DA0                      pwm_setsmpl:
06008DA0 D700                  		mov.l	#pwm_samplelist,r7
06008DA2 E01C                   		mov	#sizeof_list,r0
06008DA4 202E                   		mulu	r2,r0
06008DA6 001A                   		mov	macl,r0
06008DA8 370C                   		add 	r0,r7
06008DAA D800                  		mov.l	#pwm_channels,r8
06008DAC E02C                   		mov	#sizeof_chn,r0
06008DAE 201E                   		mulu	r1,r0
06008DB0 001A                   		mov	macl,r0
06008DB2 380C                   		add 	r0,r8
06008DB4 182A                  		mov.l	r2,(chn_smplid,r8)
06008DB6                       		
06008DB6 E000                  		mov.l	#0,r0
06008DB8 1803                  		mov.l	r0,(chn_flags,r8)
06008DBA 1809                  		mov.l	r0,(chn_timer,r8)
06008DBC                       		
06008DBC 5070                  		mov.l	@(smpl_start,r7),r0
06008DBE 1800                  		mov.l	r0,@(chn_read,r8)
06008DC0 5071                  		mov.l	@(smpl_end,r7),r0
06008DC2 1802                  		mov.l	r0,@(chn_end,r8)		
06008DC4 5072                  		mov.l	@(smpl_loop,r7),r0
06008DC6 1801                  		mov.l	r0,@(chn_loop,r8)
06008DC8 5073                   		mov.l	@(smpl_pitch,r7),r0
06008DCA 1805                   		mov.l	r0,@(chn_pitch,r8)
06008DCC 000B                 		rts
06008DCE 0009                 		nop
06008DD0                      		cnop 0,4
06008DD0 0000 0000 0000    +  		lits
06008DD8                        		
06008DD8                      ; ---------------------------------------------------
06008DD8                      ; pwm_play
06008DD8                      ;
06008DD8                      ; Plays a Channel
06008DD8                      ;
06008DD8                      ; Input:
06008DD8                      ; r1 - Channel
06008DD8                      ; r2 - Note
06008DD8                      ; r3 - Panning
06008DD8                      ; ---------------------------------------------------
06008DD8                      
06008DD8                      pwm_play:
06008DD8 D800                  		mov.l	#pwm_channels,r8
06008DDA E02C                   		mov	#sizeof_chn,r0
06008DDC 201E                   		mulu	r1,r0
06008DDE 001A                   		mov	macl,r0
06008DE0 380C                   		add 	r0,r8
06008DE2 1824                  		mov.l	r2,(chn_note,r8)
06008DE4 1836                   		mov.l	r3,(chn_pan,r8)
06008DE6                      
06008DE6 528A                   		mov.l	@(chn_smplid,r8),r2
06008DE8 D700                  		mov.l	#pwm_samplelist,r7
06008DEA E01C                   		mov	#sizeof_list,r0
06008DEC 202E                   		mulu	r2,r0
06008DEE 001A                   		mov	macl,r0
06008DF0 370C                   		add 	r0,r7
06008DF2 5070                  		mov.l	@(smpl_start,r7),r0
06008DF4 1800                  		mov.l	r0,@(chn_read,r8)
06008DF6 5071                  		mov.l	@(smpl_end,r7),r0
06008DF8 1802                  		mov.l	r0,@(chn_end,r8)		
06008DFA 5072                  		mov.l	@(smpl_loop,r7),r0
06008DFC 1801                  		mov.l	r0,@(chn_loop,r8)
06008DFE 5073                   		mov.l	@(smpl_pitch,r7),r0
06008E00 1805                   		mov.l	r0,@(chn_pitch,r8)
06008E02                      
06008E02 E000                  		mov.l	#0,r0
06008E04 1809                  		mov.l	r0,(chn_timer,r8)
06008E06 E001                  		mov.l	#1,r0
06008E08 1803                  		mov.l	r0,(chn_flags,r8)
06008E0A 000B                 		rts
06008E0C 0009                 		nop
06008E0E 0000                 		cnop 0,4
06008E10 0000 0000 0000    +  		lits
06008E18                      		
06008E18                      ; ---------------------------------------------------
06008E18                      ; pwm_stop
06008E18                      ;
06008E18                      ; Stop a Channel
06008E18                      ;
06008E18                      ; Input:
06008E18                      ; r1 - Channel
06008E18                      ; ---------------------------------------------------
06008E18                      
06008E18                      pwm_stop:
06008E18 D800                  		mov.l	#pwm_channels,r8
06008E1A E02C                   		mov	#sizeof_chn,r0
06008E1C 201E                   		mulu	r1,r0
06008E1E 001A                   		mov	macl,r0
06008E20 380C                   		add 	r0,r8
06008E22                      
06008E22 E000                  		mov.l	#0,r0
06008E24 1809                  		mov.l	r0,(chn_timer,r8)
06008E26 1803                  		mov.l	r0,(chn_flags,r8)
06008E28 000B                 		rts
06008E2A 0009                 		nop
06008E2C                      		cnop 0,4
06008E2C 0000 0000            		lits
06008E30                      		
06008E30                      ; ---------------------------------------------------
06008E30                      ; pwm_run
06008E30                      ;
06008E30                      ; Reads pwm
06008E30                      ;
06008E30                      ; Uses:
06008E30                      ; r0-r8
06008E30                      ; ---------------------------------------------------
06008E30                      
06008E30                      pwm_run:
06008E30 D800                  		mov.l	#pwm_channels,r8
06008E32 E708                  		mov.l	#maxchnls,r7
06008E34                       		
06008E34                      @next:
06008E34 E07F                 		mov.l	#$7F,r0
06008E36 1808                  		mov.l	r0,@(chn_wav,r8)
06008E38 5083                  		mov.l	@(chn_flags,r8),r0
06008E3A 8800                  		cmp/eq	#0,r0
06008E3C 8900                  		bt	@off
06008E3E                       		
06008E3E 5180                  		mov.l	@(chn_read,r8),r1
06008E40 6010                  		mov.b	@r1,r0
06008E42 C9FF                      		and	#$FF,r0
06008E44 6203                       		mov	r0,r2
06008E46                      
06008E46 5387                 		mov	@(chn_vol,r8),r3
06008E48                      ; 		mov	#0,r4
06008E48                      ; 		cmp/eq	r4,r3
06008E48                      ; 		bt 	@ignore_vol
06008E48 223E                  		mulu	r3,r2
06008E4A 021A                 		mov	macl,r2
06008E4C 4209                 		shlr2	r2
06008E4E 4209                 		shlr2	r2
06008E50 3028                       		sub 	r2,r0
06008E52 4015                       		cmp/pl	r0
06008E54 8B00                       		bf	@zero
06008E56                            		
06008E56 C9FF                       		and	#$FF,r0
06008E58 A000                      		bra	@ignore_vol
06008E5A 0009                      		nop
06008E5C                      @zero:
06008E5C E000                      		mov	#0,r0
06008E5E A000                      		bra	@ignore_vol
06008E60 0009                      		nop
06008E62                           		
06008E62 E200                       		mov 	#0,r2
06008E64 6203                       		mov 	r0,r2
06008E66 4209                       		shlr2	r2
06008E68 4201                       		shlr 	r2
06008E6A 5387                       		mov	@(chn_vol,r8),r3
06008E6C 223E                       		mulu 	r3,r2
06008E6E 021A                       		mov 	macl,r2
06008E70 3028                       		sub 	r2,r0
06008E72 C9FF                       		and	#$FF,r0
06008E74                          		
06008E74 C880                     		tst	#$80,r0
06008E76 8B00                      		bf	@pwm_1
06008E78 D200                      		mov.l	#$80,r2
06008E7A 3208                      		sub	r0,r2
06008E7C 5087                       		mov.l	@(chn_vol,r8),r0
06008E7E 220E                      		mulu	r0,r2
06008E80 001A                      		sts	macl,r0
06008E82 D200                      		mov.l	#$80,r2
06008E84 3208                      		sub	r0,r2
06008E86 6023                      		mov	r2,r0
06008E88 A000                      		bra	@pwm_2
06008E8A 0009                     		nop
06008E8C                      @pwm_1:
06008E8C D200                      		mov.l	#$80,r2
06008E8E 3028                      		sub	r2,r0
06008E90 5287                       		mov.l	@(chn_vol,r8),r2
06008E92 220E                      		mulu	r0,r2
06008E94 001A                      		sts	macl,r0
06008E96 D200                      		mov.l	#$80,r2
06008E98 302C                      		add	r2,r0
06008E9A                      @pwm_2:
06008E9A 8800                      		cmp/eq	#0,r0
06008E9C 8B00                      		bf	@pwm_3
06008E9E 7001                     		add	#1,r0
06008EA0                      @pwm_3:
06008EA0                      
06008EA0                      @ignore_vol:
06008EA0 1808                    		mov.l	r0,@(chn_wav,r8)
06008EA2                      
06008EA2 D300                   		mov.l	#pitch_table,r3
06008EA4 5084                   		mov.l	@(chn_note,r8),r0
06008EA6 5485                     		mov.l	@(chn_pitch,r8),r4
06008EA8 304C                     		add	r4,r0
06008EAA 4008                   		shll2	r0
06008EAC 4008                   		shll2	r0
06008EAE 4000                   		shll	r0			;list size: $20
06008EB0 330C                   		add 	r0,r3
06008EB2 5289                   		mov.l	@(chn_timer,r8),r2
06008EB4 332C                     		add	r2,r3
06008EB6 E000                  		mov.l	#0,r0
06008EB8 6030                   		mov.b	@r3,r0
06008EBA 7201                   		add	#1,r2
06008EBC 88FF                  		cmp/eq	#$FF,r0
06008EBE 8B00                   		bf	@true
06008EC0 E001                  		mov	#1,r0
06008EC2 E200                   		mov	#0,r2
06008EC4                      @true:
06008EC4 1829                  		mov.l	r2,@(chn_timer,r8)
06008EC6 310C                  		add.l	r0,r1
06008EC8                       		
06008EC8 5282                  		mov.l	@(chn_end,r8),r2
06008ECA 3123                  		cmp/ge	r2,r1
06008ECC 8B00                  		bf	@keep
06008ECE                      		
06008ECE E3FF                  		mov.l	#-1,r3
06008ED0 5181                    		mov.l	@(chn_loop,r8),r1
06008ED2 3130                    		cmp/eq	r3,r1
06008ED4 8B00                    		bf	@keep
06008ED6 E07F                  		mov.l	#$7F,r0
06008ED8 1808                   		mov.l	r0,@(chn_wav,r8)
06008EDA E000                  		mov.l	#0,r0
06008EDC 1803                   		mov.l	r0,@(chn_flags,r8)
06008EDE                      	
06008EDE                      @keep:
06008EDE 1810                  		mov.l	r1,@(chn_read,r8)
06008EE0                       		
06008EE0                      @off:
06008EE0 782C                 		add	#sizeof_chn,r8
06008EE2 4710                  		dt	r7
06008EE4 8BA6                  		bf	@next
06008EE6                      
06008EE6                      ; ----------------------------------
06008EE6                      ; Send WAV to PWM
06008EE6                      ; ----------------------------------
06008EE6                       
06008EE6 D800                  		mov.l	#pwm_channels,r8
06008EE8 E708                   		mov.l	#maxchnls,r7
06008EEA E500                   		mov.l	#0,r5
06008EEC E600                   		mov.l	#0,r6
06008EEE                      @next_wav:
06008EEE 5188                  		mov.l	@(chn_wav,r8),r1
06008EF0 5086                  		mov.l	@(chn_pan,r8),r0
06008EF2 C801                  		tst	#bitRight,r0
06008EF4 8900                  		bt	@not_l
06008EF6 361C                  		add	r1,r6
06008EF8                      @not_l:
06008EF8 C802                  		tst	#bitLeft,r0
06008EFA 8900                  		bt	@off_wav
06008EFC 351C                  		add	r1,r5
06008EFE                      @off_wav:
06008EFE 782C                   		add.l	#sizeof_chn,r8
06008F00 4710                  		dt	r7
06008F02 8BF4                  		bf	@next_wav
06008F04                       		
06008F04                      ; ----------------------------------
06008F04                       
06008F04                      @tryagain:
06008F04 6053                  		mov.l	r5,r0
06008F06 C11A                  		mov.w	r0,@(lchwidth,gbr)
06008F08 6063                  		mov.l	r6,r0
06008F0A C11B                  		mov.w	r0,@(rchwidth,gbr)
06008F0C                       		
06008F0C C51C                   		mov.w	@(monowidth,gbr),r0
06008F0E 4019                   		shlr8	r0
06008F10 C880                  		tst	#$80,r0
06008F12 89F7                  		bt	@tryagain
06008F14                      	
06008F14 000B                 		rts
06008F16 0009                 		nop
06008F18                      		cnop 0,4
06008F18 0000 0000 0000    +  		lits
06008F18 0000 0000 0000    +  		lits
06008F24                       		cnop 0,4
06008F24                       		
06008F24                      ; ==================================================================
06008F24                      ; ---------------------------------------------------
06008F24                      ; Start
06008F24                      ; ---------------------------------------------------
06008F24                      
06008F24                      slave_start:
06008F24                      ;        	mov	#$2033000,r1
06008F24                      ;           	mov	#$21ED4DC,r2
06008F24                      ;        	mov	r1,r3
06008F24                      ;        	mov	#0,r4
06008F24                      ;        	mov	#0,r5
06008F24                      ;        	bsr	pwm_setentry
06008F24                      ;        	nop
06008F24                      ;       	mov.l	#$21ED4DC,r1
06008F24                      ;        	mov.l	#$23A79B7,r2
06008F24                      ;        	mov	r1,r3
06008F24                      ;        	mov	#0,r4
06008F24                      ;        	mov	#1,r5
06008F24                      ;        	bsr	pwm_setentry
06008F24                      ;        	nop
06008F24                      ; 		mov	#0,r1
06008F24                      ; 		mov	#$3C,r2
06008F24                      ; 		mov	#2,r3
06008F24                      ; 		bsr	pwm_play
06008F24                      ; 		nop
06008F24                      ; 		mov	#1,r1
06008F24                      ; 		mov	#$3C,r2
06008F24                      ; 		mov	#1,r3
06008F24                      ; 		bsr	pwm_play
06008F24                      ; 		nop
06008F24                      		
06008F24                      ; =================================================================
06008F24                      ; ---------------------------------------------------
06008F24                      ; Slave loop
06008F24                      ; ---------------------------------------------------
06008F24                      
06008F24                      slave_loop:
06008F24 DE00                  		mov	#taskfor_slave,r14
06008F26 60E2                 		mov	@r14,r0
06008F28 8800                 		cmp/eq	#0,r0
06008F2A 8900                 		bt	@no_req
06008F2C                      		
06008F2C 4008                 		shll2	r0
06008F2E D100                 		mov.l	#@TRIDI_TASKS,r1
06008F30 301C                 		add	r1,r0
06008F32 6102                 		mov.l	@r0,r1
06008F34 4F22                 		mov.l	pr,@-r15
06008F36 410B                 		jsr	@r1
06008F38 0009                 		nop
06008F3A 4F26                 		mov.l	@r15+,pr
06008F3C                      		
06008F3C E000                  		mov	#0,r0
06008F3E 2E02                  		mov	r0,@r14
06008F40                      @no_req:
06008F40 AFF0                 		bra	slave_loop
06008F42 0009                 		nop
06008F44                      
06008F44                      ; ----------------------------------------
06008F44                      
06008F44                      @TRIDI_TASKS:
06008F44 0000 0000            		dc.l 0
06008F48 0000 0000            		dc.l @task_1
06008F4C 0000 0000            		dc.l @task_2
06008F50                      
06008F50                      ; ----------------------------------------
06008F50                      ; Task 1
06008F50                      ; ----------------------------------------
06008F50                      
06008F50                      @task_1:
06008F50 4F22                 		mov.l	pr,@-r15
06008F52                      		
06008F52 DC00                 		mov	#slve_faces,r12
06008F54                      @next_draw:
06008F54 6BC6                       		mov	@r12+,r11
06008F56 E0FF                       		mov	#-1,r0
06008F58 3B00                       		cmp/eq	r0,r11
06008F5A 8900                       		bt	@end_this
06008F5C                            		
06008F5C 51B5                        		mov	@(faces_srcaddr,r11),r1
06008F5E 53B4                       		mov	@(faces_type,r11),r3
06008F60 54B1                            	mov	@(face_tex,r11),r4
06008F62 55B3                            	mov	@(face_tex_width,r11),r5
06008F64 56B2                            	mov	@(face_tex_add,r11),r6
06008F66 7B18                       		add 	#face_points,r11
06008F68 62B3                       		mov	r11,r2
06008F6A E700                            	mov 	#0,r7
06008F6C D000                             	mov 	#Draw_Face_Slave,r0
06008F6E 400B                             	jsr	@r0
06008F70 0009                             	nop
06008F72 AFEF                               	bra	@next_draw
06008F74 0009                             	nop
06008F76                                  	
06008F76                      @end_this:
06008F76                      
06008F76 4F26                 		mov.l	@r15+,pr
06008F78 000B                 		rts
06008F7A 0009                 		nop
06008F7C                      
06008F7C                      ; ----------------------------------------
06008F7C                      ; Task 2
06008F7C                      ; ----------------------------------------
06008F7C                      
06008F7C                      @task_2:
06008F7C 4F22                 		mov.l	pr,@-r15
06008F7E                      
06008F7E D700                    		mov	#taskarg_slave,r7
06008F80 6D72                            	mov	@r7,r13
06008F82 51D5                       		mov	@(faces_srcaddr,r13),r1
06008F84 62D3                       		mov	r13,r2
06008F86 7218                       		add 	#face_points,r2
06008F88 53D4                       		mov	@(faces_type,r13),r3
06008F8A 54D1                            	mov	@(face_tex,r13),r4
06008F8C 55D3                            	mov	@(face_tex_width,r13),r5
06008F8E D000                            	mov 	#Draw_Face_Slave,r0
06008F90 400B                            	jsr	@r0
06008F92 56D2                            	mov	@(face_tex_add,r13),r6
06008F94                                 	
06008F94 4F26                 		mov.l	@r15+,pr
06008F96 000B                 		rts
06008F98 0009                 		nop
06008F9A                      
06008F9A                      ; =================================================================
06008F9A                      ; -------------------------
06008F9A                      ; Slave CMD requests
06008F9A                      ; -------------------------
06008F9A                      
06008F9A 0000                 		cnop 0,4
06008F9C                      slave_requests:
06008F9C 0000 0000            		dc.l 0
06008FA0 0000 0000            		dc.l @cmd_1			; Play
06008FA4 0000 0000            		dc.l @cmd_2			; Stop
06008FA8 0000 0000            		dc.l @cmd_3			; Set channel sample
06008FAC 0000 0000            		dc.l @cmd_4			; Set channel volume
06008FB0 0000 0000            		dc.l @cmd_5			; Set sample to the list
06008FB4 0000 0000            		dc.l @cmd_0
06008FB8 0000 0000            		dc.l @cmd_0
06008FBC 0000 0000            		dc.l @cmd_0
06008FC0 0000 0000            		dc.l @cmd_0
06008FC4 0000 0000            		dc.l @cmd_0
06008FC8 0000 0000            		dc.l @cmd_0
06008FCC 0000 0000            		dc.l @cmd_0
06008FD0 0000 0000            		dc.l @cmd_0
06008FD4 0000 0000            		dc.l @cmd_0
06008FD8 0000 0000            		dc.l @cmd_0
06008FDC                      		
06008FDC                      ; ------------------------------------------------
06008FDC                      ; command ??
06008FDC                      ;
06008FDC                      ; nothing
06008FDC                      ; ------------------------------------------------
06008FDC                      
06008FDC                      @cmd_0:
06008FDC 000B                 		rts
06008FDE 0009                 		nop
06008FE0                      
06008FE0                      ; ------------------------------------------------
06008FE0                      ; command 01
06008FE0                      ;
06008FE0                      ; play sample + set pan
06008FE0                      ;
06008FE0                      ; comm2:
06008FE0                      ; $xx00 | pan+channel %LRCCCCCC
06008FE0                      ; $00xx | note
06008FE0                      ; ------------------------------------------------
06008FE0                      
06008FE0                      @cmd_1:
06008FE0 4F22                 		mov.l	pr,@-r15
06008FE2                       		
06008FE2 C511                 		mov.w	@(comm2,gbr),r0		;$00xx
06008FE4 C9FF                 		and	#$FF,r0
06008FE6 6203                       		mov	r0,r2
06008FE8 C511                 		mov.w	@(comm2,gbr),r0		;$xx00
06008FEA 4019                 		shlr8	r0
06008FEC 6303                 		mov	r0,r3
06008FEE 4309                 		shlr2 	r3
06008FF0 4309                 		shlr2 	r3
06008FF2 4309                 		shlr2 	r3
06008FF4 600D                 		extu	r0,r0
06008FF6 C93F                 		and	#%00111111,r0
06008FF8 6103                       		mov	r0,r1
06008FFA                            		
06008FFA BEED                            	bsr	pwm_play
06008FFC 0009                           	nop
06008FFE                                	
06008FFE 4F26                 		mov.l	@r15+,pr
06009000 000B                 		rts
06009002 0009                 		nop
06009004                      
06009004                      ; ------------------------------------------------
06009004                      ; command 02
06009004                      ;
06009004                      ; stop
06009004                      ; 
06009004                      ; Input:
06009004                      ; comm14 - channel
06009004                      ; ------------------------------------------------
06009004                      
06009004                      @cmd_2:
06009004 4F22                 		mov.l	pr,@-r15
06009006                       		
06009006 E000                   		mov.l	#0,r0
06009008 C422                 		mov.b	@(comm2,gbr),r0
0600900A C9FF                 		and	#$FF,r0
0600900C 6103                 		mov	r0,r1
0600900E BF03                    		bsr	pwm_stop
06009010 0009                    		nop
06009012                        		
06009012 4F26                 		mov.l	@r15+,pr
06009014 000B                 		rts
06009016 0009                 		nop
06009018                      		
06009018                      ; ------------------------------------------------
06009018                      ; command 03
06009018                      ;
06009018                      ; comm2:
06009018                      ; $xx00 | channel
06009018                      ; $00xx | sample
06009018                      ; ------------------------------------------------
06009018                      
06009018                      @cmd_3:
06009018 4F22                 		mov.l	pr,@-r15
0600901A                      
0600901A C511                 		mov.w	@(comm2,gbr),r0		;$00xx
0600901C C9FF                 		and	#$FF,r0
0600901E 6203                       		mov	r0,r2
06009020 C511                 		mov.w	@(comm2,gbr),r0		;$xx00
06009022 4019                 		shlr8	r0
06009024 C9FF                 		and	#$FF,r0
06009026 6103                       		mov	r0,r1
06009028 BEBA                       		bsr	pwm_setsmpl
0600902A 0009                       		nop
0600902C                               	
0600902C 4F26                 		mov.l	@r15+,pr
0600902E 000B                 		rts
06009030 0009                 		nop
06009032                      		
06009032                      ; ------------------------------------------------
06009032                      ; command 04
06009032                      ;
06009032                      ; comm2:
06009032                      ; $xx00 | channel
06009032                      ; $00xx | volume
06009032                      ; ------------------------------------------------
06009032                      
06009032                      @cmd_4:
06009032 4F22                 		mov.l	pr,@-r15
06009034                      
06009034 C511                 		mov.w	@(comm2,gbr),r0		;$00xx
06009036 C9FF                 		and	#$FF,r0
06009038 6203                       		mov	r0,r2
0600903A C511                 		mov.w	@(comm2,gbr),r0		;$xx00
0600903C 4019                 		shlr8	r0
0600903E C9FF                 		and	#$FF,r0
06009040 6103                       		mov	r0,r1
06009042 BEA3                       		bsr	pwm_setvol
06009044 0009                       		nop
06009046                      
06009046 4F26                   		mov.l	@r15+,pr
06009048 000B                 		rts
0600904A 0009                 		nop
0600904C                      		
0600904C                      ; ------------------------------------------------
0600904C                      ; command 05
0600904C                      ;
0600904C                      ; set
0600904C                      ;
0600904C                      ; Input:
0600904C                      ; comm12 | LONG - ROM address Start/End
0600904C                      ; comm10 | WORD - Loop point (-1 = dont loop)
0600904C                      ;  comm2 | WORD - slot | note transpose
0600904C                      ; ------------------------------------------------
0600904C                      
0600904C                      @cmd_5:
0600904C 4F22                 		mov.l	pr,@-r15
0600904E E000                   		mov.l	#0,r0
06009050 C60B                 		mov.l	@(comm12,gbr),r0
06009052 6206                       		mov.l	@r0+,r2			;End
06009054 6103                       		mov.l	r0,r1			;Start
06009056 E000                   		mov.l	#0,r0
06009058 C515                 		mov.w	@(comm10,gbr),r0	;Loop (-1 dont loop)
0600905A E3FF                 		mov.l	#$FFFFFFFF,r3
0600905C 3030                 		cmp/eq	r3,r0
0600905E 8900                 		bt	@true
06009060 600D                 		extu	r0,r0
06009062 6313                 		mov.l	r1,r3
06009064 330C                 		add	r0,r3
06009066                      @true:
06009066 C423                 		mov.b	@(comm2+1,gbr),r0	;$00xx
06009068 600F                 		exts	r0,r0
0600906A 6403                       		mov	r0,r4
0600906C C422                 		mov.b	@(comm2,gbr),r0		;$xx00
0600906E C9FF                 		and	#$FF,r0
06009070 6503                       		mov	r0,r5
06009072 BE7D                       		bsr	pwm_setentry
06009074 0009                      		nop	
06009076                            		
06009076 4F26                   		mov.l	@r15+,pr
06009078 000B                 		rts
0600907A 0009                 		nop
0600907C                       		
0600907C                      ; =================================================================
0600907C                      ; ------------------------------------------------
0600907C                      ; irq
0600907C                      ; 
0600907C                      ; r0-r9 only
0600907C                      ; ------------------------------------------------
0600907C                      
0600907C                      slave_irq:
0600907C 2F06                 		mov.l	r0,@-r15
0600907E 2F16                 		mov.l	r1,@-r15
06009080 2F26                 		mov.l	r2,@-r15
06009082 2F36                 		mov.l	r3,@-r15
06009084 2F46                 		mov.l	r4,@-r15
06009086 2F56                 		mov.l	r5,@-r15
06009088 2F66                 		mov.l	r6,@-r15
0600908A 2F76                 		mov.l	r7,@-r15
0600908C 2F86                 		mov.l	r8,@-r15
0600908E 2F96                 		mov.l	r9,@-r15
06009090 4F12                 		mov.l	macl,@-r15
06009092 4F02                 		mov.l	mach,@-r15
06009094 4F22                 		sts.l	pr,@-r15
06009096                      
06009096 0002                 		stc	sr,r0
06009098 4009                 		shlr2	r0
0600909A C93C                 		and	#$3C,r0
0600909C D100                 		mov.l	#@inttable,r1
0600909E 301C                 		add	r1,r0
060090A0 6102                 		mov.l	@r0,r1
060090A2 410B                 		jsr	@r1
060090A4 0009                 		nop
060090A6                      
060090A6 4F26                 		lds.l	@r15+,pr
060090A8 4F06                 		mov.l	@r15+,mach
060090AA 4F16                 		mov.l	@r15+,macl
060090AC 69F6                 		mov.l	@r15+,r9
060090AE 68F6                 		mov.l	@r15+,r8
060090B0 67F6                 		mov.l	@r15+,r7
060090B2 66F6                 		mov.l	@r15+,r6
060090B4 65F6                 		mov.l	@r15+,r5
060090B6 64F6                 		mov.l	@r15+,r4
060090B8 63F6                 		mov.l	@r15+,r3
060090BA 62F6                 		mov.l	@r15+,r2
060090BC 61F6                 		mov.l	@r15+,r1
060090BE 60F6                 		mov.l	@r15+,r0
060090C0                      	
060090C0 002B                 		rte
060090C2 0009                 		nop
060090C4 0000 0000 0000    +  		lits
060090DC                      
060090DC                      ; ------------------------------------------------
060090DC                      ; irq list
060090DC                      ; ------------------------------------------------
060090DC                      
060090DC                      		align	4
060090DC                      @inttable:
060090DC 0000 0000 0000    +  		dc.l @invalid_irq,@invalid_irq
060090E4 0000 0000 0000    +  		dc.l @invalid_irq,@invalid_irq
060090EC 0000 0000 0000    +  		dc.l @invalid_irq,@invalid_irq
060090F4 0000 0000 0000    +  		dc.l @pwm_irq,@pwm_irq
060090FC 0000 0000 0000    +  		dc.l @cmd_irq,@cmd_irq
06009104 0000 0000 0000    +  		dc.l @h_irq,@h_irq
0600910C 0000 0000 0000    +  		dc.l @v_irq,@v_irq
06009114 0000 0000 0000    +  		dc.l @vres_irq,@vres_irq
0600911C                      
0600911C                      ; =================================================================
0600911C                      ; ------------------------------------------------
0600911C                      ; Unused
0600911C                      ; ------------------------------------------------
0600911C                      
0600911C                      @invalid_irq:
0600911C 000B                 		rts
0600911E 0009                 		nop
06009120                      		cnop 0,4
06009120                      		lits
06009120                      
06009120                      ; =================================================================
06009120                      ; ------------------------------------------------
06009120                      ; Slave | PWM Interrupt
06009120                      ; ------------------------------------------------
06009120                      
06009120                      @pwm_irq:
06009120                      	
06009120                      ; ----------------------------------
06009120                      
06009120 E001                 		mov	#1,r0
06009122 C10E                 		mov.w	r0,@(pwmintclr,gbr)
06009124                      		
06009124 000B                 		rts
06009126 0009                 		nop
06009128                      		cnop 0,4
06009128                      		lits
06009128                      		
06009128                      ; =================================================================
06009128                      ; ------------------------------------------------
06009128                      ; Slave | CMD Interrupt
06009128                      ; ------------------------------------------------
06009128                      
06009128                      @cmd_irq:
06009128 E000                 		mov 	#0,r0
0600912A C421                 		mov.b	@(comm0+1,gbr),r0
0600912C C90F                 		and	#%00001111,r0
0600912E 8800                 		cmp/eq	#0,r0
06009130 8900                 		bt	@no_req
06009132                      		
06009132 4008                 		shll2	r0
06009134 D100                 		mov.l	#slave_requests,r1
06009136 301C                 		add	r1,r0
06009138 6102                 		mov.l	@r0,r1
0600913A 4F22                 		mov.l	pr,@-r15
0600913C 410B                 		jsr	@r1
0600913E 0009                 		nop
06009140 4F26                 		mov.l	@r15+,pr
06009142                      		
06009142 E000                 		mov 	#0,r0
06009144 C421                 		mov.b	@(comm0+1,gbr),r0
06009146 C9F0                 		and 	#%11110000,r0
06009148 C021                 		mov.b	r0,@(comm0+1,gbr)
0600914A                      @no_req:
0600914A                      		
0600914A                      ; ----------------------------------
0600914A                      
0600914A E001                 		mov	#1,r0
0600914C C10D                 		mov.w	r0,@(cmdintclr,gbr)
0600914E 000B                 		rts
06009150 0009                 		nop
06009152 0000                 		cnop 0,4
06009154 0000 0000            		lits
06009158                      
06009158                      ; =================================================================
06009158                      ; ------------------------------------------------
06009158                      ; Slave | HBlank
06009158                      ; ------------------------------------------------
06009158                      
06009158                      @h_irq:
06009158 E001                 		mov	#1,r0
0600915A C10C                 		mov.w	r0,@(hintclr,gbr)
0600915C                      
0600915C 000B                 		rts
0600915E 0009                 		nop
06009160                      		cnop 0,4
06009160                      		lits
06009160                      	
06009160                      ; =================================================================
06009160                      ; ------------------------------------------------
06009160                      ; Slave | VBlank
06009160                      ; ------------------------------------------------
06009160                      
06009160                      @v_irq:
06009160 E001                 		mov	#1,r0
06009162 C10B                 		mov.w	r0,@(vintclr,gbr)
06009164                      
06009164 D100                  		mov.l	#vint_s_sync,r1
06009166 E000                  		mov.l	#0,r0
06009168 2102                  		mov.l	r0,@r1
0600916A 000B                 		rts
0600916C 0009                 		nop
0600916E 0000                 		cnop 0,4
06009170 0000 0000            		lits
06009174                      		
06009174                      ; =================================================================
06009174                      ; ------------------------------------------------
06009174                      ; Slave | VRES Interrupt
06009174                      ; ------------------------------------------------
06009174                      
06009174                      @vres_irq:
06009174 E001                 		mov	#1,r0
06009176 C10A                 		mov.w	r0,@(vresintclr,gbr)
06009178 000B                 		rts
0600917A 0009                 		nop
0600917C                      		cnop 0,4
0600917C                      		lits
0600917C                      		
0600917C                      ; ====================================================================
0600917C                      
0600917C                      		objend
0600917C                      		inform 0,"MARS SH2 SLAVE SIZE: %h",*-SH2_Slave;,(Sh2_CodeEnd-CS3)
0600917C                       		
0600917C                      ; ====================================================================
0600917C                      ; ------------------------------------------------
0600917C                      ; Data
0600917C                      ; ------------------------------------------------
0600917C                       	
0600917C                      ;  		cnop 0,$8000
0600917C                      ; tex_temporal:
0600917C                      ; 		incbin "engine/misc/3dtest/cube/photo.data"
0600917C                      ; 		cnop 0,4
0600917C                      		
0600917C                      ; ====================================================================
0600917C                      ; ------------------------------------------------
0600917C                      ; RAM
0600917C                      ; ------------------------------------------------
0600917C                      
0600917C                      		cnop 0,4
0600917C                      		include	"mars/sh2/ram.asm"
0600917C                      ; ====================================================================
0600917C                      ; -----------------------------------------------------------------
0600917C                      ; RAM for both CPUs
0600917C                      ; -----------------------------------------------------------------
0600917C                      
0600917C                      		rsset *
0600917C                      
0600917C                      ; ----------------------------------------
0600917C                      ; CPU communication
0600917C                      ; ----------------------------------------
0600917C                      
0600917C =0600917C            vint_m_sync	rs.l 1
0600917C =06009180            vint_s_sync	rs.l 1
0600917C =06009184            taskfor_master	rs.l 1
0600917C =06009188            taskfor_slave	rs.l 1
0600917C =0600918C            taskarg_master	rs.l 14
0600917C =060091C4            taskarg_slave	rs.l 14
0600917C =060091FC            mars_features	rs.l 1			;bits: 0-3D
0600917C                      
0600917C                      ; ----------------------------------------
0600917C                      ; VDP
0600917C                      ; ----------------------------------------
0600917C                      
0600917C =06009200            curr_frame	rs.l 1
0600917C                      
0600917C                      ; ----------------------------------------
0600917C                      ; Colors
0600917C                      ; ----------------------------------------
0600917C                      
0600917C =06009204            pal_buffer	rs.w 256
0600917C =06009404            pal_fadebuff	rs.w 256
0600917C =06009604            pal_priobuff	rs.b 256
0600917C =06009704            palfade_control	rs.l $10
0600917C                      
0600917C                      ; ----------------------------------------
0600917C                      ; PWM
0600917C                      ; ----------------------------------------
0600917C                      
0600917C =06009744            pwm_samplelist	rs.b sizeof_list*maxsmpl	;64 samples
0600917C =06009AC4            pwm_channels	rs.b sizeof_chn*maxchnls	;8 channels
0600917C                      
0600917C                      ; ----------------------------------------
0600917C                      ; 3D
0600917C                      ; ----------------------------------------
0600917C                      
0600917C =06009C24            faces_buffer	rs.b sizeof_face*numof_faces
0600917C =0601BC24            models_buffer	rs.b sizeof_model*numof_models
0600917C =0601C024            mstr_faces	rs.l numof_faces		;5 long settings + output dda
0600917C =0601D024            slve_faces	rs.l numof_faces		;5 long settings + output dda
0600917C                      
0600917C =0601E024            left_dda	rs.b sizeof_dda
0600917C =0601E058            right_dda	rs.b sizeof_dda
0600917C =0601E08C            tml_data	rs.b sizeof_tml
0600917C                      
0600917C =0601E0AC            left_dda_sl	rs.b sizeof_dda
0600917C =0601E0E0            right_dda_sl	rs.b sizeof_dda
0600917C =0601E114            tml_data_sl	rs.b sizeof_tml
0600917C                      
0600917C =0601E134            temporal_dest	rs.b 3*4
0600917C                      
0600917C                      ; ====================================================================
0600917C                      ; ----------------------------------------
0600917C                      ; End
0600917C                      ; ----------------------------------------
0600917C                      
0600917C =0601E140            ram_end		rs.l 0
0600917C                      
0600917C                      ; ====================================================================
0600917C                      
0600917C                      ;                     inform 0,"ADDRESS: %h",mstr_faces
0600917C                      ;      		inform 0,"%h",sizeof_model+faces_buffer
0600917C                           		
0600917C                       		inform 0,"MARS SH2 RAM START/END: %h-%h",(*-CS3),(ram_end-CS3)
0600917C                      		
0600917C                      		
0600917C                      		
